<!DOCTYPE html>
<html lang="zh">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>【Learning】JavaWeb Spring 课堂  - </title>
  <link rel="stylesheet" href="https://th1eil.github.io/style.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-okaidia.min.css">
  <style>
    /* 基础响应式设计 */
    html {
      font-size: 16px; /* 基础字体大小 */
    }
    
    /* 响应式字体大小 */
    @media (max-width: 768px) {
      html {
        font-size: 15px;
      }
    }
    
    @media (max-width: 480px) {
      html {
        font-size: 14px;
      }
    }
    
    /* 使用相对单位 */
    body {
      font-size: 1rem;
      line-height: 1.6;
    }
    
    h1 {
      font-size: 2.5rem;
      margin-top: 2rem;
      margin-bottom: 1rem;
    }
    
    h2 {
      font-size: 2rem;
      margin-top: 1.8rem;
      margin-bottom: 0.8rem;
    }
    
    h3 {
      font-size: 1.5rem;
      margin-top: 1.5rem;
      margin-bottom: 0.6rem;
    }
    
    h4 {
      font-size: 1.25rem;
      margin-top: 1.2rem;
      margin-bottom: 0.5rem;
    }
    
    p, ul, ol {
      margin-bottom: 1rem;
    }
    
    /* 容器响应式设计 */
    .container {
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 1rem;
    }
    
    /* 导航栏响应式设计 */
    .nav-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem;
    }
    
    .nav-brand {
      font-size: 1.5rem;
      font-weight: bold;
    }
    
    .nav-links {
      display: flex;
      gap: 1.5rem;
    }
    
    @media (max-width: 768px) {
      .nav-content {
        flex-direction: column;
        align-items: flex-start;
      }
      
      .nav-links {
        margin-top: 1rem;
        flex-wrap: wrap;
        gap: 1rem;
      }
    }
    
    /* 博客文章响应式设计 */
    article {
      max-width: 100%;
      overflow-wrap: break-word;
    }
    
    img {
      max-width: 100%;
      height: auto;
    }
    
    /* 代码块响应式设计 */
    pre[class*="language-"] {
      border-radius: 5px;
      margin: 1.5rem 0;
      padding: 1rem;
      overflow: auto;
      font-size: 0.9rem;
    }
    
    @media (max-width: 480px) {
      pre[class*="language-"] {
        font-size: 0.8rem;
        padding: 0.8rem;
      }
    }
    
    code[class*="language-"] {
      font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    }
  </style>
</head>

<body>
  <nav class="nav-container">
    <div class="nav-content">
      <div class="nav-brand">
        <a href="/">Rei's Blog</a>
      </div>
      <div class="nav-links">
        <a href="/" class="nav-link ">首页</a>
        <a href="/blog" class="nav-link active">博客</a>
        <a href="/tags" class="nav-link ">标签</a>
        <a href="/about" class="nav-link ">关于</a>
      </div>
    </div>
  </nav>

  <div class="container">
    
<style>
.content-wrapper {
    position: relative;
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
}

.post-single {
    max-width: 800px;
    margin-right: 300px;
}

.toc {
    position: fixed;
    right: 40px;
    top: 120px;
    width: 250px;
    max-height: 80vh;
    overflow-y: auto;
    background: #fff;
    padding: 1rem;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.toc h3 {
    margin-top: 0;
    margin-bottom: 1rem;
    font-size: 1.2rem;
    color: #333;
}

.toc-list {
    list-style: none;
    padding-left: 0;
    margin: 0;
}

.toc-list li {
    margin: 0.5rem 0;
}

.toc-list a {
    color: #666;
    text-decoration: none;
    font-size: 0.9rem;
    transition: color 0.3s;
    display: block;
    padding: 4px 0;
}

.toc-list a:hover {
    color: #000;
}

.toc-list a.active {
    color: #6b46c1;
    font-weight: bold;
}

@media (max-width: 1200px) {
    .post-single {
        margin-right: 0;
    }
    .toc {
        display: none;
    }
}
</style>

<div class="content-wrapper">
    <article class="post-single">
        <header class="post-header">
            <h1 class="post-title">【Learning】JavaWeb Spring 课堂 </h1>
            <div class="post-meta">
                <time>2025-03-12</time>
                
                    <div class="tags">
                        
                            <a href="https://th1eil.github.io/tags/java/">#Java</a>
                        
                    </div>
                
            </div>
        </header>

        <div class="post-content">
            <h1 id="spring-mvc-kuang-jia-xue-xi-bi-ji">Spring MVC 框架学习笔记</h1>
<p><strong>Spring MVC</strong> 是Spring Framework中的一个模块，用于构建基于Servlet的Web应用程序。它遵循**Model-View-Controller (MVC)**设计模式，将应用程序的逻辑、数据和展示层分离，便于开发和维护。它提供了丰富的注解支持、数据绑定、验证、异常处理、国际化等功能，并且可以与其他Spring模块（如Spring Security、Spring Data等）无缝集成。通过Spring MVC，开发者可以快速构建高效、可维护的Web应用程序。</p>
<h2 id="yi-pei-zhi-fang-shi"><strong>一、配置方式</strong></h2>
<p>• <strong>XML配置</strong>: 可以通过XML文件配置Spring MVC的各个组件。适合传统项目，所有配置都在 XML 文件中完成。
• <strong>Java配置</strong>: 通过@Configuration和@EnableWebMvc注解进行Java配置。适合现代化项目，完全使用 Java 代码进行配置，更简洁。
• <strong>自动配置</strong>: Spring Boot提供了自动配置，简化了Spring MVC的配置过程。</p>
<p>根据项目需求选择合适的配置方式，可以有效提高开发效率和代码可维护性。</p>
<hr />
<p>以下给出<strong>基于 XML 的配置</strong>、<strong>基于 Java 的配置</strong> 和 <strong>混合配置</strong>（XML + Java）对应的配置示例。</p>
<h3 id="1-ji-yu-xml-de-pei-zhi-shi-li"><strong>1. 基于 XML 的配置示例</strong></h3>
<p>这是传统的配置方式，所有配置都在 XML 文件中完成。</p>
<h4 id="1-1-web-xml-pei-zhi"><strong>1.1 <code>web.xml</code> 配置</strong></h4>
<pre data-lang="xml" style="background-color:#272822;color:#f8f8f2;" class="language-xml "><code class="language-xml" data-lang="xml"><span>&lt;</span><span style="color:#f92672;">web-app </span><span style="color:#a6e22e;">xmlns</span><span>=</span><span style="color:#e6db74;">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;
</span><span>         </span><span style="color:#a6e22e;">xmlns:xsi</span><span>=</span><span style="color:#e6db74;">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
</span><span>         </span><span style="color:#a6e22e;">xsi:schemaLocation</span><span>=</span><span style="color:#e6db74;">&quot;http://xmlns.jcp.org/xml/ns/javaee
</span><span style="color:#e6db74;">                             http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot;
</span><span>         </span><span style="color:#a6e22e;">version</span><span>=</span><span style="color:#e6db74;">&quot;3.1&quot;</span><span>&gt;
</span><span>
</span><span>    </span><span style="color:#75715e;">&lt;!-- 配置 DispatcherServlet --&gt;
</span><span>    &lt;</span><span style="color:#f92672;">servlet</span><span>&gt;
</span><span>        &lt;</span><span style="color:#f92672;">servlet-name</span><span>&gt;dispatcher&lt;/</span><span style="color:#f92672;">servlet-name</span><span>&gt;
</span><span>        &lt;</span><span style="color:#f92672;">servlet-class</span><span>&gt;org.springframework.web.servlet.DispatcherServlet&lt;/</span><span style="color:#f92672;">servlet-class</span><span>&gt;
</span><span>        &lt;</span><span style="color:#f92672;">init-param</span><span>&gt;
</span><span>            &lt;</span><span style="color:#f92672;">param-name</span><span>&gt;contextConfigLocation&lt;/</span><span style="color:#f92672;">param-name</span><span>&gt;
</span><span>            &lt;</span><span style="color:#f92672;">param-value</span><span>&gt;/WEB-INF/spring-servlet.xml&lt;/</span><span style="color:#f92672;">param-value</span><span>&gt;
</span><span>        &lt;/</span><span style="color:#f92672;">init-param</span><span>&gt;
</span><span>        &lt;</span><span style="color:#f92672;">load-on-startup</span><span>&gt;1&lt;/</span><span style="color:#f92672;">load-on-startup</span><span>&gt;
</span><span>    &lt;/</span><span style="color:#f92672;">servlet</span><span>&gt;
</span><span>
</span><span>    </span><span style="color:#75715e;">&lt;!-- 映射 DispatcherServlet 到所有请求 --&gt;
</span><span>    &lt;</span><span style="color:#f92672;">servlet-mapping</span><span>&gt;
</span><span>        &lt;</span><span style="color:#f92672;">servlet-name</span><span>&gt;dispatcher&lt;/</span><span style="color:#f92672;">servlet-name</span><span>&gt;
</span><span>        &lt;</span><span style="color:#f92672;">url-pattern</span><span>&gt;/&lt;/</span><span style="color:#f92672;">url-pattern</span><span>&gt;
</span><span>    &lt;/</span><span style="color:#f92672;">servlet-mapping</span><span>&gt;
</span><span>&lt;/</span><span style="color:#f92672;">web-app</span><span>&gt;
</span></code></pre>
<h4 id="1-2-spring-servlet-xml-pei-zhi"><strong>1.2 <code>spring-servlet.xml</code> 配置</strong></h4>
<pre data-lang="xml" style="background-color:#272822;color:#f8f8f2;" class="language-xml "><code class="language-xml" data-lang="xml"><span>&lt;</span><span style="color:#f92672;">beans </span><span style="color:#a6e22e;">xmlns</span><span>=</span><span style="color:#e6db74;">&quot;http://www.springframework.org/schema/beans&quot;
</span><span>       </span><span style="color:#a6e22e;">xmlns:xsi</span><span>=</span><span style="color:#e6db74;">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
</span><span>       </span><span style="color:#a6e22e;">xmlns:context</span><span>=</span><span style="color:#e6db74;">&quot;http://www.springframework.org/schema/context&quot;
</span><span>       </span><span style="color:#a6e22e;">xmlns:mvc</span><span>=</span><span style="color:#e6db74;">&quot;http://www.springframework.org/schema/mvc&quot;
</span><span>       </span><span style="color:#a6e22e;">xsi:schemaLocation</span><span>=</span><span style="color:#e6db74;">&quot;http://www.springframework.org/schema/beans
</span><span style="color:#e6db74;">                           http://www.springframework.org/schema/beans/spring-beans.xsd
</span><span style="color:#e6db74;">                           http://www.springframework.org/schema/context
</span><span style="color:#e6db74;">                           http://www.springframework.org/schema/context/spring-context.xsd
</span><span style="color:#e6db74;">                           http://www.springframework.org/schema/mvc
</span><span style="color:#e6db74;">                           http://www.springframework.org/schema/mvc/spring-mvc.xsd&quot;</span><span>&gt;
</span><span>
</span><span>    </span><span style="color:#75715e;">&lt;!-- 启用注解驱动的控制器 --&gt;
</span><span>    &lt;</span><span style="color:#f92672;">mvc:annotation-driven </span><span>/&gt;
</span><span>
</span><span>    </span><span style="color:#75715e;">&lt;!-- 扫描控制器包 --&gt;
</span><span>    &lt;</span><span style="color:#f92672;">context:component-scan </span><span style="color:#a6e22e;">base-package</span><span>=</span><span style="color:#e6db74;">&quot;com.example.controller&quot; </span><span>/&gt;
</span><span>
</span><span>    </span><span style="color:#75715e;">&lt;!-- 配置视图解析器 --&gt;
</span><span>    &lt;</span><span style="color:#f92672;">bean </span><span style="color:#a6e22e;">class</span><span>=</span><span style="color:#e6db74;">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span><span>&gt;
</span><span>        &lt;</span><span style="color:#f92672;">property </span><span style="color:#a6e22e;">name</span><span>=</span><span style="color:#e6db74;">&quot;prefix&quot; </span><span style="color:#a6e22e;">value</span><span>=</span><span style="color:#e6db74;">&quot;/WEB-INF/views/&quot; </span><span>/&gt;
</span><span>        &lt;</span><span style="color:#f92672;">property </span><span style="color:#a6e22e;">name</span><span>=</span><span style="color:#e6db74;">&quot;suffix&quot; </span><span style="color:#a6e22e;">value</span><span>=</span><span style="color:#e6db74;">&quot;.jsp&quot; </span><span>/&gt;
</span><span>    &lt;/</span><span style="color:#f92672;">bean</span><span>&gt;
</span><span>&lt;/</span><span style="color:#f92672;">beans</span><span>&gt;
</span></code></pre>
<hr />
<h3 id="2-ji-yu-java-de-pei-zhi"><strong>2. 基于 Java 的配置</strong></h3>
<p>这是现代化的配置方式，完全使用 Java 代码进行配置。</p>
<h4 id="2-1-webappinitializer-pei-zhi"><strong>2.1 <code>WebAppInitializer</code> 配置</strong></h4>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">web</span><span>.</span><span style="font-style:italic;color:#66d9ef;">WebApplicationInitializer</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">web</span><span>.</span><span style="font-style:italic;color:#66d9ef;">context</span><span>.</span><span style="font-style:italic;color:#66d9ef;">support</span><span>.</span><span style="font-style:italic;color:#66d9ef;">AnnotationConfigWebApplicationContext</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">web</span><span>.</span><span style="font-style:italic;color:#66d9ef;">servlet</span><span>.</span><span style="font-style:italic;color:#66d9ef;">DispatcherServlet</span><span>;
</span><span>
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">javax</span><span>.</span><span style="font-style:italic;color:#66d9ef;">servlet</span><span>.</span><span style="font-style:italic;color:#66d9ef;">ServletContext</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">javax</span><span>.</span><span style="font-style:italic;color:#66d9ef;">servlet</span><span>.</span><span style="font-style:italic;color:#66d9ef;">ServletException</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">javax</span><span>.</span><span style="font-style:italic;color:#66d9ef;">servlet</span><span>.</span><span style="font-style:italic;color:#66d9ef;">ServletRegistration</span><span>;
</span><span>
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">WebAppInitializer </span><span style="color:#f92672;">implements </span><span style="text-decoration:underline;font-style:italic;color:#a6e22e;">WebApplicationInitializer </span><span>{
</span><span>
</span><span>    @Override
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">void </span><span style="color:#a6e22e;">onStartup</span><span>(</span><span style="font-style:italic;color:#66d9ef;">ServletContext </span><span style="font-style:italic;color:#fd971f;">servletContext</span><span>) </span><span style="color:#f92672;">throws </span><span style="font-style:italic;color:#66d9ef;">ServletException </span><span>{
</span><span>        </span><span style="color:#75715e;">// 创建 Spring 应用上下文
</span><span>        </span><span style="font-style:italic;color:#66d9ef;">AnnotationConfigWebApplicationContext</span><span> context </span><span style="color:#f92672;">= new </span><span style="font-style:italic;color:#66d9ef;">AnnotationConfigWebApplicationContext</span><span>();
</span><span>        context.register(</span><span style="font-style:italic;color:#66d9ef;">AppConfig</span><span>.class);
</span><span>
</span><span>        </span><span style="color:#75715e;">// 创建并注册 DispatcherServlet
</span><span>        </span><span style="font-style:italic;color:#66d9ef;">DispatcherServlet</span><span> dispatcherServlet </span><span style="color:#f92672;">= new </span><span style="font-style:italic;color:#66d9ef;">DispatcherServlet</span><span>(context);
</span><span>        </span><span style="font-style:italic;color:#66d9ef;">ServletRegistration</span><span>.</span><span style="font-style:italic;color:#66d9ef;">Dynamic</span><span> registration </span><span style="color:#f92672;">=</span><span> servletContext.addServlet(</span><span style="color:#e6db74;">&quot;dispatcher&quot;</span><span>, dispatcherServlet);
</span><span>        registration.setLoadOnStartup(</span><span style="color:#ae81ff;">1</span><span>);
</span><span>        registration.addMapping(</span><span style="color:#e6db74;">&quot;/&quot;</span><span>);
</span><span>    }
</span><span>}
</span></code></pre>
<h4 id="2-2-appconfig-pei-zhi"><strong>2.2 <code>AppConfig</code> 配置</strong></h4>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">context</span><span>.</span><span style="font-style:italic;color:#66d9ef;">annotation</span><span>.</span><span style="font-style:italic;color:#66d9ef;">Bean</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">context</span><span>.</span><span style="font-style:italic;color:#66d9ef;">annotation</span><span>.</span><span style="font-style:italic;color:#66d9ef;">ComponentScan</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">context</span><span>.</span><span style="font-style:italic;color:#66d9ef;">annotation</span><span>.</span><span style="font-style:italic;color:#66d9ef;">Configuration</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">web</span><span>.</span><span style="font-style:italic;color:#66d9ef;">servlet</span><span>.</span><span style="font-style:italic;color:#66d9ef;">ViewResolver</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">web</span><span>.</span><span style="font-style:italic;color:#66d9ef;">servlet</span><span>.</span><span style="font-style:italic;color:#66d9ef;">config</span><span>.</span><span style="font-style:italic;color:#66d9ef;">annotation</span><span>.</span><span style="font-style:italic;color:#66d9ef;">EnableWebMvc</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">web</span><span>.</span><span style="font-style:italic;color:#66d9ef;">servlet</span><span>.</span><span style="font-style:italic;color:#66d9ef;">view</span><span>.</span><span style="font-style:italic;color:#66d9ef;">InternalResourceViewResolver</span><span>;
</span><span>
</span><span>@Configuration
</span><span>@EnableWebMvc
</span><span>@ComponentScan(</span><span style="font-style:italic;color:#fd971f;">basePackages </span><span style="color:#f92672;">= </span><span style="color:#e6db74;">&quot;com.example.controller&quot;</span><span>)
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">AppConfig </span><span>{
</span><span>
</span><span>    @Bean
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">ViewResolver </span><span style="color:#a6e22e;">viewResolver</span><span>() {
</span><span>        </span><span style="font-style:italic;color:#66d9ef;">InternalResourceViewResolver</span><span> resolver </span><span style="color:#f92672;">= new </span><span style="font-style:italic;color:#66d9ef;">InternalResourceViewResolver</span><span>();
</span><span>        resolver.setPrefix(</span><span style="color:#e6db74;">&quot;/WEB-INF/views/&quot;</span><span>);
</span><span>        resolver.setSuffix(</span><span style="color:#e6db74;">&quot;.jsp&quot;</span><span>);
</span><span>        </span><span style="color:#f92672;">return</span><span> resolver;
</span><span>    }
</span><span>}
</span></code></pre>
<hr />
<h3 id="3-hun-he-pei-zhi-xml-java"><strong>3. 混合配置（XML + Java）</strong></h3>
<p>这种方式结合了 XML 和 Java 配置的优点，适用于需要兼容旧代码的项目。</p>
<h4 id="3-1-web-xml-pei-zhi"><strong>3.1 <code>web.xml</code> 配置</strong></h4>
<pre data-lang="xml" style="background-color:#272822;color:#f8f8f2;" class="language-xml "><code class="language-xml" data-lang="xml"><span>&lt;</span><span style="color:#f92672;">web-app </span><span style="color:#a6e22e;">xmlns</span><span>=</span><span style="color:#e6db74;">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;
</span><span>         </span><span style="color:#a6e22e;">xmlns:xsi</span><span>=</span><span style="color:#e6db74;">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
</span><span>         </span><span style="color:#a6e22e;">xsi:schemaLocation</span><span>=</span><span style="color:#e6db74;">&quot;http://xmlns.jcp.org/xml/ns/javaee
</span><span style="color:#e6db74;">                             http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot;
</span><span>         </span><span style="color:#a6e22e;">version</span><span>=</span><span style="color:#e6db74;">&quot;3.1&quot;</span><span>&gt;
</span><span>
</span><span>    </span><span style="color:#75715e;">&lt;!-- 配置 ContextLoaderListener --&gt;
</span><span>    &lt;</span><span style="color:#f92672;">context-param</span><span>&gt;
</span><span>        &lt;</span><span style="color:#f92672;">param-name</span><span>&gt;contextConfigLocation&lt;/</span><span style="color:#f92672;">param-name</span><span>&gt;
</span><span>        &lt;</span><span style="color:#f92672;">param-value</span><span>&gt;/WEB-INF/applicationContext.xml&lt;/</span><span style="color:#f92672;">param-value</span><span>&gt;
</span><span>    &lt;/</span><span style="color:#f92672;">context-param</span><span>&gt;
</span><span>    &lt;</span><span style="color:#f92672;">listener</span><span>&gt;
</span><span>        &lt;</span><span style="color:#f92672;">listener-class</span><span>&gt;org.springframework.web.context.ContextLoaderListener&lt;/</span><span style="color:#f92672;">listener-class</span><span>&gt;
</span><span>    &lt;/</span><span style="color:#f92672;">listener</span><span>&gt;
</span><span>
</span><span>    </span><span style="color:#75715e;">&lt;!-- 配置 DispatcherServlet --&gt;
</span><span>    &lt;</span><span style="color:#f92672;">servlet</span><span>&gt;
</span><span>        &lt;</span><span style="color:#f92672;">servlet-name</span><span>&gt;dispatcher&lt;/</span><span style="color:#f92672;">servlet-name</span><span>&gt;
</span><span>        &lt;</span><span style="color:#f92672;">servlet-class</span><span>&gt;org.springframework.web.servlet.DispatcherServlet&lt;/</span><span style="color:#f92672;">servlet-class</span><span>&gt;
</span><span>        &lt;</span><span style="color:#f92672;">init-param</span><span>&gt;
</span><span>            &lt;</span><span style="color:#f92672;">param-name</span><span>&gt;contextConfigLocation&lt;/</span><span style="color:#f92672;">param-name</span><span>&gt;
</span><span>            &lt;</span><span style="color:#f92672;">param-value</span><span>&gt;/WEB-INF/spring-servlet.xml&lt;/</span><span style="color:#f92672;">param-value</span><span>&gt;
</span><span>        &lt;/</span><span style="color:#f92672;">init-param</span><span>&gt;
</span><span>        &lt;</span><span style="color:#f92672;">load-on-startup</span><span>&gt;1&lt;/</span><span style="color:#f92672;">load-on-startup</span><span>&gt;
</span><span>    &lt;/</span><span style="color:#f92672;">servlet</span><span>&gt;
</span><span>
</span><span>    </span><span style="color:#75715e;">&lt;!-- 映射 DispatcherServlet 到所有请求 --&gt;
</span><span>    &lt;</span><span style="color:#f92672;">servlet-mapping</span><span>&gt;
</span><span>        &lt;</span><span style="color:#f92672;">servlet-name</span><span>&gt;dispatcher&lt;/</span><span style="color:#f92672;">servlet-name</span><span>&gt;
</span><span>        &lt;</span><span style="color:#f92672;">url-pattern</span><span>&gt;/&lt;/</span><span style="color:#f92672;">url-pattern</span><span>&gt;
</span><span>    &lt;/</span><span style="color:#f92672;">servlet-mapping</span><span>&gt;
</span><span>&lt;/</span><span style="color:#f92672;">web-app</span><span>&gt;
</span></code></pre>
<h4 id="3-2-applicationcontext-xml-pei-zhi"><strong>3.2 <code>applicationContext.xml</code> 配置</strong></h4>
<pre data-lang="xml" style="background-color:#272822;color:#f8f8f2;" class="language-xml "><code class="language-xml" data-lang="xml"><span>&lt;</span><span style="color:#f92672;">beans </span><span style="color:#a6e22e;">xmlns</span><span>=</span><span style="color:#e6db74;">&quot;http://www.springframework.org/schema/beans&quot;
</span><span>       </span><span style="color:#a6e22e;">xmlns:xsi</span><span>=</span><span style="color:#e6db74;">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
</span><span>       </span><span style="color:#a6e22e;">xmlns:context</span><span>=</span><span style="color:#e6db74;">&quot;http://www.springframework.org/schema/context&quot;
</span><span>       </span><span style="color:#a6e22e;">xsi:schemaLocation</span><span>=</span><span style="color:#e6db74;">&quot;http://www.springframework.org/schema/beans
</span><span style="color:#e6db74;">                           http://www.springframework.org/schema/beans/spring-beans.xsd
</span><span style="color:#e6db74;">                           http://www.springframework.org/schema/context
</span><span style="color:#e6db74;">                           http://www.springframework.org/schema/context/spring-context.xsd&quot;</span><span>&gt;
</span><span>
</span><span>    </span><span style="color:#75715e;">&lt;!-- 扫描服务层和 DAO 层 --&gt;
</span><span>    &lt;</span><span style="color:#f92672;">context:component-scan </span><span style="color:#a6e22e;">base-package</span><span>=</span><span style="color:#e6db74;">&quot;com.example.service, com.example.dao&quot; </span><span>/&gt;
</span><span>&lt;/</span><span style="color:#f92672;">beans</span><span>&gt;
</span></code></pre>
<h4 id="3-3-spring-servlet-xml-pei-zhi"><strong>3.3 <code>spring-servlet.xml</code> 配置</strong></h4>
<pre data-lang="xml" style="background-color:#272822;color:#f8f8f2;" class="language-xml "><code class="language-xml" data-lang="xml"><span>&lt;</span><span style="color:#f92672;">beans </span><span style="color:#a6e22e;">xmlns</span><span>=</span><span style="color:#e6db74;">&quot;http://www.springframework.org/schema/beans&quot;
</span><span>       </span><span style="color:#a6e22e;">xmlns:xsi</span><span>=</span><span style="color:#e6db74;">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
</span><span>       </span><span style="color:#a6e22e;">xmlns:context</span><span>=</span><span style="color:#e6db74;">&quot;http://www.springframework.org/schema/context&quot;
</span><span>       </span><span style="color:#a6e22e;">xmlns:mvc</span><span>=</span><span style="color:#e6db74;">&quot;http://www.springframework.org/schema/mvc&quot;
</span><span>       </span><span style="color:#a6e22e;">xsi:schemaLocation</span><span>=</span><span style="color:#e6db74;">&quot;http://www.springframework.org/schema/beans
</span><span style="color:#e6db74;">                           http://www.springframework.org/schema/beans/spring-beans.xsd
</span><span style="color:#e6db74;">                           http://www.springframework.org/schema/context
</span><span style="color:#e6db74;">                           http://www.springframework.org/schema/context/spring-context.xsd
</span><span style="color:#e6db74;">                           http://www.springframework.org/schema/mvc
</span><span style="color:#e6db74;">                           http://www.springframework.org/schema/mvc/spring-mvc.xsd&quot;</span><span>&gt;
</span><span>
</span><span>    </span><span style="color:#75715e;">&lt;!-- 启用注解驱动的控制器 --&gt;
</span><span>    &lt;</span><span style="color:#f92672;">mvc:annotation-driven </span><span>/&gt;
</span><span>
</span><span>    </span><span style="color:#75715e;">&lt;!-- 扫描控制器包 --&gt;
</span><span>    &lt;</span><span style="color:#f92672;">context:component-scan </span><span style="color:#a6e22e;">base-package</span><span>=</span><span style="color:#e6db74;">&quot;com.example.controller&quot; </span><span>/&gt;
</span><span>
</span><span>    </span><span style="color:#75715e;">&lt;!-- 配置视图解析器 --&gt;
</span><span>    &lt;</span><span style="color:#f92672;">bean </span><span style="color:#a6e22e;">class</span><span>=</span><span style="color:#e6db74;">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span><span>&gt;
</span><span>        &lt;</span><span style="color:#f92672;">property </span><span style="color:#a6e22e;">name</span><span>=</span><span style="color:#e6db74;">&quot;prefix&quot; </span><span style="color:#a6e22e;">value</span><span>=</span><span style="color:#e6db74;">&quot;/WEB-INF/views/&quot; </span><span>/&gt;
</span><span>        &lt;</span><span style="color:#f92672;">property </span><span style="color:#a6e22e;">name</span><span>=</span><span style="color:#e6db74;">&quot;suffix&quot; </span><span style="color:#a6e22e;">value</span><span>=</span><span style="color:#e6db74;">&quot;.jsp&quot; </span><span>/&gt;
</span><span>    &lt;/</span><span style="color:#f92672;">bean</span><span>&gt;
</span><span>&lt;/</span><span style="color:#f92672;">beans</span><span>&gt;
</span></code></pre>
<h3 id="4-spring-bootxiang-mu-zhong-de-spring-mvcpei-zhi-fang-shi">4. Spring Boot项目中的Spring MVC配置方式</h3>
<p>Spring Boot 的自动配置和灵活的扩展机制，使得开发者可以快速构建功能强大的 Spring MVC 应用。在 Spring Boot 项目中，Spring MVC 的配置非常简单：</p>
<ol>
<li><strong>默认配置</strong>：Spring Boot 已经为 Spring MVC 提供了默认的自动配置。无需额外配置即可使用。</li>
<li><strong>自定义配置</strong>：
• 通过 <code>application.properties</code> 或 <code>application.yml</code> 配置。
• 通过 <code>@Configuration</code> 类自定义行为。
• 使用 <code>@EnableWebMvc</code> 完全控制配置。</li>
</ol>
<hr />
<h4 id="1-mo-ren-pei-zhi"><strong>1. 默认配置</strong></h4>
<p>Spring Boot 自动配置了 Spring MVC，包括以下默认行为：
• 自动注册 <code>DispatcherServlet</code>。
• 自动配置视图解析器（如 Thymeleaf、FreeMarker、JSP 等）。
• 自动配置静态资源处理（如 <code>/static</code>、<code>/public</code>、<code>/resources</code> 等目录）。
• 自动配置消息转换器（如 JSON、XML 等）。</p>
<p>开发者无需额外配置即可使用 Spring MVC。</p>
<hr />
<h4 id="2-zi-ding-yi-pei-zhi"><strong>2. 自定义配置</strong></h4>
<p>如果需要自定义 Spring MVC 的行为，可以通过以下方式实现：</p>
<h5 id="2-1-shi-yong-application-properties-huo-application-yml"><strong>2.1 使用 <code>application.properties</code> 或 <code>application.yml</code></strong></h5>
<p>Spring Boot 提供了许多与 Spring MVC 相关的配置属性，可以在 <code>application.properties</code> 或 <code>application.yml</code> 中进行配置。</p>
<p><strong>示例：<code>application.properties</code></strong></p>
<pre data-lang="properties" style="background-color:#272822;color:#f8f8f2;" class="language-properties "><code class="language-properties" data-lang="properties"><span style="color:#75715e;"># 静态资源路径
</span><span>spring.mvc.static-path-pattern=</span><span style="color:#e6db74;">/static/**
</span><span>
</span><span style="color:#75715e;"># 视图解析器前缀和后缀
</span><span>spring.mvc.view.prefix=</span><span style="color:#e6db74;">/WEB-INF/views/
</span><span>spring.mvc.view.suffix=</span><span style="color:#e6db74;">.jsp
</span><span>
</span><span style="color:#75715e;"># 文件上传配置
</span><span>spring.servlet.multipart.max-file-size=</span><span style="color:#e6db74;">10MB
</span><span>spring.servlet.multipart.max-request-size=</span><span style="color:#e6db74;">50MB
</span></code></pre>
<p><strong>示例：<code>application.yml</code></strong></p>
<pre data-lang="yaml" style="background-color:#272822;color:#f8f8f2;" class="language-yaml "><code class="language-yaml" data-lang="yaml"><span style="color:#f92672;">spring</span><span>:
</span><span>  </span><span style="color:#f92672;">mvc</span><span>:
</span><span>    </span><span style="color:#f92672;">static-path-pattern</span><span>: </span><span style="color:#e6db74;">/static/**
</span><span>    </span><span style="color:#f92672;">view</span><span>:
</span><span>      </span><span style="color:#f92672;">prefix</span><span>: </span><span style="color:#e6db74;">/WEB-INF/views/
</span><span>      </span><span style="color:#f92672;">suffix</span><span>: </span><span style="color:#e6db74;">.jsp
</span><span>  </span><span style="color:#f92672;">servlet</span><span>:
</span><span>    </span><span style="color:#f92672;">multipart</span><span>:
</span><span>      </span><span style="color:#f92672;">max-file-size</span><span>: </span><span style="color:#e6db74;">10MB
</span><span>      </span><span style="color:#f92672;">max-request-size</span><span>: </span><span style="color:#e6db74;">50MB
</span></code></pre>
<h5 id="2-2-shi-yong-configuration-lei"><strong>2.2 使用 <code>@Configuration</code> 类</strong></h5>
<p>通过编写配置类，可以更灵活地自定义 Spring MVC 的行为。</p>
<p><strong>示例：自定义视图解析器</strong></p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">context</span><span>.</span><span style="font-style:italic;color:#66d9ef;">annotation</span><span>.</span><span style="font-style:italic;color:#66d9ef;">Bean</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">context</span><span>.</span><span style="font-style:italic;color:#66d9ef;">annotation</span><span>.</span><span style="font-style:italic;color:#66d9ef;">Configuration</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">web</span><span>.</span><span style="font-style:italic;color:#66d9ef;">servlet</span><span>.</span><span style="font-style:italic;color:#66d9ef;">ViewResolver</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">web</span><span>.</span><span style="font-style:italic;color:#66d9ef;">servlet</span><span>.</span><span style="font-style:italic;color:#66d9ef;">config</span><span>.</span><span style="font-style:italic;color:#66d9ef;">annotation</span><span>.</span><span style="font-style:italic;color:#66d9ef;">WebMvcConfigurer</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">web</span><span>.</span><span style="font-style:italic;color:#66d9ef;">servlet</span><span>.</span><span style="font-style:italic;color:#66d9ef;">view</span><span>.</span><span style="font-style:italic;color:#66d9ef;">InternalResourceViewResolver</span><span>;
</span><span>
</span><span>@Configuration
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">WebConfig </span><span style="color:#f92672;">implements </span><span style="text-decoration:underline;font-style:italic;color:#a6e22e;">WebMvcConfigurer </span><span>{
</span><span>
</span><span>    @Bean
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">ViewResolver </span><span style="color:#a6e22e;">viewResolver</span><span>() {
</span><span>        </span><span style="font-style:italic;color:#66d9ef;">InternalResourceViewResolver</span><span> resolver </span><span style="color:#f92672;">= new </span><span style="font-style:italic;color:#66d9ef;">InternalResourceViewResolver</span><span>();
</span><span>        resolver.setPrefix(</span><span style="color:#e6db74;">&quot;/WEB-INF/views/&quot;</span><span>);
</span><span>        resolver.setSuffix(</span><span style="color:#e6db74;">&quot;.jsp&quot;</span><span>);
</span><span>        </span><span style="color:#f92672;">return</span><span> resolver;
</span><span>    }
</span><span>}
</span></code></pre>
<p><strong>示例：自定义静态资源处理</strong></p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">context</span><span>.</span><span style="font-style:italic;color:#66d9ef;">annotation</span><span>.</span><span style="font-style:italic;color:#66d9ef;">Configuration</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">web</span><span>.</span><span style="font-style:italic;color:#66d9ef;">servlet</span><span>.</span><span style="font-style:italic;color:#66d9ef;">config</span><span>.</span><span style="font-style:italic;color:#66d9ef;">annotation</span><span>.</span><span style="font-style:italic;color:#66d9ef;">ResourceHandlerRegistry</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">web</span><span>.</span><span style="font-style:italic;color:#66d9ef;">servlet</span><span>.</span><span style="font-style:italic;color:#66d9ef;">config</span><span>.</span><span style="font-style:italic;color:#66d9ef;">annotation</span><span>.</span><span style="font-style:italic;color:#66d9ef;">WebMvcConfigurer</span><span>;
</span><span>
</span><span>@Configuration
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">WebConfig </span><span style="color:#f92672;">implements </span><span style="text-decoration:underline;font-style:italic;color:#a6e22e;">WebMvcConfigurer </span><span>{
</span><span>
</span><span>    @Override
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">void </span><span style="color:#a6e22e;">addResourceHandlers</span><span>(</span><span style="font-style:italic;color:#66d9ef;">ResourceHandlerRegistry </span><span style="font-style:italic;color:#fd971f;">registry</span><span>) {
</span><span>        registry.addResourceHandler(</span><span style="color:#e6db74;">&quot;/static/**&quot;</span><span>)
</span><span>                .addResourceLocations(</span><span style="color:#e6db74;">&quot;classpath:/static/&quot;</span><span>);
</span><span>    }
</span><span>}
</span></code></pre>
<p><strong>示例：自定义拦截器</strong></p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">context</span><span>.</span><span style="font-style:italic;color:#66d9ef;">annotation</span><span>.</span><span style="font-style:italic;color:#66d9ef;">Configuration</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">web</span><span>.</span><span style="font-style:italic;color:#66d9ef;">servlet</span><span>.</span><span style="font-style:italic;color:#66d9ef;">config</span><span>.</span><span style="font-style:italic;color:#66d9ef;">annotation</span><span>.</span><span style="font-style:italic;color:#66d9ef;">InterceptorRegistry</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">web</span><span>.</span><span style="font-style:italic;color:#66d9ef;">servlet</span><span>.</span><span style="font-style:italic;color:#66d9ef;">config</span><span>.</span><span style="font-style:italic;color:#66d9ef;">annotation</span><span>.</span><span style="font-style:italic;color:#66d9ef;">WebMvcConfigurer</span><span>;
</span><span>
</span><span>@Configuration
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">WebConfig </span><span style="color:#f92672;">implements </span><span style="text-decoration:underline;font-style:italic;color:#a6e22e;">WebMvcConfigurer </span><span>{
</span><span>
</span><span>    @Override
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">void </span><span style="color:#a6e22e;">addInterceptors</span><span>(</span><span style="font-style:italic;color:#66d9ef;">InterceptorRegistry </span><span style="font-style:italic;color:#fd971f;">registry</span><span>) {
</span><span>        registry.addInterceptor(</span><span style="color:#f92672;">new </span><span style="font-style:italic;color:#66d9ef;">CustomInterceptor</span><span>())
</span><span>                .addPathPatterns(</span><span style="color:#e6db74;">&quot;/**&quot;</span><span>);
</span><span>    }
</span><span>}
</span></code></pre>
<hr />
<h2 id="er-he-xin-zu-jian-ji-chu-li-ji-zhi"><em>二、核心组件及处理机制</em></h2>
<p>• <strong>DispatcherServlet</strong>: Spring MVC的核心控制器，负责接收HTTP请求并将其分发给相应的处理器（Controller）。
• <strong>HandlerMapping</strong>: 用于将请求映射到相应的处理器（Controller）。
• <strong>Controller</strong>: 处理请求并返回模型和视图。
• <strong>ViewResolver</strong>: 解析视图名称并渲染视图（如JSP、Thymeleaf等）。
• <strong>ModelAndView</strong>: 包含模型数据和视图信息的对象，用于在Controller和View之间传递数据。</p>
<h3 id="qing-qiu-chu-li-liu-cheng"><em>请求处理流程</em></h3>
<ol>
<li><strong>请求到达DispatcherServlet</strong>：客户端发送的HTTP请求首先被DispatcherServlet接收。</li>
<li><strong>HandlerMapping查找处理器</strong>：DispatcherServlet通过HandlerMapping找到处理该请求的Controller。</li>
<li><strong>Controller处理请求</strong>：Controller执行业务逻辑，并返回一个ModelAndView对象。</li>
<li><strong>ViewResolver解析视图</strong>：DispatcherServlet通过ViewResolver解析视图名称，找到对应的视图。</li>
<li><strong>视图渲染</strong>：视图使用模型数据渲染响应，并将结果返回给客户端。</li>
</ol>
<pre style="background-color:#272822;color:#f8f8f2;"><code><span>+-------------------+
</span><span>|   HTTP Request    |
</span><span>+-------------------+
</span><span>          |
</span><span>          v
</span><span>+-------------------+
</span><span>| DispatcherServlet |
</span><span>+-------------------+
</span><span>          |
</span><span>          v
</span><span>+-------------------+
</span><span>| HandlerMapping    |
</span><span>| (查找处理器)       |
</span><span>+-------------------+
</span><span>          |
</span><span>          v
</span><span>+-------------------+
</span><span>| HandlerAdapter    |
</span><span>| (调用处理器)       |
</span><span>+-------------------+
</span><span>          |
</span><span>          v
</span><span>+-------------------+
</span><span>| Controller Method |
</span><span>| (执行业务逻辑)     |
</span><span>+-------------------+
</span><span>          |
</span><span>          v
</span><span>+-------------------+
</span><span>| 返回结果           |
</span><span>| (ModelAndView,    |
</span><span>|  JSON, String)    |
</span><span>+-------------------+
</span><span>          |
</span><span>          v
</span><span>+-------------------+
</span><span>| ViewResolver      |
</span><span>| (解析视图)         |
</span><span>+-------------------+
</span><span>          |
</span><span>          v
</span><span>+-------------------+
</span><span>|  HTTP Response    |
</span><span>+-------------------+
</span></code></pre>
<p><strong>详细步骤</strong>：</p>
<ol>
<li><strong>接收请求</strong>:
• <code>DispatcherServlet</code> 接收所有到达应用程序的 HTTP 请求。</li>
<li><strong>查找处理器</strong>:
• 调用 <code>HandlerMapping</code>，根据请求的 URL 和其他信息，查找合适的处理器（通常是 Controller 中的方法）。</li>
<li><strong>调用处理器</strong>:
• 调用 <code>HandlerAdapter</code>，执行处理器方法，并将方法返回的结果（如 <code>ModelAndView</code>、JSON 数据等）封装为响应。</li>
<li><strong>处理业务逻辑</strong>:
• 处理器方法执行业务逻辑，并返回结果。</li>
<li><strong>解析视图</strong>:
• 如果返回的是视图名称（如 <code>ModelAndView</code>），则调用 <code>ViewResolver</code> 解析视图，并渲染页面。</li>
<li><strong>返回响应</strong>:
• 将最终生成的响应（如 HTML 页面、JSON 数据等）返回给客户端</li>
</ol>
<h3 id="qian-duan-kong-zhi-qi">前端控制器</h3>
<p><code>DispatcherServlet</code> 是 Spring MVC 框架的核心组件，它充当了前端控制器（Front Controller）的角色，负责接收所有的 HTTP 请求，并将这些请求分发给合适的处理器（Handler），最后将处理结果返回给客户端。它依赖于 <code>HandlerMapping</code>、<code>HandlerAdapter</code>、<code>ViewResolver</code> 等组件来完成请求的处理和响应的生成。通过灵活的路由配置、强大的扩展性和丰富的特性，<code>DispatcherServlet</code> 使得 Spring MVC 能够轻松构建高效、可维护的 Web 应用程序。</p>
<hr />
<h4 id="1-dispatcherservlet-de-zuo-yong"><strong>1. DispatcherServlet 的作用</strong></h4>
<p><code>DispatcherServlet</code> 是 Spring MVC 的入口点，它的主要职责包括：</p>
<ol>
<li><strong>接收请求</strong>:
• 接收所有到达应用程序的 HTTP 请求。</li>
<li><strong>分发请求</strong>:
• 根据请求的 URL 和其他信息，将请求分发给合适的处理器（通常是 Controller 中的方法）。</li>
<li><strong>协调处理流程</strong>:
• 调用 <code>HandlerMapping</code>、<code>HandlerAdapter</code>、<code>ViewResolver</code> 等组件，完成请求的处理和响应的生成。</li>
<li><strong>返回响应</strong>:
• 将处理结果（如 HTML 页面、JSON 数据等）返回给客户端。</li>
</ol>
<hr />
<h4 id="2-dispatcherservlet-de-pei-zhi"><strong>2. DispatcherServlet 的配置</strong></h4>
<p><code>DispatcherServlet</code> 的配置可以通过以下两种方式实现：</p>
<h5 id="1-xml-pei-zhi"><strong>1. XML 配置</strong></h5>
<p>在 <code>web.xml</code> 中配置 <code>DispatcherServlet</code>：</p>
<pre data-lang="xml" style="background-color:#272822;color:#f8f8f2;" class="language-xml "><code class="language-xml" data-lang="xml"><span>&lt;</span><span style="color:#f92672;">servlet</span><span>&gt;
</span><span>    &lt;</span><span style="color:#f92672;">servlet-name</span><span>&gt;dispatcher&lt;/</span><span style="color:#f92672;">servlet-name</span><span>&gt;
</span><span>    &lt;</span><span style="color:#f92672;">servlet-class</span><span>&gt;org.springframework.web.servlet.DispatcherServlet&lt;/</span><span style="color:#f92672;">servlet-class</span><span>&gt;
</span><span>    &lt;</span><span style="color:#f92672;">init-param</span><span>&gt;
</span><span>        &lt;</span><span style="color:#f92672;">param-name</span><span>&gt;contextConfigLocation&lt;/</span><span style="color:#f92672;">param-name</span><span>&gt;
</span><span>        &lt;</span><span style="color:#f92672;">param-value</span><span>&gt;/WEB-INF/spring-servlet.xml&lt;/</span><span style="color:#f92672;">param-value</span><span>&gt;
</span><span>    &lt;/</span><span style="color:#f92672;">init-param</span><span>&gt;
</span><span>    &lt;</span><span style="color:#f92672;">load-on-startup</span><span>&gt;1&lt;/</span><span style="color:#f92672;">load-on-startup</span><span>&gt;
</span><span>&lt;/</span><span style="color:#f92672;">servlet</span><span>&gt;
</span><span>&lt;</span><span style="color:#f92672;">servlet-mapping</span><span>&gt;
</span><span>    &lt;</span><span style="color:#f92672;">servlet-name</span><span>&gt;dispatcher&lt;/</span><span style="color:#f92672;">servlet-name</span><span>&gt;
</span><span>    &lt;</span><span style="color:#f92672;">url-pattern</span><span>&gt;/&lt;/</span><span style="color:#f92672;">url-pattern</span><span>&gt;
</span><span>&lt;/</span><span style="color:#f92672;">servlet-mapping</span><span>&gt;
</span></code></pre>
<h5 id="2-java-pei-zhi"><strong>2. Java 配置</strong></h5>
<p>通过 Java 类配置 <code>DispatcherServlet</code>：</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">WebAppInitializer </span><span style="color:#f92672;">extends </span><span style="text-decoration:underline;font-style:italic;color:#a6e22e;">AbstractAnnotationConfigDispatcherServletInitializer </span><span>{
</span><span>    @Override
</span><span>    </span><span style="color:#f92672;">protected </span><span style="font-style:italic;color:#66d9ef;">Class</span><span>&lt;</span><span style="color:#f92672;">?</span><span>&gt;</span><span style="color:#f92672;">[] </span><span style="color:#a6e22e;">getRootConfigClasses</span><span>() {
</span><span>        </span><span style="color:#f92672;">return new </span><span style="font-style:italic;color:#66d9ef;">Class</span><span>&lt;</span><span style="color:#f92672;">?</span><span>&gt;[] { </span><span style="font-style:italic;color:#66d9ef;">RootConfig</span><span>.class };
</span><span>    }
</span><span>
</span><span>    @Override
</span><span>    </span><span style="color:#f92672;">protected </span><span style="font-style:italic;color:#66d9ef;">Class</span><span>&lt;</span><span style="color:#f92672;">?</span><span>&gt;</span><span style="color:#f92672;">[] </span><span style="color:#a6e22e;">getServletConfigClasses</span><span>() {
</span><span>        </span><span style="color:#f92672;">return new </span><span style="font-style:italic;color:#66d9ef;">Class</span><span>&lt;</span><span style="color:#f92672;">?</span><span>&gt;[] { </span><span style="font-style:italic;color:#66d9ef;">WebConfig</span><span>.class };
</span><span>    }
</span><span>
</span><span>    @Override
</span><span>    </span><span style="color:#f92672;">protected </span><span style="font-style:italic;color:#66d9ef;">String</span><span style="color:#f92672;">[] </span><span style="color:#a6e22e;">getServletMappings</span><span>() {
</span><span>        </span><span style="color:#f92672;">return new </span><span style="font-style:italic;color:#66d9ef;">String</span><span>[] { </span><span style="color:#e6db74;">&quot;/&quot; </span><span>};
</span><span>    }
</span><span>}
</span></code></pre>
<hr />
<h4 id="3-dispatcherservlet-de-te-xing"><strong>3. DispatcherServlet 的特性</strong></h4>
<ol>
<li><strong>灵活的路由</strong>:
• 支持基于注解的路由配置（如 <code>@RequestMapping</code>），也支持传统的 XML 配置。</li>
<li><strong>强大的扩展性</strong>:
• 可以通过自定义 <code>HandlerMapping</code>、<code>HandlerAdapter</code> 等组件扩展功能。</li>
<li><strong>异常处理</strong>:
• 支持全局异常处理（如 <code>@ControllerAdvice</code>）和局部异常处理（如 <code>@ExceptionHandler</code>）。</li>
<li><strong>文件上传</strong>:
• 内置对文件上传的支持，可以通过 <code>MultipartResolver</code> 轻松处理文件上传请求。</li>
<li><strong>视图解析</strong>:
• 支持多种视图技术（如 JSP、Thymeleaf、FreeMarker 等），并可以通过 <code>ViewResolver</code> 灵活配置。</li>
</ol>
<hr />
<h4 id="4-dispatcherservlet-de-chang-jian-wen-ti"><strong>4. DispatcherServlet 的常见问题</strong></h4>
<ol>
<li><strong>URL 映射冲突</strong>:
• 如果多个处理器映射到同一个 URL，可能会导致冲突。需要确保 URL 映射的唯一性。</li>
<li><strong>性能问题</strong>:
• <code>DispatcherServlet</code> 处理请求时会涉及多个组件的调用，可能会影响性能。可以通过缓存、异步处理等方式优化性能。</li>
<li><strong>配置错误</strong>:
• 如果 <code>HandlerMapping</code>、<code>HandlerAdapter</code> 等组件配置错误，可能会导致请求无法正确处理。需要仔细检查配置。</li>
</ol>
<h3 id="qi-ta-zu-jian">其他组件</h3>
<p><strong>HandlerExceptionResolver</strong></p>
<p>• <strong>作用</strong>: 处理请求处理过程中抛出的异常，并生成错误响应。
• <strong>常用实现</strong>:
• <code>DefaultHandlerExceptionResolver</code>: 处理 Spring MVC 内置的异常。
• <code>ExceptionHandlerExceptionResolver</code>: 处理 <code>@ExceptionHandler</code> 注解标记的方法。</p>
<p><strong>MultipartResolver</strong></p>
<p>• <strong>作用</strong>: 处理文件上传请求，解析 <code>multipart/form-data</code> 类型的请求。
• <strong>常用实现</strong>:
• <code>CommonsMultipartResolver</code>: 基于 Apache Commons FileUpload 实现。
• <code>StandardServletMultipartResolver</code>: 基于 Servlet 3.0 的 <code>Part</code> API 实现。</p>
<h2 id="san-zhu-jie-zhi-chi"><em>三、注解支持</em></h2>
<p>在 Spring MVC 框架中，注解（Annotations）是简化开发的核心工具，用于配置控制器、请求映射、参数绑定、异常处理等。</p>
<p>Spring MVC 提供的控制器注解使用灵活，无需扩展基类或实现特定接口。</p>
<p>• <strong>@Controller</strong>: 标识一个类为Spring MVC的Controller。
• <strong>@RequestMapping</strong>: 映射URL到Controller的方法。
• <strong>@RequestParam</strong>: 绑定请求参数到方法参数。
• <strong>@PathVariable</strong>: 绑定URL中的变量到方法参数。
• <strong>@ModelAttribute</strong>: 绑定表单数据到模型对象。
• <strong>@ResponseBody</strong>: 将方法返回值直接写入HTTP响应体，通常用于返回JSON或XML数据。</p>
<p><strong>REST支持</strong></p>
<p>• Spring MVC支持构建RESTful Web服务，可以通过@RestController注解简化REST API的开发。
• 支持内容协商（Content Negotiation），可以根据请求的Accept头返回不同的响应格式（如JSON、XML）。</p>
<p>详见处理请求映射中RESTful风格的路径、视图技术中返回 JSON/XML 数据的相关内容。</p>
<hr />
<h3 id="1-zhu-jie-lie-biao">1. 注解列表</h3>
<table><thead><tr><th><strong>分组</strong></th><th><strong>注解</strong></th><th><strong>作用</strong></th><th><strong>注解位置</strong></th></tr></thead><tbody>
<tr><td><strong>控制器相关注解</strong></td><td><code>@Controller</code></td><td>标记一个类为 Spring MVC 控制器，通常用于返回视图（如 JSP、Thymeleaf）。</td><td>类</td></tr>
<tr><td></td><td><code>@RestController</code></td><td>标记一个类为 RESTful 控制器，默认返回 JSON 或 XML 数据。</td><td>类</td></tr>
<tr><td><strong>请求映射相关注解</strong></td><td><code>@RequestMapping</code></td><td>将 HTTP 请求映射到控制器方法，支持 URL、请求方法、请求头等条件。</td><td>类或方法</td></tr>
<tr><td></td><td><code>@GetMapping</code></td><td>将 GET 请求映射到控制器方法。</td><td>方法</td></tr>
<tr><td></td><td><code>@PostMapping</code></td><td>将 POST 请求映射到控制器方法。</td><td>方法</td></tr>
<tr><td></td><td><code>@PutMapping</code></td><td>将 PUT 请求映射到控制器方法。</td><td>方法</td></tr>
<tr><td></td><td><code>@DeleteMapping</code></td><td>将 DELETE 请求映射到控制器方法。</td><td>方法</td></tr>
<tr><td></td><td><code>@PatchMapping</code></td><td>将 PATCH 请求映射到控制器方法。</td><td>方法</td></tr>
<tr><td><strong>请求参数绑定注解</strong></td><td><code>@RequestParam</code></td><td>从请求中提取查询参数或表单数据。</td><td>方法参数</td></tr>
<tr><td></td><td><code>@PathVariable</code></td><td>从 URL 路径中提取变量值。</td><td>方法参数</td></tr>
<tr><td></td><td><code>@RequestBody</code></td><td>将请求体（如 JSON 或 XML）绑定到方法参数。</td><td>方法参数</td></tr>
<tr><td></td><td><code>@RequestHeader</code></td><td>从请求头中提取指定字段的值。</td><td>方法参数</td></tr>
<tr><td></td><td><code>@CookieValue</code></td><td>从 Cookie 中提取指定字段的值。</td><td>方法参数</td></tr>
<tr><td></td><td><code>@ModelAttribute</code></td><td>将请求参数绑定到模型对象，通常用于表单提交。</td><td>方法或方法参数</td></tr>
<tr><td><strong>响应相关注解</strong></td><td><code>@ResponseBody</code></td><td>将方法的返回值直接写入 HTTP 响应体，通常用于返回 JSON 或 XML 数据。</td><td>方法</td></tr>
<tr><td></td><td><code>@ResponseStatus</code></td><td>指定 HTTP 响应的状态码。</td><td>方法或异常处理方法</td></tr>
<tr><td></td><td><code>@RestController</code></td><td>结合了 <code>@Controller</code> 和 <code>@ResponseBody</code>，默认返回 JSON 或 XML 数据。</td><td>类</td></tr>
<tr><td><strong>视图相关注解</strong></td><td><code>@ModelAttribute</code></td><td>将数据添加到模型中，供视图使用。</td><td>方法或方法参数</td></tr>
<tr><td></td><td><code>@SessionAttributes</code></td><td>将模型数据存储在会话中，供多个请求共享。</td><td>类</td></tr>
<tr><td></td><td><code>@CrossOrigin</code></td><td>允许跨域请求，通常用于 RESTful API。</td><td>类或方法</td></tr>
<tr><td><strong>异常处理相关注解</strong></td><td><code>@ExceptionHandler</code></td><td>在控制器中定义异常处理方法，处理特定类型的异常。</td><td>方法</td></tr>
<tr><td></td><td><code>@ControllerAdvice</code></td><td>全局异常处理类，处理所有控制器中抛出的异常。</td><td>类</td></tr>
<tr><td></td><td><code>@ResponseStatus</code></td><td>在异常处理方法中指定 HTTP 响应的状态码。</td><td>方法或异常处理方法</td></tr>
<tr><td><strong>配置相关注解</strong></td><td><code>@EnableWebMvc</code></td><td>启用 Spring MVC 的默认配置，通常用于 Java 配置类。</td><td>类</td></tr>
<tr><td></td><td><code>@Configuration</code></td><td>标记一个类为配置类，用于定义 Spring Bean。</td><td>类</td></tr>
<tr><td></td><td><code>@ComponentScan</code></td><td>扫描指定包下的组件（如控制器、服务等）。</td><td>类</td></tr>
<tr><td><strong>其他常用注解</strong></td><td><code>@Valid</code></td><td>对方法参数进行数据校验，通常与 <code>@RequestBody</code> 或 <code>@ModelAttribute</code> 结合使用。</td><td>方法参数</td></tr>
<tr><td></td><td><code>@InitBinder</code></td><td>自定义数据绑定逻辑，通常用于日期格式化等场景。</td><td>方法</td></tr>
<tr><td></td><td><code>@Profile</code></td><td>指定配置或组件在特定环境下生效。</td><td>类或方法</td></tr>
</tbody></table>
<h3 id="2-zhu-jie-shi-yong-chang-jing">2. 注解使用场景</h3>
<table><thead><tr><th>注解</th><th>作用</th><th>注解位置</th><th>重要事项</th></tr></thead><tbody>
<tr><td><code>@Controller</code></td><td>标记控制器类</td><td>类级别</td><td>需配合 <code>@ResponseBody</code> 返回数据</td></tr>
<tr><td><code>@RestController</code></td><td>标记 RESTful 控制器</td><td>类级别</td><td>默认返回 JSON/XML 数据</td></tr>
<tr><td><code>@RequestMapping</code></td><td>映射 HTTP 请求</td><td>类/方法级别</td><td>支持多种 HTTP 方法</td></tr>
<tr><td><code>@GetMapping</code> 等</td><td>简化 <code>@RequestMapping</code></td><td>方法级别</td><td>分别处理 GET、POST、PUT、DELETE 请求</td></tr>
<tr><td><code>@PathVariable</code></td><td>绑定 URL 路径变量</td><td>方法参数级别</td><td>路径变量名称与参数名称一致时可省略</td></tr>
<tr><td><code>@RequestParam</code></td><td>绑定请求参数</td><td>方法参数级别</td><td>支持默认值和必填校验</td></tr>
<tr><td><code>@RequestBody</code></td><td>绑定请求体</td><td>方法参数级别</td><td>通常用于 POST/PUT 请求</td></tr>
<tr><td><code>@ResponseBody</code></td><td>将返回值写入响应体</td><td>方法级别</td><td>通常与 <code>@Controller</code> 结合使用</td></tr>
<tr><td><code>@ExceptionHandler</code></td><td>处理控制器中的异常</td><td>方法级别</td><td>只能处理当前控制器的异常</td></tr>
<tr><td><code>@ControllerAdvice</code></td><td>全局处理异常</td><td>类级别</td><td>避免重复定义异常处理方法</td></tr>
<tr><td><code>@ModelAttribute</code></td><td>绑定请求参数或添加模型属性</td><td>方法/参数级别</td><td>用于共享数据</td></tr>
<tr><td><code>@SessionAttributes</code></td><td>将模型属性存储到会话中</td><td>类级别</td><td>适用于跨请求共享数据</td></tr>
</tbody></table>
<h4 id="ji-ben-kong-zhi-qi-shi-li"><strong>基本控制器示例</strong></h4>
<p><strong>@Controller</strong>用于标记一个类为Spring MVC控制器。通常与@RequestMapping、@GetMapping、@PostMapping等注解一起使用。</p>
<p><strong>@GetMapping</strong>: 用于将HTTP GET请求映射到控制器的方法上。可以与@RequestParam、@PathVariable等注解一起使用。</p>
<hr />
<h5 id="shi-li-shi-yong-controller-he-getmapping">示例 : 使用 <code>@Controller</code> 和 <code>@GetMapping</code></h5>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Controller
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">HomeController </span><span>{
</span><span>
</span><span>    @GetMapping(</span><span style="color:#e6db74;">&quot;/home&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="color:#a6e22e;">home</span><span>(</span><span style="font-style:italic;color:#66d9ef;">Model </span><span style="font-style:italic;color:#fd971f;">model</span><span>) {
</span><span>        model.addAttribute(</span><span style="color:#e6db74;">&quot;message&quot;</span><span>, </span><span style="color:#e6db74;">&quot;Welcome to the Home Page!&quot;</span><span>);
</span><span>        </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;home&quot;</span><span>; </span><span style="color:#75715e;">// 返回视图名称
</span><span>    }
</span><span>}
</span></code></pre>
<p>• <strong>请求</strong>: <code>GET /home</code>
• <strong>响应</strong>: 渲染 <code>home.html</code> 视图，并传递 <code>message</code> 属性。</p>
<hr />
<h4 id="ji-ben-kong-zhi-qi-shi-li-1"><strong>基本控制器示例</strong></h4>
<p><strong>@RequestMapping</strong>用于将HTTP请求映射到控制器的方法上，可以注解在类上或方法上，还可以指定请求的URL、HTTP方法（GET、POST等）、请求参数等信息。可以与@RequestParam、@PathVariable等注解一起使用。</p>
<p><strong><code>@RequestMapping</code></strong></p>
<p>映射 HTTP 请求到控制器方法，支持指定 URL、请求方法、请求参数等。</p>
<p>类级别或方法级别。</p>
<p>• <code>value</code>：指定 URL 路径。
• <code>method</code>：指定 HTTP 请求方法（如 <code>RequestMethod.GET</code>）。
• <code>produces</code>：指定响应的媒体类型（如 <code>application/json</code>）。
• <code>consumes</code>：指定请求的媒体类型。</p>
<p><strong>使用示例</strong></p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Controller
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">HomeController </span><span>{
</span><span>    @RequestMapping(</span><span style="font-style:italic;color:#fd971f;">value </span><span style="color:#f92672;">= </span><span style="color:#e6db74;">&quot;/home&quot;</span><span>, </span><span style="font-style:italic;color:#fd971f;">method </span><span style="color:#f92672;">= </span><span style="font-style:italic;color:#66d9ef;">RequestMethod</span><span>.</span><span style="color:#ae81ff;">GET</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="color:#a6e22e;">home</span><span>() {
</span><span>        </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;home&quot;</span><span>;
</span><span>    }
</span><span>}
</span></code></pre>
<p><strong>重要事项</strong></p>
<p>• 可以用 <code>@GetMapping</code>、<code>@PostMapping</code> 等简化写法。
• 支持通配符（如 <code>/user/*</code>）和路径变量（如 <code>/user/{id}</code>）。</p>
<h5 id="shi-li-shi-yong-controller-he-requestmapping">示例 : 使用 <code>@Controller</code> 和 <code>@RequestMapping</code></h5>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Controller
</span><span>@RequestMapping(</span><span style="color:#e6db74;">&quot;/api&quot;</span><span>)
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">ApiController </span><span>{
</span><span>  @RequestMapping(</span><span style="font-style:italic;color:#fd971f;">value </span><span style="color:#f92672;">= </span><span style="color:#e6db74;">&quot;/hello&quot;</span><span>, </span><span style="font-style:italic;color:#fd971f;">method </span><span style="color:#f92672;">= </span><span style="font-style:italic;color:#66d9ef;">RequestMethod</span><span>.</span><span style="color:#ae81ff;">GET</span><span>)
</span><span>  </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="color:#a6e22e;">handle</span><span>() {
</span><span>      </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;Hello World!&quot;</span><span>;
</span><span>  }
</span><span>}
</span></code></pre>
<p>• <strong>请求</strong>: <code>GET /api/hello</code>
• <strong>响应</strong>: </p>
<hr />
<p>@ResponseBody</p>
<p>• <strong>作用</strong>: 用于将控制器方法的返回值直接写入HTTP响应体，而不是视图。
• <strong>位置</strong>: 方法级别。
• <strong>配合使用</strong>: 通常与@Controller注解一起使用。
• <strong>示例</strong>:</p>
<pre style="background-color:#272822;color:#f8f8f2;"><code><span>@Controller
</span><span>public class HelloController {
</span><span>    @GetMapping(&quot;/hello&quot;)
</span><span>    @ResponseBody
</span><span>    public String handle() {
</span><span>        return &quot;Hello World!&quot;;
</span><span>    }
</span><span>}
</span></code></pre>
<h4 id="huo-qu-qing-qiu-xiao-xi-tou-he-xiao-xi-ti">获取请求消息头和消息体</h4>
<p>在Spring MVC中，可以通过以下方式获取请求的消息头和消息体：</p>
<ol>
<li><strong>获取请求头</strong>:
• 使用<code>@RequestHeader</code>注解：可以将请求头直接注入到Controller方法的参数中。</li>
</ol>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@GetMapping(</span><span style="color:#e6db74;">&quot;/example&quot;</span><span>)
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span>example(@RequestHeader(</span><span style="color:#e6db74;">&quot;User-Agent&quot;</span><span>) </span><span style="font-style:italic;color:#66d9ef;">String</span><span> userAgent) {
</span><span>    </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;User-Agent: &quot; </span><span style="color:#f92672;">+</span><span> userAgent;
</span><span>}
</span></code></pre>
<ol start="2">
<li><strong>获取请求体</strong>:
• 使用<code>@RequestBody</code>注解：可以将请求体（通常是JSON或XML）直接绑定到方法的参数中。</li>
</ol>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@PostMapping(</span><span style="color:#e6db74;">&quot;/example&quot;</span><span>)
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span>example(@</span><span style="font-style:italic;color:#66d9ef;">RequestBody User</span><span> user) {
</span><span>    </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;Received user: &quot; </span><span style="color:#f92672;">+</span><span> user.getName();
</span><span>}
</span></code></pre>
<ol start="3">
<li><strong>获取请求参数</strong>:
• 使用<code>@RequestParam</code>注解：可以将请求参数（通常是URL中的查询参数或表单数据）直接注入到方法的参数中。</li>
</ol>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@GetMapping(</span><span style="color:#e6db74;">&quot;/example&quot;</span><span>)
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span>example(@RequestParam(</span><span style="color:#e6db74;">&quot;name&quot;</span><span>) </span><span style="font-style:italic;color:#66d9ef;">String</span><span> name) {
</span><span>    </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;Hello, &quot; </span><span style="color:#f92672;">+</span><span> name;
</span><span>}
</span></code></pre>
<ol start="4">
<li><strong>获取整个请求对象</strong>:
• 使用<code>HttpServletRequest</code>对象：可以通过注入<code>HttpServletRequest</code>对象来获取请求的所有信息，包括请求头、请求体、请求参数等。</li>
</ol>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@GetMapping(</span><span style="color:#e6db74;">&quot;/example&quot;</span><span>)
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span>example(</span><span style="font-style:italic;color:#66d9ef;">HttpServletRequest</span><span> request) {
</span><span>    </span><span style="font-style:italic;color:#66d9ef;">String</span><span> userAgent </span><span style="color:#f92672;">=</span><span> request.getHeader(</span><span style="color:#e6db74;">&quot;User-Agent&quot;</span><span>);
</span><span>    </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;User-Agent: &quot; </span><span style="color:#f92672;">+</span><span> userAgent;
</span><span>}
</span></code></pre>
<p>通过这些方式，Spring MVC可以灵活地处理不同类型的请求，并获取请求中的各种信息。</p>
<hr />
<h4 id="chu-li-cha-xun-can-shu"><strong>处理查询参数</strong></h4>
<p>** <code>@RequestParam</code>**将 HTTP 请求参数绑定到方法参数，注解在方法参数上。适用于 GET 请求的查询参数或 POST 请求的表单参数。</p>
<p>主要属性**</p>
<p>• <code>value</code>：指定请求参数名称（默认为参数名称）。
• <code>required</code>：指定参数是否必须（默认为 <code>true</code>）。
• <code>defaultValue</code>：指定参数的默认值。</p>
<h5 id="shi-li-3-shi-yong-getmapping-he-requestparam">示例 3: 使用 <code>@GetMapping</code> 和 <code>@RequestParam</code></h5>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Controller
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">SearchController </span><span>{
</span><span>
</span><span>    @GetMapping(</span><span style="color:#e6db74;">&quot;/search&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="color:#a6e22e;">search</span><span>(@RequestParam </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="font-style:italic;color:#fd971f;">query</span><span>, </span><span style="font-style:italic;color:#66d9ef;">Model </span><span style="font-style:italic;color:#fd971f;">model</span><span>) {
</span><span>        model.addAttribute(</span><span style="color:#e6db74;">&quot;query&quot;</span><span>, query);
</span><span>        </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;search&quot;</span><span>; </span><span style="color:#75715e;">// 返回搜索结果视图
</span><span>    }
</span><span>}
</span></code></pre>
<p>• <strong>请求</strong>: <code>GET /search?query=Spring</code>
• <strong>响应</strong>: 渲染 <code>search.html</code> 视图，并传递 <code>query</code> 属性。</p>
<h5 id="shi-li-10-chu-li-bu-er-can-shu-shi-yong-requestparam-chu-li-bu-er-lei-xing">示例 10: 处理布尔参数，使用 <code>@RequestParam</code> 处理布尔类型</h5>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Controller
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">FeatureController </span><span>{
</span><span>
</span><span>    @GetMapping(</span><span style="color:#e6db74;">&quot;/feature&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="color:#a6e22e;">checkFeature</span><span>(@RequestParam </span><span style="font-style:italic;color:#66d9ef;">boolean </span><span style="font-style:italic;color:#fd971f;">enabled</span><span>, </span><span style="font-style:italic;color:#66d9ef;">Model </span><span style="font-style:italic;color:#fd971f;">model</span><span>) {
</span><span>        model.addAttribute(</span><span style="color:#e6db74;">&quot;status&quot;</span><span>, enabled </span><span style="color:#f92672;">? </span><span style="color:#e6db74;">&quot;enabled&quot; </span><span style="color:#f92672;">: </span><span style="color:#e6db74;">&quot;disabled&quot;</span><span>);
</span><span>        </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;feature&quot;</span><span>; </span><span style="color:#75715e;">// 返回功能状态视图
</span><span>    }
</span><span>}
</span></code></pre>
<p>• <strong>请求</strong>: <code>GET /feature?enabled=true</code>
• <strong>响应</strong>: 渲染 <code>feature.html</code> 视图，显示 <code>Feature is enabled</code>。</p>
<hr />
<h5 id="shi-li-4-chu-li-duo-ge-cha-xun-can-shu-shi-yong-getmapping-he-duo-ge-requestparam">示例 4: <strong>处理多个查询参数</strong>，使用 <code>@GetMapping</code> 和多个 <code>@RequestParam</code></h5>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Controller
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">ProductController </span><span>{
</span><span>
</span><span>    @GetMapping(</span><span style="color:#e6db74;">&quot;/products&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="color:#a6e22e;">getProducts</span><span>(
</span><span>            @RequestParam </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="font-style:italic;color:#fd971f;">category</span><span>,
</span><span>            @RequestParam </span><span style="font-style:italic;color:#66d9ef;">double </span><span style="font-style:italic;color:#fd971f;">minPrice</span><span>,
</span><span>            @RequestParam </span><span style="font-style:italic;color:#66d9ef;">double </span><span style="font-style:italic;color:#fd971f;">maxPrice</span><span>,
</span><span>            </span><span style="font-style:italic;color:#66d9ef;">Model </span><span style="font-style:italic;color:#fd971f;">model</span><span>) {
</span><span>        model.addAttribute(</span><span style="color:#e6db74;">&quot;category&quot;</span><span>, category);
</span><span>        model.addAttribute(</span><span style="color:#e6db74;">&quot;minPrice&quot;</span><span>, minPrice);
</span><span>        model.addAttribute(</span><span style="color:#e6db74;">&quot;maxPrice&quot;</span><span>, maxPrice);
</span><span>        </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;products&quot;</span><span>; </span><span style="color:#75715e;">// 返回产品列表视图
</span><span>    }
</span><span>}
</span></code></pre>
<p>• <strong>请求</strong>: <code>GET /products?category=Electronics&amp;minPrice=100&amp;maxPrice=500</code>
• <strong>响应</strong>: 渲染 <code>products.html</code> 视图，并传递 <code>category</code>、<code>minPrice</code> 和 <code>maxPrice</code> 属性。</p>
<hr />
<h5 id="shi-li-5-chu-li-ke-xuan-can-shu-shi-yong-requestparam-de-required-shu-xing">示例 5: 处理可选参数，使用 <code>@RequestParam</code> 的 <code>required</code> 属性</h5>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Controller
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">GreetingController </span><span>{
</span><span>
</span><span>    @GetMapping(</span><span style="color:#e6db74;">&quot;/greet&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="color:#a6e22e;">greet</span><span>(@RequestParam(</span><span style="font-style:italic;color:#fd971f;">required </span><span style="color:#f92672;">= </span><span style="color:#ae81ff;">false</span><span>, </span><span style="font-style:italic;color:#fd971f;">defaultValue </span><span style="color:#f92672;">= </span><span style="color:#e6db74;">&quot;Guest&quot;</span><span>) </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="font-style:italic;color:#fd971f;">name</span><span>, </span><span style="font-style:italic;color:#66d9ef;">Model </span><span style="font-style:italic;color:#fd971f;">model</span><span>) {
</span><span>        model.addAttribute(</span><span style="color:#e6db74;">&quot;message&quot;</span><span>, </span><span style="color:#e6db74;">&quot;Hello, &quot; </span><span style="color:#f92672;">+</span><span> name </span><span style="color:#f92672;">+ </span><span style="color:#e6db74;">&quot;!&quot;</span><span>);
</span><span>        </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;greet&quot;</span><span>; </span><span style="color:#75715e;">// 返回问候视图
</span><span>    }
</span><span>}
</span></code></pre>
<p>• <strong>请求</strong>: <code>GET /greet</code>
• <strong>响应</strong>: 渲染 <code>greet.html</code> 视图，显示 <code>Hello, Guest!</code>。
• <strong>请求</strong>: <code>GET /greet?name=John</code>
• <strong>响应</strong>: 渲染 <code>greet.html</code> 视图，显示 <code>Hello, John!</code>。</p>
<h5 id="shi-li-7-chu-li-shu-zu-huo-lie-biao-can-shu-shi-yong-requestparam-jie-shou-lie-biao">示例 7: 处理数组或列表参数，使用 <code>@RequestParam</code> 接收列表</h5>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Controller
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">TagController </span><span>{
</span><span>
</span><span>    @GetMapping(</span><span style="color:#e6db74;">&quot;/tags&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="color:#a6e22e;">getTags</span><span>(@RequestParam </span><span style="font-style:italic;color:#66d9ef;">List</span><span>&lt;</span><span style="font-style:italic;color:#66d9ef;">String</span><span>&gt; </span><span style="font-style:italic;color:#fd971f;">tags</span><span>, </span><span style="font-style:italic;color:#66d9ef;">Model </span><span style="font-style:italic;color:#fd971f;">model</span><span>) {
</span><span>        model.addAttribute(</span><span style="color:#e6db74;">&quot;tags&quot;</span><span>, tags);
</span><span>        </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;tags&quot;</span><span>; </span><span style="color:#75715e;">// 返回标签视图
</span><span>    }
</span><span>}
</span></code></pre>
<p>• <strong>请求</strong>: <code>GET /tags?tags=Java&amp;tags=Spring&amp;tags=Hibernate</code>
• <strong>响应</strong>: 渲染 <code>tags.html</code> 视图，并传递 <code>tags</code> 列表。</p>
<hr />
<h5 id="shi-li-8-chu-li-fu-za-cha-xun-can-shu-shi-yong-requestparam-chu-li-fu-za-cha-xun">示例 8: 处理复杂查询参数，使用 <code>@RequestParam</code> 处理复杂查询</h5>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Controller
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">OrderController </span><span>{
</span><span>
</span><span>    @GetMapping(</span><span style="color:#e6db74;">&quot;/orders&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="color:#a6e22e;">getOrders</span><span>(
</span><span>            @RequestParam </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="font-style:italic;color:#fd971f;">status</span><span>,
</span><span>            @RequestParam @DateTimeFormat(</span><span style="font-style:italic;color:#fd971f;">iso </span><span style="color:#f92672;">= </span><span style="font-style:italic;color:#66d9ef;">DateTimeFormat</span><span>.</span><span style="color:#ae81ff;">ISO</span><span>.</span><span style="color:#ae81ff;">DATE</span><span>) </span><span style="font-style:italic;color:#66d9ef;">LocalDate </span><span style="font-style:italic;color:#fd971f;">startDate</span><span>,
</span><span>            @RequestParam @DateTimeFormat(</span><span style="font-style:italic;color:#fd971f;">iso </span><span style="color:#f92672;">= </span><span style="font-style:italic;color:#66d9ef;">DateTimeFormat</span><span>.</span><span style="color:#ae81ff;">ISO</span><span>.</span><span style="color:#ae81ff;">DATE</span><span>) </span><span style="font-style:italic;color:#66d9ef;">LocalDate </span><span style="font-style:italic;color:#fd971f;">endDate</span><span>,
</span><span>            </span><span style="font-style:italic;color:#66d9ef;">Model </span><span style="font-style:italic;color:#fd971f;">model</span><span>) {
</span><span>        model.addAttribute(</span><span style="color:#e6db74;">&quot;status&quot;</span><span>, status);
</span><span>        model.addAttribute(</span><span style="color:#e6db74;">&quot;startDate&quot;</span><span>, startDate);
</span><span>        model.addAttribute(</span><span style="color:#e6db74;">&quot;endDate&quot;</span><span>, endDate);
</span><span>        </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;orders&quot;</span><span>; </span><span style="color:#75715e;">// 返回订单视图
</span><span>    }
</span><span>}
</span></code></pre>
<p>• <strong>请求</strong>: <code>GET /orders?status=Shipped&amp;startDate=2023-01-01&amp;endDate=2023-12-31</code>
• <strong>响应</strong>: 渲染 <code>orders.html</code> 视图，并传递 <code>status</code>、<code>startDate</code> 和 <code>endDate</code> 属性。</p>
<hr />
<h4 id="chu-li-biao-dan-ti-jiao"><strong>处理表单提交</strong></h4>
<p><strong>@PostMapping</strong>用于将HTTP POST请求映射到控制器的方法上。可以与@RequestBody、@RequestParam等注解一起使用。</p>
<h5 id="shi-li-2-shi-yong-controller-he-postmapping">示例 2: 使用 <code>@Controller</code> 和 <code>@PostMapping</code></h5>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Controller
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">FormController </span><span>{
</span><span>
</span><span>    @GetMapping(</span><span style="color:#e6db74;">&quot;/form&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="color:#a6e22e;">showForm</span><span>(</span><span style="font-style:italic;color:#66d9ef;">Model </span><span style="font-style:italic;color:#fd971f;">model</span><span>) {
</span><span>        model.addAttribute(</span><span style="color:#e6db74;">&quot;user&quot;</span><span>, </span><span style="color:#f92672;">new </span><span style="font-style:italic;color:#66d9ef;">User</span><span>());
</span><span>        </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;form&quot;</span><span>; </span><span style="color:#75715e;">// 返回表单视图
</span><span>    }
</span><span>
</span><span>    @PostMapping(</span><span style="color:#e6db74;">&quot;/submit&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="color:#a6e22e;">submitForm</span><span>(@ModelAttribute </span><span style="font-style:italic;color:#66d9ef;">User </span><span style="font-style:italic;color:#fd971f;">user</span><span>, </span><span style="font-style:italic;color:#66d9ef;">Model </span><span style="font-style:italic;color:#fd971f;">model</span><span>) {
</span><span>        model.addAttribute(</span><span style="color:#e6db74;">&quot;message&quot;</span><span>, </span><span style="color:#e6db74;">&quot;User &quot; </span><span style="color:#f92672;">+</span><span> user.getName() </span><span style="color:#f92672;">+ </span><span style="color:#e6db74;">&quot; submitted successfully!&quot;</span><span>);
</span><span>        </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;result&quot;</span><span>; </span><span style="color:#75715e;">// 返回结果视图
</span><span>    }
</span><span>}
</span></code></pre>
<p>• <strong>请求</strong>: <code>GET /form</code>
• <strong>响应</strong>: 渲染 <code>form.html</code> 视图，显示表单。
• <strong>请求</strong>: <code>POST /submit</code> (表单提交)
• <strong>响应</strong>: 渲染 <code>result.html</code> 视图，显示提交结果。</p>
<h5 id="shi-li-6-chu-li-biao-dan-ti-jiao-bing-yan-zheng-can-shu-shi-yong-postmapping-he-requestparam">示例 6: 处理表单提交并验证参数，使用 <code>@PostMapping</code> 和 <code>@RequestParam</code></h5>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Controller
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">LoginController </span><span>{
</span><span>
</span><span>    @GetMapping(</span><span style="color:#e6db74;">&quot;/login&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="color:#a6e22e;">showLoginForm</span><span>() {
</span><span>        </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;login&quot;</span><span>; </span><span style="color:#75715e;">// 返回登录表单视图
</span><span>    }
</span><span>
</span><span>    @PostMapping(</span><span style="color:#e6db74;">&quot;/login&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="color:#a6e22e;">login</span><span>(
</span><span>            @RequestParam </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="font-style:italic;color:#fd971f;">username</span><span>,
</span><span>            @RequestParam </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="font-style:italic;color:#fd971f;">password</span><span>,
</span><span>            </span><span style="font-style:italic;color:#66d9ef;">Model </span><span style="font-style:italic;color:#fd971f;">model</span><span>) {
</span><span>        </span><span style="color:#f92672;">if </span><span>(</span><span style="color:#e6db74;">&quot;admin&quot;</span><span>.equals(username) </span><span style="color:#f92672;">&amp;&amp; </span><span style="color:#e6db74;">&quot;password&quot;</span><span>.equals(password)) {
</span><span>            model.addAttribute(</span><span style="color:#e6db74;">&quot;message&quot;</span><span>, </span><span style="color:#e6db74;">&quot;Login successful!&quot;</span><span>);
</span><span>        } </span><span style="color:#f92672;">else </span><span>{
</span><span>            model.addAttribute(</span><span style="color:#e6db74;">&quot;message&quot;</span><span>, </span><span style="color:#e6db74;">&quot;Invalid credentials!&quot;</span><span>);
</span><span>        }
</span><span>        </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;loginResult&quot;</span><span>; </span><span style="color:#75715e;">// 返回登录结果视图
</span><span>    }
</span><span>}
</span></code></pre>
<p>• <strong>请求</strong>: <code>GET /login</code>
• <strong>响应</strong>: 渲染 <code>login.html</code> 视图，显示登录表单。
• <strong>请求</strong>: <code>POST /login</code> (表单提交)
• <strong>响应</strong>: 渲染 <code>loginResult.html</code> 视图，显示登录结果。</p>
<hr />
<p>**7. <code>@RequestBody</code>**将 HTTP 请求体（通常为 JSON/XML）绑定到方法参数。通常用于 POST 或 PUT 请求，传递复杂对象。</p>
<p><strong>使用示例</strong></p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@RestController
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">UserController </span><span>{
</span><span>    @PostMapping(</span><span style="color:#e6db74;">&quot;/user&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">User </span><span style="color:#a6e22e;">createUser</span><span>(@RequestBody </span><span style="font-style:italic;color:#66d9ef;">User </span><span style="font-style:italic;color:#fd971f;">user</span><span>) {
</span><span>        </span><span style="color:#f92672;">return</span><span> user;
</span><span>    }
</span><span>}
</span></code></pre>
<hr />
<h5 id="shi-li-11-jie-he-modelattribute-shi-yong-postmapping-he-modelattribute">示例 11: 结合 <code>@ModelAttribute</code>，使用 <code>@PostMapping</code> 和 <code>@ModelAttribute</code></h5>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Controller
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">RegistrationController </span><span>{
</span><span>
</span><span>    @GetMapping(</span><span style="color:#e6db74;">&quot;/register&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="color:#a6e22e;">showRegistrationForm</span><span>(</span><span style="font-style:italic;color:#66d9ef;">Model </span><span style="font-style:italic;color:#fd971f;">model</span><span>) {
</span><span>        model.addAttribute(</span><span style="color:#e6db74;">&quot;user&quot;</span><span>, </span><span style="color:#f92672;">new </span><span style="font-style:italic;color:#66d9ef;">User</span><span>());
</span><span>        </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;register&quot;</span><span>; </span><span style="color:#75715e;">// 返回注册表单视图
</span><span>    }
</span><span>
</span><span>    @PostMapping(</span><span style="color:#e6db74;">&quot;/register&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="color:#a6e22e;">registerUser</span><span>(@ModelAttribute </span><span style="font-style:italic;color:#66d9ef;">User </span><span style="font-style:italic;color:#fd971f;">user</span><span>, </span><span style="font-style:italic;color:#66d9ef;">Model </span><span style="font-style:italic;color:#fd971f;">model</span><span>) {
</span><span>        model.addAttribute(</span><span style="color:#e6db74;">&quot;message&quot;</span><span>, </span><span style="color:#e6db74;">&quot;User &quot; </span><span style="color:#f92672;">+</span><span> user.getName() </span><span style="color:#f92672;">+ </span><span style="color:#e6db74;">&quot; registered successfully!&quot;</span><span>);
</span><span>        </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;registrationResult&quot;</span><span>; </span><span style="color:#75715e;">// 返回注册结果视图
</span><span>    }
</span><span>}
</span></code></pre>
<p>• <strong>请求</strong>: <code>GET /register</code>
• <strong>响应</strong>: 渲染 <code>register.html</code> 视图，显示注册表单。
• <strong>请求</strong>: <code>POST /register</code> (表单提交)
• <strong>响应</strong>: 渲染 <code>registrationResult.html</code> 视图，显示注册结果。</p>
<p>@ModelAttribute</p>
<p>• <strong>作用</strong>: 用于将HTTP请求参数绑定到模型对象上，或者将模型对象添加到视图中。
• <strong>位置</strong>: 方法级别或方法参数级别。
• <strong>配合使用</strong>: 通常与@RequestMapping、@GetMapping等注解一起使用。
• <strong>示例</strong>:</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Controller
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">UserController </span><span>{
</span><span>    @ModelAttribute
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">void </span><span style="color:#a6e22e;">addAttributes</span><span>(</span><span style="font-style:italic;color:#66d9ef;">Model </span><span style="font-style:italic;color:#fd971f;">model</span><span>) {
</span><span>        model.addAttribute(</span><span style="color:#e6db74;">&quot;message&quot;</span><span>, </span><span style="color:#e6db74;">&quot;Hello World!&quot;</span><span>);
</span><span>    }
</span><span>
</span><span>    @GetMapping(</span><span style="color:#e6db74;">&quot;/hello&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="color:#a6e22e;">handle</span><span>() {
</span><span>        </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;index&quot;</span><span>;
</span><span>    }
</span><span>}
</span></code></pre>
<p>** <code>@ModelAttribute</code>**将请求参数绑定到模型对象，或向模型中添加属性。方法级别或方法参数级别。用于在多个请求方法之间共享数据。</p>
<p><strong>主要属性</strong></p>
<p>• <code>value</code>：指定模型属性的名称。</p>
<p><strong>使用示例</strong></p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Controller
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">UserController </span><span>{
</span><span>    @ModelAttribute(</span><span style="color:#e6db74;">&quot;user&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">User </span><span style="color:#a6e22e;">getUser</span><span>() {
</span><span>        </span><span style="color:#f92672;">return new </span><span style="font-style:italic;color:#66d9ef;">User</span><span>(</span><span style="color:#ae81ff;">1</span><span>, </span><span style="color:#e6db74;">&quot;John Doe&quot;</span><span>);
</span><span>    }
</span><span>
</span><span>    @GetMapping(</span><span style="color:#e6db74;">&quot;/user&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="color:#a6e22e;">showUser</span><span>(</span><span style="font-style:italic;color:#66d9ef;">Model </span><span style="font-style:italic;color:#fd971f;">model</span><span>) {
</span><span>        </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;user&quot;</span><span>;
</span><span>    }
</span><span>}
</span></code></pre>
<p>**12. <code>@SessionAttributes</code>**将模型属性存储到会话中，供多个请求使用。类级别。适用于需要在多个请求之间共享数据的场景。</p>
<p><strong>主要属性</strong></p>
<p>• <code>value</code>：指定要存储到会话中的模型属性名称。</p>
<p><strong>使用示例</strong></p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Controller
</span><span>@SessionAttributes(</span><span style="color:#e6db74;">&quot;user&quot;</span><span>)
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">UserController </span><span>{
</span><span>    @GetMapping(</span><span style="color:#e6db74;">&quot;/user&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="color:#a6e22e;">showUser</span><span>(</span><span style="font-style:italic;color:#66d9ef;">Model </span><span style="font-style:italic;color:#fd971f;">model</span><span>) {
</span><span>        model.addAttribute(</span><span style="color:#e6db74;">&quot;user&quot;</span><span>, </span><span style="color:#f92672;">new </span><span style="font-style:italic;color:#66d9ef;">User</span><span>(</span><span style="color:#ae81ff;">1</span><span>, </span><span style="color:#e6db74;">&quot;John Doe&quot;</span><span>));
</span><span>        </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;user&quot;</span><span>;
</span><span>    }
</span><span>}
</span></code></pre>
<h4 id="restfultfeng-ge-xiang-guan-zhu-jie">RESTfult风格相关注解</h4>
<hr />
<p>**<code>@RestController</code>**标记一个类为 RESTful 风格的控制器，该注解是 <code>@Controller</code> 和 <code>@ResponseBody</code> 的组合注解，适用于构建 RESTful API。</p>
<p>所有方法的返回值直接写入 HTTP 响应体（通常为 JSON/XML）。</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@RestController
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">UserController </span><span>{
</span><span>    @GetMapping(</span><span style="color:#e6db74;">&quot;/user&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">User </span><span style="color:#a6e22e;">getUser</span><span>() {
</span><span>        </span><span style="color:#f92672;">return new </span><span style="font-style:italic;color:#66d9ef;">User</span><span>(</span><span style="color:#ae81ff;">1</span><span>, </span><span style="color:#e6db74;">&quot;John Doe&quot;</span><span>);
</span><span>    }
</span><span>}
</span></code></pre>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@RestController
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">HelloController </span><span>{
</span><span>    @GetMapping(</span><span style="color:#e6db74;">&quot;/hello&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="color:#a6e22e;">handle</span><span>() {
</span><span>        </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;Hello World!&quot;</span><span>;
</span><span>    }
</span><span>}
</span></code></pre>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@RestController
</span><span>@RequestMapping(</span><span style="color:#e6db74;">&quot;/persons&quot;</span><span>)
</span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">PersonController </span><span>{
</span><span>
</span><span>	@GetMapping(</span><span style="color:#e6db74;">&quot;/{id}&quot;</span><span>)
</span><span>	</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">Person </span><span style="color:#a6e22e;">getPerson</span><span>(@PathVariable </span><span style="font-style:italic;color:#66d9ef;">Long </span><span style="font-style:italic;color:#fd971f;">id</span><span>) {
</span><span>		</span><span style="color:#75715e;">// ...
</span><span>	}
</span><span>	
</span><span>	@PostMapping
</span><span>	@ResponseStatus(</span><span style="font-style:italic;color:#66d9ef;">HttpStatus</span><span>.</span><span style="color:#ae81ff;">CREATED</span><span>)
</span><span>	</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">void </span><span style="color:#a6e22e;">add</span><span>(@RequestBody </span><span style="font-style:italic;color:#66d9ef;">Person </span><span style="font-style:italic;color:#fd971f;">person</span><span>) {
</span><span>		</span><span style="color:#75715e;">// ...
</span><span>	}
</span><span>
</span><span>}
</span></code></pre>
<p>@RequestParam</p>
<p>• <strong>作用</strong>: 用于将HTTP请求参数绑定到控制器方法的参数上。
• <strong>位置</strong>: 方法参数级别。
• <strong>配合使用</strong>: 通常与@RequestMapping、@GetMapping等注解一起使用。
• <strong>示例</strong>:</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@RestController
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">HelloController </span><span>{
</span><span>  @GetMapping(</span><span style="color:#e6db74;">&quot;/hello&quot;</span><span>)
</span><span>  </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="color:#a6e22e;">handle</span><span>(@RequestParam </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="font-style:italic;color:#fd971f;">name</span><span>) {
</span><span>      </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;Hello, &quot; </span><span style="color:#f92672;">+</span><span> name;
</span><span>  }
</span><span>}
</span></code></pre>
<p>@PathVariable</p>
<p>• <strong>作用</strong>: 用于将URL中的路径变量绑定到控制器方法的参数上。
• <strong>位置</strong>: 方法参数级别。
• <strong>配合使用</strong>: 通常与@RequestMapping、@GetMapping等注解一起使用。
• <strong>示例</strong>:</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@RestController
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">UserController </span><span>{
</span><span>  @GetMapping(</span><span style="color:#e6db74;">&quot;/users/{id}&quot;</span><span>)
</span><span>  </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="color:#a6e22e;">getUser</span><span>(@PathVariable </span><span style="font-style:italic;color:#66d9ef;">Long </span><span style="font-style:italic;color:#fd971f;">id</span><span>) {
</span><span>      </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;User ID: &quot; </span><span style="color:#f92672;">+</span><span> id;
</span><span>  }
</span><span>}
</span></code></pre>
<p>@RequestBody</p>
<p>• <strong>作用</strong>: 用于将HTTP请求体绑定到控制器方法的参数上，通常用于处理JSON或XML数据。
• <strong>位置</strong>: 方法参数级别。
• <strong>配合使用</strong>: 通常与@PostMapping、@PutMapping等注解一起使用。
• <strong>示例</strong>:</p>
<pre style="background-color:#272822;color:#f8f8f2;"><code><span>@RestController
</span><span>public class UserController {
</span><span>    @PostMapping(&quot;/users&quot;)
</span><span>    public String createUser(@RequestBody User user) {
</span><span>        return &quot;Created user: &quot; + user.getName();
</span><span>    }
</span><span>}
</span></code></pre>
<ol start="9">
<li><strong>结合路径变量和查询参数</strong></li>
</ol>
<h5 id="shi-li-9-shi-yong-getmapping-he-pathvariable-requestparam">示例 9: 使用 <code>@GetMapping</code> 和 <code>@PathVariable</code>、<code>@RequestParam</code></h5>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Controller
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">UserController </span><span>{
</span><span>
</span><span>    @GetMapping(</span><span style="color:#e6db74;">&quot;/users/{id}/details&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="color:#a6e22e;">getUserDetails</span><span>(
</span><span>            @PathVariable </span><span style="font-style:italic;color:#66d9ef;">Long </span><span style="font-style:italic;color:#fd971f;">id</span><span>,
</span><span>            @RequestParam </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="font-style:italic;color:#fd971f;">format</span><span>,
</span><span>            </span><span style="font-style:italic;color:#66d9ef;">Model </span><span style="font-style:italic;color:#fd971f;">model</span><span>) {
</span><span>        model.addAttribute(</span><span style="color:#e6db74;">&quot;userId&quot;</span><span>, id);
</span><span>        model.addAttribute(</span><span style="color:#e6db74;">&quot;format&quot;</span><span>, format);
</span><span>        </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;userDetails&quot;</span><span>; </span><span style="color:#75715e;">// 返回用户详情视图
</span><span>    }
</span><span>}
</span></code></pre>
<p>• <strong>请求</strong>: <code>GET /users/123/details?format=json</code>
• <strong>响应</strong>: 渲染 <code>userDetails.html</code> 视图，并传递 <code>userId</code> 和 <code>format</code> 属性。</p>
<hr />
<p>@PutMapping, @DeleteMapping, @PatchMapping</p>
<p>• <strong>作用</strong>: 分别用于将HTTP PUT、DELETE、PATCH请求映射到控制器的方法上。
• <strong>位置</strong>: 方法级别。
• <strong>配合使用</strong>: 可以与@RequestBody、@PathVariable等注解一起使用。
• <strong>示例</strong>:</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@RestController
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">UserController </span><span>{
</span><span>  @PutMapping(</span><span style="color:#e6db74;">&quot;/users/{id}&quot;</span><span>)
</span><span>  </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="color:#a6e22e;">updateUser</span><span>(@PathVariable </span><span style="font-style:italic;color:#66d9ef;">Long </span><span style="font-style:italic;color:#fd971f;">id</span><span>, @RequestBody </span><span style="font-style:italic;color:#66d9ef;">User </span><span style="font-style:italic;color:#fd971f;">user</span><span>) {
</span><span>      </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;Updated user with id: &quot; </span><span style="color:#f92672;">+</span><span> id;
</span><span>  }
</span><span>}
</span></code></pre>
<h3 id=""></h3>
<hr />
<p>**<code>@PathVariable</code>**将 URL 路径中的变量绑定到方法参数。方法参数级别。路径变量名称与方法参数名称一致时，可省略 <code>value</code> 属性。</p>
<p><strong>主要属性</strong>• <code>value</code>：指定路径变量名称（默认为参数名称）。</p>
<p><strong>使用示例</strong></p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@RestController
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">UserController </span><span>{
</span><span>    @GetMapping(</span><span style="color:#e6db74;">&quot;/user/{id}&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">User </span><span style="color:#a6e22e;">getUser</span><span>(@PathVariable(</span><span style="color:#e6db74;">&quot;id&quot;</span><span>) </span><span style="font-style:italic;color:#66d9ef;">int </span><span style="font-style:italic;color:#fd971f;">userId</span><span>) {
</span><span>        </span><span style="color:#f92672;">return new </span><span style="font-style:italic;color:#66d9ef;">User</span><span>(userId, </span><span style="color:#e6db74;">&quot;John Doe&quot;</span><span>);
</span><span>    }
</span><span>}
</span></code></pre>
<hr />
<h4 id="yi-chang-chu-li">异常处理</h4>
<p>@ExceptionHandler</p>
<p>• <strong>作用</strong>: 用于处理控制器方法抛出的异常。
• <strong>位置</strong>: 方法级别。
• <strong>配合使用</strong>: 通常与@Controller、@RestController等注解一起使用。
• <strong>示例</strong>:</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Controller
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">UserController </span><span>{
</span><span>  @ExceptionHandler(</span><span style="font-style:italic;color:#66d9ef;">Exception</span><span>.class)
</span><span>  </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="color:#a6e22e;">handleException</span><span>(</span><span style="font-style:italic;color:#66d9ef;">Exception </span><span style="font-style:italic;color:#fd971f;">ex</span><span>) {
</span><span>      </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;Error: &quot; </span><span style="color:#f92672;">+</span><span> ex.getMessage();
</span><span>  }
</span><span>}
</span></code></pre>
<pre style="background-color:#272822;color:#f8f8f2;"><code><span>@RestController
</span><span>public class UserController {
</span><span>    @GetMapping(&quot;/user/{id}&quot;)
</span><span>    public User getUser(@PathVariable int id) {
</span><span>        if (id == 0) {
</span><span>            throw new IllegalArgumentException(&quot;Invalid user ID&quot;);
</span><span>        }
</span><span>        return new User(id, &quot;John Doe&quot;);
</span><span>    }
</span><span>
</span><span>    @ExceptionHandler(IllegalArgumentException.class)
</span><span>    @ResponseStatus(HttpStatus.BAD_REQUEST)
</span><span>    public Map&lt;String, String&gt; handleIllegalArgumentException(IllegalArgumentException ex) {
</span><span>        Map&lt;String, String&gt; error = new HashMap&lt;&gt;();
</span><span>        error.put(&quot;error&quot;, ex.getMessage());
</span><span>        return error;
</span><span>    }
</span><span>}
</span></code></pre>
<p>@ControllerAdvice</p>
<p>• <strong>作用</strong>: 用于全局处理控制器抛出的异常。 适用于全局异常处理，避免在每个控制器中重复定义异常处理方法。
• <strong>位置</strong>: 类级别。
• <strong>配合使用</strong>: 通常与@ExceptionHandler注解一起使用。
• <strong>示例</strong>:</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@ControllerAdvice
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">GlobalExceptionHandler </span><span>{
</span><span>  @ExceptionHandler(</span><span style="font-style:italic;color:#66d9ef;">Exception</span><span>.class)
</span><span>  </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="color:#a6e22e;">handleException</span><span>(</span><span style="font-style:italic;color:#66d9ef;">Exception </span><span style="font-style:italic;color:#fd971f;">ex</span><span>) {
</span><span>      </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;Global Error: &quot; </span><span style="color:#f92672;">+</span><span> ex.getMessage();
</span><span>  }
</span><span>}
</span></code></pre>
<pre style="background-color:#272822;color:#f8f8f2;"><code><span>@ControllerAdvice
</span><span>public class GlobalExceptionHandler {
</span><span>    @ExceptionHandler(Exception.class)
</span><span>    @ResponseStatus(HttpStatus.INTERNAL_SERVER_ERROR)
</span><span>    public Map&lt;String, String&gt; handleException(Exception ex) {
</span><span>        Map&lt;String, String&gt; error = new HashMap&lt;&gt;();
</span><span>        error.put(&quot;error&quot;, ex.getMessage());
</span><span>        return error;
</span><span>    }
</span><span>}
</span></code></pre>
<h4 id="kua-yu-qing-qiu">跨域请求</h4>
<p>@CrossOrigin</p>
<p>• <strong>作用</strong>: 用于允许跨域请求。
• <strong>位置</strong>: 类级别或方法级别。
• <strong>配合使用</strong>: 通常与@RestController、@Controller等注解一起使用。
• <strong>示例</strong>:</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@RestController
</span><span>@CrossOrigin(</span><span style="font-style:italic;color:#fd971f;">origins </span><span style="color:#f92672;">= </span><span style="color:#e6db74;">&quot;http://example.com&quot;</span><span>)
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">HelloController </span><span>{
</span><span>  @GetMapping(</span><span style="color:#e6db74;">&quot;/hello&quot;</span><span>)
</span><span>  </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="color:#a6e22e;">handle</span><span>() {
</span><span>      </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;Hello World!&quot;</span><span>;
</span><span>  }
</span><span>}
</span></code></pre>
<p>这些注解是Spring Web MVC框架中常用的核心注解，开发者可以根据具体需求灵活使用它们来构建Web应用程序。</p>
<h2 id="si-chu-li-qing-qiu-ying-she">四、处理请求映射</h2>
<p>在Spring MVC框架中，处理请求映射的核心模块主要由以下几个接口和类组成：</p>
<h4 id="1-chu-li-qing-qiu-ying-she-de-he-xin-mo-kuai">1. 处理请求映射的核心模块</h4>
<p><strong><code>HandlerMapping</code> 接口</strong></p>
<p>• <strong>作用</strong>: <code>HandlerMapping</code> 是Spring MVC中用于将请求映射到处理程序（Handler）的核心接口。它负责根据请求的URL、请求方法、请求头等信息，找到合适的处理程序（通常是Controller中的方法）。
• <strong>实现类</strong>: Spring MVC提供了多个<code>HandlerMapping</code>的实现类，如：
◦ <code>RequestMappingHandlerMapping</code>: 用于处理基于注解的请求映射（如<code>@RequestMapping</code>）。
◦ <code>BeanNameUrlHandlerMapping</code>: 根据Bean的名称进行URL映射。
◦ <code>SimpleUrlHandlerMapping</code>: 通过配置URL模式与处理程序的映射关系来处理请求。</p>
<p><strong><code>HandlerAdapter</code> 接口</strong></p>
<p>• <strong>作用</strong>: <code>HandlerAdapter</code> 是用于执行处理程序的接口。它负责调用处理程序的方法，并将方法返回的结果转换为<code>ModelAndView</code>对象。
• <strong>实现类</strong>: 常用的实现类有：
◦ <code>RequestMappingHandlerAdapter</code>: 用于处理基于注解的Controller方法。
◦ <code>SimpleControllerHandlerAdapter</code>: 用于处理实现了<code>Controller</code>接口的类。</p>
<p><strong><code>RequestMappingInfo</code> 类</strong></p>
<p>• <strong>作用</strong>: <code>RequestMappingInfo</code> 是一个封装了请求映射信息的类，包含了URL模式、请求方法、请求头、参数等条件。它通常由<code>RequestMappingHandlerMapping</code>使用，用于匹配请求。</p>
<p><strong><code>HandlerMethod</code> 类</strong></p>
<p>• <strong>作用</strong>: <code>HandlerMethod</code> 是Spring MVC中用于封装Controller方法的类。它包含了方法的所有元数据，如方法对象、参数类型、返回类型等。</p>
<h4 id="2-lu-jing-ying-she-chu-li-ji-zhi">2. 路径映射处理机制</h4>
<p>Spring MVC的路径映射处理机制主要通过<code>RequestMappingHandlerMapping</code>实现，具体步骤如下：</p>
<ol>
<li>
<p><strong>初始化阶段</strong>:
• 在应用启动时，Spring MVC会扫描所有带有<code>@Controller</code>或<code>@RestController</code>注解的类，并解析其中的<code>@RequestMapping</code>注解。
• 每个<code>@RequestMapping</code>注解会被转换为一个<code>RequestMappingInfo</code>对象，包含URL模式、请求方法、请求头、参数等条件。
• 这些<code>RequestMappingInfo</code>对象与对应的<code>HandlerMethod</code>会被注册到<code>RequestMappingHandlerMapping</code>中。</p>
</li>
<li>
<p><strong>请求匹配阶段</strong>:
• 当一个请求到达时，<code>DispatcherServlet</code>会调用<code>HandlerMapping</code>的<code>getHandler</code>方法。
• <code>RequestMappingHandlerMapping</code>会根据请求的URL、请求方法、请求头等信息，查找与之匹配的<code>RequestMappingInfo</code>。
• 如果找到匹配的<code>RequestMappingInfo</code>，则会返回对应的<code>HandlerMethod</code>。</p>
</li>
<li>
<p><strong>请求处理阶段</strong>:
• <code>DispatcherServlet</code>会调用<code>HandlerAdapter</code>的<code>handle</code>方法，将请求交给<code>HandlerMethod</code>处理。
• <code>RequestMappingHandlerAdapter</code>会调用<code>HandlerMethod</code>对应的方法，并将方法返回的结果转换为<code>ModelAndView</code>对象。</p>
</li>
</ol>
<p>以下是Spring MVC路径映射处理机制的流程图，展示了从请求到达服务器到最终调用Controller方法的完整过程：</p>
<pre style="background-color:#272822;color:#f8f8f2;"><code><span>+-------------------+
</span><span>|   HTTP Request    |
</span><span>+-------------------+
</span><span>          |
</span><span>          v
</span><span>+-------------------+
</span><span>| DispatcherServlet |
</span><span>+-------------------+
</span><span>          |
</span><span>          v
</span><span>+-------------------+       +-------------------+
</span><span>| HandlerMapping    | &lt;----&gt;| RequestMappingInfo|
</span><span>| (e.g., RequestMap |       | (URL, Method,     |
</span><span>| pingHandlerMapping)|       | Headers, Params)  |
</span><span>+-------------------+       +-------------------+
</span><span>          |
</span><span>          v
</span><span>+-------------------+
</span><span>| HandlerAdapter    | &lt;----&gt;| HandlerMethod     |
</span><span>| (e.g., RequestMap |       | (Controller Method|
</span><span>| pingHandlerAdapter)|       | with Metadata)    |
</span><span>+-------------------+
</span><span>          |
</span><span>          v
</span><span>+-------------------+
</span><span>| Controller Method |
</span><span>| (Business Logic)  |
</span><span>+-------------------+
</span><span>          |
</span><span>          v
</span><span>+-------------------+
</span><span>|  Return Result    |
</span><span>| (e.g., ModelAndView, |
</span><span>|  JSON, String)     |
</span><span>+-------------------+
</span><span>          |
</span><span>          v
</span><span>+-------------------+
</span><span>|  HTTP Response    |
</span><span>+-------------------+
</span></code></pre>
<p>详细步骤说明：</p>
<ol>
<li>
<p><strong>HTTP Request</strong>:
• 客户端发送HTTP请求到服务器。</p>
</li>
<li>
<p><strong>DispatcherServlet</strong>:
• <code>DispatcherServlet</code>是Spring MVC的核心组件，负责接收所有请求，并将其分发给合适的处理程序。</p>
</li>
<li>
<p><strong>HandlerMapping</strong>:
• <code>DispatcherServlet</code>调用<code>HandlerMapping</code>（如<code>RequestMappingHandlerMapping</code>）来查找与请求匹配的处理程序。
• <code>HandlerMapping</code>根据请求的URL、请求方法、请求头等信息，查找对应的<code>RequestMappingInfo</code>对象。</p>
</li>
<li>
<p><strong>RequestMappingInfo</strong>:
• <code>RequestMappingInfo</code>封装了请求的映射条件（如URL模式、请求方法、请求头、参数等）。
• 如果找到匹配的<code>RequestMappingInfo</code>，则返回对应的<code>HandlerMethod</code>。</p>
</li>
<li>
<p><strong>HandlerAdapter</strong>:
• <code>DispatcherServlet</code>调用<code>HandlerAdapter</code>（如<code>RequestMappingHandlerAdapter</code>）来执行处理程序。
• <code>HandlerAdapter</code>负责调用<code>HandlerMethod</code>对应的方法，并将方法返回的结果转换为<code>ModelAndView</code>对象或其他响应类型。</p>
</li>
<li>
<p><strong>HandlerMethod</strong>:
• <code>HandlerMethod</code>封装了Controller方法的元数据（如方法对象、参数类型、返回类型等）。
• <code>HandlerAdapter</code>调用<code>HandlerMethod</code>对应的方法，执行业务逻辑。</p>
</li>
<li>
<p><strong>Controller Method</strong>:
• Controller方法处理业务逻辑，并返回结果（如<code>ModelAndView</code>、JSON、字符串等）。</p>
</li>
<li>
<p><strong>Return Result</strong>:
• Controller方法返回的结果会被<code>HandlerAdapter</code>处理，并最终由<code>DispatcherServlet</code>转换为HTTP响应。</p>
</li>
<li>
<p><strong>HTTP Response</strong>:
• 服务器将HTTP响应返回给客户端。</p>
</li>
</ol>
<p>关键点：</p>
<p>• <strong>HandlerMapping</strong>负责将请求映射到处理程序。
• <strong>HandlerAdapter</strong>负责执行处理程序并处理结果。
• <strong>RequestMappingInfo</strong>和<strong>HandlerMethod</strong>是路径映射和处理的核心数据结构。</p>
<h4 id="3-urlying-she-lu-jing-ying-she-de-bu-tong-xing-shi">3. URL映射（路径映射）的不同形式</h4>
<p>在Spring MVC框架中，路径映射（URL映射）可以通过多种形式进行定义，支持灵活且强大的路径匹配规则。</p>
<p>Spring MVC的路径映射支持精确匹配、路径变量、通配符、正则表达式、多路径、查询参数等多种方式。通过结合HTTP请求方法、请求头、内容类型等条件，可以更精确地控制请求的匹配规则。</p>
<p>以下是Spring MVC中常见的路径形式：</p>
<h5 id="1-jing-que-lu-jing-pi-pei">1. <strong>精确路径匹配</strong></h5>
<p>• <strong>形式</strong>: 直接指定完整的路径。
• <strong>示例</strong>:</p>
<pre style="background-color:#272822;color:#f8f8f2;"><code><span> ```java
</span><span> @GetMapping(&quot;/user/info&quot;)
</span><span> public String getUserInfo() {
</span><span>     return &quot;user-info&quot;;
</span><span> }
</span><span> ````
</span></code></pre>
<p>• <strong>说明</strong>: 只有当请求的URL完全匹配<code>/user/info</code>时，才会调用该方法。</p>
<h5 id="2-tong-pei-fu-lu-jing">2. <strong>通配符路径</strong></h5>
<p>• <strong>形式</strong>: 使用<code>*</code>匹配单层路径，使用<code>**</code>匹配多层路径。
• <strong>示例</strong>:</p>
<pre style="background-color:#272822;color:#f8f8f2;"><code><span> ```java
</span><span> @GetMapping(&quot;/user/*/info&quot;)
</span><span> public String getUserInfoByWildcard() {
</span><span>     return &quot;user-info-wildcard&quot;;
</span><span> }
</span><span> ```
</span></code></pre>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span> @GetMapping(</span><span style="color:#e6db74;">&quot;/user/**&quot;</span><span>)
</span><span> </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span>getAllUserPaths() {
</span><span>     </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;all-user-paths&quot;</span><span>;
</span><span> } 
</span></code></pre>
<p>• <strong>说明</strong>:
◦ <code>/user/*/info</code>匹配<code>/user/123/info</code>，但不匹配<code>/user/123/456/info</code>。
◦ <code>/user/**</code>匹配<code>/user/123</code>、<code>/user/123/456</code>等多层路径。</p>
<h5 id="3-duo-lu-jing-ying-she">3. <strong>多路径映射</strong></h5>
<p>• <strong>形式</strong>: 在一个方法中映射多个路径。
• <strong>示例</strong>:</p>
<pre style="background-color:#272822;color:#f8f8f2;"><code><span> ```java
</span><span> @GetMapping({&quot;/user/info&quot;, &quot;/user/details&quot;})
</span><span> public String getUserInfoOrDetails() {
</span><span>     return &quot;user-info-or-details&quot;;
</span><span> }
</span><span> ```
</span></code></pre>
<p>• <strong>说明</strong>: 请求的URL可以是<code>/user/info</code>或<code>/user/details</code>，都会调用该方法。</p>
<hr />
<h5 id="4-lu-jing-qian-zhui">4. <strong>路径前缀</strong></h5>
<p>• <strong>形式</strong>: 在类级别使用<code>@RequestMapping</code>定义路径前缀，在方法级别定义具体路径。
• <strong>示例</strong>:</p>
<pre style="background-color:#272822;color:#f8f8f2;"><code><span> ```java
</span><span> @Controller
</span><span> @RequestMapping(&quot;/user&quot;)
</span><span> public class UserController {
</span><span>     @GetMapping(&quot;/info&quot;)
</span><span>     public String getUserInfo() {
</span><span>         return &quot;user-info&quot;;
</span><span>     }
</span><span> }
</span><span> ```
</span></code></pre>
<p>• <strong>说明</strong>: 请求的URL是<code>/user/info</code>。</p>
<h5 id="5-mo-ren-lu-jing">5. <strong>默认路径</strong></h5>
<p>• <strong>形式</strong>: 使用<code>/</code>或空字符串作为默认路径。
• <strong>示例</strong>:</p>
<pre style="background-color:#272822;color:#f8f8f2;"><code><span> ```java
</span><span> @GetMapping(&quot;/&quot;)
</span><span> public String getHomePage() {
</span><span>     return &quot;home&quot;;
</span><span> }
</span><span> ```
</span></code></pre>
<p>• <strong>说明</strong>: 请求的URL是根路径<code>/</code>。</p>
<h5 id="6-dai-qing-qiu-tou-xin-xi-de-lu-jing">6. <strong>带请求头信息的路径</strong></h5>
<p>• <strong>形式</strong>: 结合请求头信息定义路径。
• <strong>示例</strong>:</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@GetMapping(</span><span style="font-style:italic;color:#fd971f;">value </span><span style="color:#f92672;">= </span><span style="color:#e6db74;">&quot;/user&quot;</span><span>, </span><span style="font-style:italic;color:#fd971f;">headers </span><span style="color:#f92672;">= </span><span style="color:#e6db74;">&quot;X-Custom-Header=123&quot;</span><span>)
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span>getUserWithHeader() {
</span><span>    </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;user-with-header&quot;</span><span>;
</span><span>}
</span></code></pre>
<p>• <strong>说明</strong>: 只有请求头中包含<code>X-Custom-Header=123</code>时，才会调用该方法。</p>
<h5 id="7-dai-nei-rong-lei-xing-de-lu-jing">7. <strong>带内容类型的路径</strong></h5>
<p>• <strong>形式</strong>: 结合请求的内容类型（<code>Content-Type</code>）定义路径。
• <strong>示例</strong>:
<code>java @PostMapping(value = &quot;/user&quot;, consumes = &quot;application/json&quot;) public String createUserWithJson(@RequestBody User user) { return &quot;user-created-json&quot;; } </code>
• <strong>说明</strong>: 只有请求的内容类型为<code>application/json</code>时，才会调用该方法。</p>
<h5 id="8-dai-xiang-ying-lei-xing-de-lu-jing">8. <strong>带响应类型的路径</strong></h5>
<p>• <strong>形式</strong>: 结合响应的内容类型（<code>Accept</code>）定义路径。
• <strong>示例</strong>:
<code>java @GetMapping(value = &quot;/user&quot;, produces = &quot;application/json&quot;) public User getUserAsJson() { return new User(&quot;John&quot;, 30); } </code>
• <strong>说明</strong>: 只有客户端接受<code>application/json</code>时，才会调用该方法。</p>
<h5 id="9-lu-jing-zhong-bao-han-cha-xun-can-shu">9. <strong>路径中包含查询参数</strong></h5>
<p>• <strong>形式</strong>: 结合查询参数来定义路径。
• <strong>示例</strong>:</p>
<pre style="background-color:#272822;color:#f8f8f2;"><code><span> ```java
</span></code></pre>
<p>@GetMapping(&quot;/user&quot;)
public String getUserByName(@RequestParam String name) {
return &quot;user-name: &quot; + name;
}
```</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@GetMapping(</span><span style="color:#e6db74;">&quot;/example&quot;</span><span>)
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span>example(@RequestParam(</span><span style="color:#e6db74;">&quot;name&quot;</span><span>) </span><span style="font-style:italic;color:#66d9ef;">String</span><span> name) {
</span><span>    </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;Hello, &quot; </span><span style="color:#f92672;">+</span><span> name;
</span><span>}
</span></code></pre>
<p>• <strong>说明</strong>: 请求的URL可以是<code>/user?name=John</code>，<code>name</code>参数会被绑定到方法参数。</p>
<h5 id="10-lu-jing-bian-liang-path-variables">10. <strong>路径变量（Path Variables）</strong></h5>
<p>• <strong>形式</strong>: 使用<code>{变量名}</code>定义路径变量，并通过<code>@PathVariable</code>注解获取。
• <strong>示例</strong>:</p>
<pre style="background-color:#272822;color:#f8f8f2;"><code><span> ```java
</span></code></pre>
<p>@GetMapping(&quot;/user/{id}&quot;)
public String getUserById(@PathVariable Long id) {
return &quot;user-id: &quot; + id;
}
```</p>
<p>• <strong>说明</strong>: 请求的URL可以是<code>/user/123</code>，其中<code>123</code>会被绑定到<code>id</code>参数。</p>
<h5 id="11-zheng-ze-biao-da-shi-lu-jing">11. <strong>正则表达式路径</strong></h5>
<p>• <strong>形式</strong>: 在路径变量中使用正则表达式限制匹配规则。
• <strong>示例</strong>:</p>
<pre style="background-color:#272822;color:#f8f8f2;"><code><span> ```java
</span></code></pre>
<p>@GetMapping(&quot;/user/{id:\d+}&quot;)
public String getUserByIdWithRegex(@PathVariable String id) {
return &quot;user-id-regex: &quot; + id;
}
```</p>
<p>• <strong>说明</strong>: 只有<code>id</code>为数字时才会匹配，例如<code>/user/123</code>，<code>/user/abc</code>不会匹配。</p>
<hr />
<h4 id="4-restfulfeng-ge-de-lu-jing">4. RESTful风格的路径</h4>
<p>RESTful风格的路径是一种基于HTTP方法的URL设计规范，旨在通过URL和HTTP方法（如GET、POST、PUT、DELETE等）清晰地表达资源的操作。Spring MVC框架天然支持RESTful风格的路径设计。</p>
<p>RESTful风格的路径是通过资源、HTTP方法和路径变量的结合，构建出语义清晰、易于维护的API。</p>
<h5 id="restfullu-jing-de-dian-xing-she-ji"><strong>RESTful路径的典型设计</strong></h5>
<table><thead><tr><th><strong>操作类型</strong></th><th><strong>URL 格式</strong></th><th><strong>HTTP 方法</strong></th><th><strong>示例</strong></th><th><strong>说明</strong></th></tr></thead><tbody>
<tr><td><strong>获取资源</strong></td><td><code>/users</code></td><td><code>GET</code></td><td><code>GET /users</code></td><td>获取所有用户资源。</td></tr>
<tr><td></td><td><code>/users/{id}</code></td><td><code>GET</code></td><td><code>GET /users/1</code></td><td>获取 ID 为 1 的用户资源。</td></tr>
<tr><td><strong>创建资源</strong></td><td><code>/users</code></td><td><code>POST</code></td><td><code>POST /users</code></td><td>创建新用户，请求体包含用户数据。</td></tr>
<tr><td><strong>更新资源</strong></td><td><code>/users/{id}</code></td><td><code>PUT</code></td><td><code>PUT /users/1</code></td><td>更新 ID 为 1 的用户资源，请求体包含更新数据。</td></tr>
<tr><td><strong>删除资源</strong></td><td><code>/users/{id}</code></td><td><code>DELETE</code></td><td><code>DELETE /users/1</code></td><td>删除 ID 为 1 的用户资源。</td></tr>
<tr><td><strong>嵌套资源</strong></td><td><code>/users/{userId}/orders</code></td><td><code>GET</code></td><td><code>GET /users/1/orders</code></td><td>获取用户 ID 为 1 的所有订单。</td></tr>
<tr><td></td><td><code>/users/{userId}/orders/{orderId}</code></td><td><code>GET</code></td><td><code>GET /users/1/orders/100</code></td><td>获取用户 ID 为 1 的订单 ID 为 100 的订单。</td></tr>
</tbody></table>
<p>通过上表可以清晰地看到 RESTful 风格的路径设计规则，包括：</p>
<ul>
<li><strong>资源为核心</strong>：URL 表示资源（如 <code>/users</code>、<code>/orders</code>）。</li>
<li><strong>HTTP 方法表示操作</strong>：使用 <code>GET</code>、<code>POST</code>、<code>PUT</code>、<code>DELETE</code> 等 HTTP 方法表示对资源的操作。</li>
<li><strong>路径变量表示资源标识</strong>：使用 <code>{id}</code> 等路径变量表示特定资源。</li>
<li><strong>嵌套资源</strong>：通过 URL 层次化表示资源之间的关系（如 <code>/users/{userId}/orders</code>）。</li>
</ul>
<p>这种设计方式使得 RESTful API 更加语义化、清晰且易于维护。</p>
<hr />
<h5 id="restfulfeng-ge-lu-jing-de-she-ji-yuan-ze"><strong>RESTful风格路径的设计原则</strong></h5>
<ol>
<li><strong>资源为核心</strong>:
• URL表示资源，而不是操作。资源通常使用名词表示，例如<code>/users</code>、<code>/orders</code>。</li>
<li><strong>HTTP方法表示操作</strong>:
• 使用HTTP方法（GET、POST、PUT、DELETE等）表示对资源的操作。
◦ <code>GET</code>：获取资源。
◦ <code>POST</code>：创建资源。
◦ <code>PUT</code>：更新资源。
◦ <code>DELETE</code>：删除资源。</li>
<li><strong>路径变量表示资源标识</strong>:
• 使用路径变量（如<code>/users/{id}</code>）表示特定资源。</li>
<li><strong>URL层次化</strong>:
• 使用URL的层次结构表示资源之间的关系，例如<code>/users/{userId}/orders</code>表示某个用户的订单。</li>
</ol>
<p><strong>注意事项</strong></p>
<ol>
<li><strong>避免动词</strong>:
• URL中应避免使用动词（如<code>/getUsers</code>），而应使用名词表示资源。</li>
<li><strong>使用复数形式</strong>:
• 资源名称通常使用复数形式（如<code>/users</code>而不是<code>/user</code>）。</li>
<li><strong>版本控制</strong>:
• 如果API需要版本控制，可以在URL或请求头中引入版本号，例如<code>/v1/users</code>。</li>
<li><strong>状态码</strong>:
• 使用HTTP状态码（如200、201、404）表示操作结果，而不是在响应体中返回状态信息。</li>
</ol>
<hr />
<h5 id="spring-mvczhong-de-restfullu-jing-shi-xian"><strong>Spring MVC中的RESTful路径实现</strong></h5>
<p>在Spring MVC中，可以通过<code>@RequestMapping</code>及其衍生注解（如<code>@GetMapping</code>、<code>@PostMapping</code>、<code>@PutMapping</code>、<code>@DeleteMapping</code>）来实现RESTful风格的路径。</p>
<p>示例代码</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@RestController
</span><span>@RequestMapping(</span><span style="color:#e6db74;">&quot;/users&quot;</span><span>)
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">UserController </span><span>{
</span><span>
</span><span>    </span><span style="color:#75715e;">// 获取所有用户
</span><span>    @GetMapping
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">List</span><span>&lt;</span><span style="font-style:italic;color:#66d9ef;">User</span><span>&gt; </span><span style="color:#a6e22e;">getAllUsers</span><span>() {
</span><span>        </span><span style="color:#f92672;">return</span><span> userService.getAllUsers();
</span><span>    }
</span><span>
</span><span>    </span><span style="color:#75715e;">// 获取单个用户
</span><span>    @GetMapping(</span><span style="color:#e6db74;">&quot;/{id}&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">User </span><span style="color:#a6e22e;">getUserById</span><span>(@PathVariable </span><span style="font-style:italic;color:#66d9ef;">Long </span><span style="font-style:italic;color:#fd971f;">id</span><span>) {
</span><span>        </span><span style="color:#f92672;">return</span><span> userService.getUserById(id);
</span><span>    }
</span><span>
</span><span>    </span><span style="color:#75715e;">// 创建用户
</span><span>    @PostMapping
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">User </span><span style="color:#a6e22e;">createUser</span><span>(@RequestBody </span><span style="font-style:italic;color:#66d9ef;">User </span><span style="font-style:italic;color:#fd971f;">user</span><span>) {
</span><span>        </span><span style="color:#f92672;">return</span><span> userService.createUser(user);
</span><span>    }
</span><span>
</span><span>    </span><span style="color:#75715e;">// 更新用户
</span><span>    @PutMapping(</span><span style="color:#e6db74;">&quot;/{id}&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">User </span><span style="color:#a6e22e;">updateUser</span><span>(@PathVariable </span><span style="font-style:italic;color:#66d9ef;">Long </span><span style="font-style:italic;color:#fd971f;">id</span><span>, @RequestBody </span><span style="font-style:italic;color:#66d9ef;">User </span><span style="font-style:italic;color:#fd971f;">user</span><span>) {
</span><span>        </span><span style="color:#f92672;">return</span><span> userService.updateUser(id, user);
</span><span>    }
</span><span>
</span><span>    </span><span style="color:#75715e;">// 删除用户
</span><span>    @DeleteMapping(</span><span style="color:#e6db74;">&quot;/{id}&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">void </span><span style="color:#a6e22e;">deleteUser</span><span>(@PathVariable </span><span style="font-style:italic;color:#66d9ef;">Long </span><span style="font-style:italic;color:#fd971f;">id</span><span>) {
</span><span>        userService.deleteUser(id);
</span><span>    }
</span><span>}
</span></code></pre>
<hr />
<h5 id="restfullu-jing-de-you-dian"><strong>RESTful路径的优点</strong></h5>
<ol>
<li><strong>语义清晰</strong>:
• URL和HTTP方法结合，明确表达操作意图。</li>
<li><strong>易于扩展</strong>:
• 通过URL层次化，可以轻松扩展资源关系。</li>
<li><strong>标准化</strong>:
• 符合RESTful设计规范，易于理解和维护。</li>
<li><strong>与HTTP协议紧密结合</strong>:
• 充分利用HTTP方法的语义，简化设计。</li>
</ol>
<hr />
<h2 id="wu-fan-hui-xiang-ying-shu-ju">五、返回响应数据</h2>
<p>在Spring MVC框架中，<code>Model</code> 是一个核心概念，用于在控制器（Controller）和视图（View）之间传递数据。</p>
<h3 id="1-model-de-zuo-yong">1. <strong>Model 的作用</strong></h3>
<p><code>Model</code> 是一个接口，用于存储需要在视图中显示的数据。它的主要作用包括：
• <strong>传递数据</strong>：将控制器处理后的数据传递给视图。
• <strong>动态渲染</strong>：视图可以根据 <code>Model</code> 中的数据动态生成内容。
• <strong>解耦</strong>：控制器和视图之间通过 <code>Model</code> 进行数据交互，实现松耦合。</p>
<p>• <strong><code>Model</code> 是控制器和视图之间的桥梁</strong>，用于传递数据。
• <strong><code>Model</code> 是一个键值对容器</strong>，可以存储任意类型的数据。
• <strong><code>Model</code> 与视图技术（如 Thymeleaf、JSP）无缝集成</strong>，实现动态内容渲染。
• <strong><code>Model</code> 的使用简化了控制器和视图之间的数据交互</strong>，提高了代码的可维护性和可读性。</p>
<p>在Spring MVC中，<code>Model</code> 的默认实现是 <code>BindingAwareModelMap</code>，它是一个 <code>Map</code> 的实现类，用于存储键值对。在控制器方法中，Spring 会自动将 <code>Model</code> 对象注入到方法参数中。</p>
<h3 id="2-model-he-attribute-de-guan-xi">2. <strong>Model 和 Attribute 的关系</strong></h3>
<p><strong>Model</strong></p>
<p>• <code>Model</code> 是一个接口，用于在控制器（Controller）和视图（View）之间传递数据。
• 它是一个数据容器，可以存储多个键值对（即多个属性）。
• 在控制器方法中，<code>Model</code> 通常作为参数传入，用于添加需要在视图中显示的数据。</p>
<p><strong>Attribute</strong></p>
<p>• <code>Attribute</code> 是指存储在 <code>Model</code> 中的单个键值对。
• 每个 <code>Attribute</code> 包含一个名称（key）和一个值（value），值可以是任意类型的对象。
• <code>Attribute</code> 是 <code>Model</code> 的组成部分，<code>Model</code> 可以包含多个 <code>Attribute</code>。</p>
<p><strong>Model 和 Attribute 的异同</strong></p>
<table><thead><tr><th><strong>特性</strong></th><th><strong>Model</strong></th><th><strong>Attribute</strong></th></tr></thead><tbody>
<tr><td><strong>定义</strong></td><td>一个数据容器，用于存储多个键值对。</td><td>单个键值对，是 <code>Model</code> 的组成部分。</td></tr>
<tr><td><strong>作用</strong></td><td>在控制器和视图之间传递数据。</td><td>表示 <code>Model</code> 中的一个具体数据项。</td></tr>
<tr><td><strong>作用域</strong></td><td>当前请求。</td><td>作用域与 <code>Model</code> 一致，为当前请求。</td></tr>
<tr><td><strong>生命周期</strong></td><td>与当前请求绑定，请求结束后销毁。</td><td>与 <code>Model</code> 的生命周期一致。</td></tr>
</tbody></table>
<p>• <code>Model</code> 是一个容器，<code>Attribute</code> 是容器中的内容。
• 一个 <code>Model</code> 可以包含多个 <code>Attribute</code>，每个 <code>Attribute</code> 是一个键值对。
• <code>Model</code> 的作用是管理 <code>Attribute</code>，并将它们传递给视图。</p>
<h3 id="3-model-de-he-xin-fang-fa">3. <strong>Model 的核心方法</strong></h3>
<p><code>Model</code> 接口提供了以下常用方法：
• <strong><code>addAttribute(String name, Object value)</code></strong>：向 <code>Model</code> 中添加一个属性，属性名称为 <code>name</code>，属性值为 <code>value</code>。
• <strong><code>addAttribute(Object value)</code></strong>：向 <code>Model</code> 中添加一个属性，属性名称由对象的类名决定（首字母小写）。
• <strong><code>addAllAttributes(Map&lt;String, ?&gt; attributes)</code></strong>：将 <code>Map</code> 中的所有键值对添加到 <code>Model</code> 中。
• <strong><code>mergeAttributes(Map&lt;String, ?&gt; attributes)</code></strong>：将 <code>Map</code> 中的键值对合并到 <code>Model</code> 中，如果 <code>Model</code> 中已存在相同的键，则保留 <code>Model</code> 中的值。
• <strong><code>containsAttribute(String name)</code></strong>：检查 <code>Model</code> 中是否包含指定名称的属性。</p>
<h3 id="4-model-de-shi-yong-shi-li">4. <strong>Model 的使用示例</strong></h3>
<p>示例 1: 使用 <code>Model</code> 传递数据</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Controller
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">HomeController </span><span>{
</span><span>
</span><span>    @GetMapping(</span><span style="color:#e6db74;">&quot;/home&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="color:#a6e22e;">home</span><span>(</span><span style="font-style:italic;color:#66d9ef;">Model </span><span style="font-style:italic;color:#fd971f;">model</span><span>) {
</span><span>        </span><span style="color:#75715e;">// 向 Model 中添加 Attribute
</span><span>        model.addAttribute(</span><span style="color:#e6db74;">&quot;message&quot;</span><span>, </span><span style="color:#e6db74;">&quot;Welcome to the Home Page!&quot;</span><span>); </span><span style="color:#75715e;">//传递简单数据
</span><span>        model.addAttribute(</span><span style="color:#e6db74;">&quot;user&quot;</span><span>, </span><span style="color:#f92672;">new </span><span style="font-style:italic;color:#66d9ef;">User</span><span>(</span><span style="color:#e6db74;">&quot;John&quot;</span><span>, </span><span style="color:#ae81ff;">30</span><span>));	</span><span style="color:#75715e;">// 传递对象
</span><span>        </span><span style="font-style:italic;color:#66d9ef;">List</span><span>&lt;</span><span style="font-style:italic;color:#66d9ef;">Product</span><span>&gt; products </span><span style="color:#f92672;">= </span><span style="font-style:italic;color:#66d9ef;">Arrays</span><span>.asList(
</span><span>            </span><span style="color:#f92672;">new </span><span style="font-style:italic;color:#66d9ef;">Product</span><span>(</span><span style="color:#e6db74;">&quot;Laptop&quot;</span><span>, </span><span style="color:#ae81ff;">1000</span><span>),
</span><span>            </span><span style="color:#f92672;">new </span><span style="font-style:italic;color:#66d9ef;">Product</span><span>(</span><span style="color:#e6db74;">&quot;Phone&quot;</span><span>, </span><span style="color:#ae81ff;">500</span><span>)
</span><span>        );
</span><span>        model.addAttribute(</span><span style="color:#e6db74;">&quot;products&quot;</span><span>, products);	</span><span style="color:#75715e;">// 传递集合
</span><span>
</span><span>        </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;home&quot;</span><span>; </span><span style="color:#75715e;">// 返回视图名称
</span><span>    }
</span><span>}
</span></code></pre>
<p>• <strong>说明</strong>:
• <code>Model</code> 是一个容器，存储了三个 <code>Attribute</code>：<code>message</code> 、 <code>user</code>和<code>products</code>。
• 这些 <code>Attribute</code> 的作用域为当前请求。</p>
<p>示例 2: 在视图中访问Model中的 <code>Attribute</code></p>
<pre data-lang="html" style="background-color:#272822;color:#f8f8f2;" class="language-html "><code class="language-html" data-lang="html"><span>&lt;!</span><span style="color:#f92672;">DOCTYPE </span><span style="color:#ae81ff;">html</span><span>&gt;
</span><span>&lt;</span><span style="color:#f92672;">html </span><span style="color:#a6e22e;">xmlns:th</span><span>=</span><span style="color:#e6db74;">&quot;http://www.thymeleaf.org&quot;</span><span>&gt;
</span><span>&lt;</span><span style="color:#f92672;">head</span><span>&gt;
</span><span>    &lt;</span><span style="color:#f92672;">title</span><span>&gt;Home Page&lt;/</span><span style="color:#f92672;">title</span><span>&gt;
</span><span>&lt;/</span><span style="color:#f92672;">head</span><span>&gt;
</span><span>&lt;</span><span style="color:#f92672;">body</span><span>&gt;
</span><span>    &lt;</span><span style="color:#f92672;">h1 </span><span style="color:#a6e22e;">th:text</span><span>=</span><span style="color:#e6db74;">&quot;${message}&quot;</span><span>&gt;Default Message&lt;/</span><span style="color:#f92672;">h1</span><span>&gt;
</span><span>    &lt;</span><span style="color:#f92672;">p</span><span>&gt;User: &lt;</span><span style="color:#f92672;">span </span><span style="color:#a6e22e;">th:text</span><span>=</span><span style="color:#e6db74;">&quot;${user.name}&quot;</span><span>&gt;Guest&lt;/</span><span style="color:#f92672;">span</span><span>&gt;, Age: &lt;</span><span style="color:#f92672;">span </span><span style="color:#a6e22e;">th:text</span><span>=</span><span style="color:#e6db74;">&quot;${user.age}&quot;</span><span>&gt;0&lt;/</span><span style="color:#f92672;">span</span><span>&gt;&lt;/</span><span style="color:#f92672;">p</span><span>&gt;
</span><span>    &lt;</span><span style="color:#f92672;">p</span><span>&gt;Products: &lt;</span><span style="color:#f92672;">span </span><span style="color:#a6e22e;">th:text</span><span>=</span><span style="color:#e6db74;">&quot;${products[&#39;Laptop&#39;]}&quot;</span><span>&gt;Product&lt;/</span><span style="color:#f92672;">span</span><span>&gt;,
</span><span>        &lt;</span><span style="color:#f92672;">span </span><span style="color:#a6e22e;">th:text</span><span>=</span><span style="color:#e6db74;">&quot;${products.Phone}&quot;</span><span>&gt;Product&lt;/</span><span style="color:#f92672;">span</span><span>&gt;&lt;/</span><span style="color:#f92672;">p</span><span>&gt;
</span><span>&lt;/</span><span style="color:#f92672;">body</span><span>&gt;
</span><span>&lt;/</span><span style="color:#f92672;">html</span><span>&gt;
</span></code></pre>
<p>• <strong>说明</strong>:
• 视图通过 <code>${message}</code> 、 <code>${user.name}</code> 、 <code>${products['Laptop']}</code> 访问 <code>Model</code> 中的 <code>Attribute</code>。</p>
<h3 id="5-zuo-yong-yu-fan-wei">5. <strong>作用域范围</strong></h3>
<p>• <code>Model</code> 的作用域是<strong>当前请求</strong>，即它的生命周期与一次HTTP请求绑定。
• 当请求处理完成后，<code>Model</code> 中的数据会被销毁，不会在多个请求之间共享。
• 如果需要跨请求共享数据，可以使用 <code>@SessionAttributes</code> 或 <code>@SessionAttribute</code>。</p>
<p>除了 <code>Model</code>，Spring MVC 还支持其他作用域的数据传递方式：
• <strong><code>@SessionAttributes</code></strong>：将 <code>Model</code> 中的数据存储到会话（Session）中，作用域为多个请求。
• <strong><code>@RequestAttribute</code></strong>：从请求中获取属性，作用域为当前请求。
• <strong><code>@SessionAttribute</code></strong>：从会话中获取属性，作用域为多个请求。</p>
<p>示例: 使用 <code>@SessionAttributes</code></p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Controller
</span><span>@SessionAttributes(</span><span style="color:#e6db74;">&quot;user&quot;</span><span>) </span><span style="color:#75715e;">// 将 &quot;user&quot; 存储到 Session 中
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">UserController </span><span>{
</span><span>
</span><span>    @GetMapping(</span><span style="color:#e6db74;">&quot;/user&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="color:#a6e22e;">getUser</span><span>(</span><span style="font-style:italic;color:#66d9ef;">Model </span><span style="font-style:italic;color:#fd971f;">model</span><span>) {
</span><span>        model.addAttribute(</span><span style="color:#e6db74;">&quot;user&quot;</span><span>, </span><span style="color:#f92672;">new </span><span style="font-style:italic;color:#66d9ef;">User</span><span>(</span><span style="color:#e6db74;">&quot;John&quot;</span><span>, </span><span style="color:#ae81ff;">30</span><span>)); </span><span style="color:#75715e;">// 添加到 Model 和 Session
</span><span>        </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;user&quot;</span><span>;
</span><span>    }
</span><span>}
</span></code></pre>
<p>• <strong>说明</strong>:
• <code>user</code> 属性不仅存储在 <code>Model</code> 中，还会存储在会话（Session）中，作用域为多个请求。</p>
<h3 id="6-modelattribute">6. <strong>@ModelAttribute</strong></h3>
<p>• <strong><code>@ModelAttribute</code></strong>：用于将方法返回值或请求参数绑定到 <code>Model</code> 中。</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Controller
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">UserController </span><span>{
</span><span>
</span><span>    @ModelAttribute(</span><span style="color:#e6db74;">&quot;user&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">User </span><span style="color:#a6e22e;">getUser</span><span>() {
</span><span>        </span><span style="color:#f92672;">return new </span><span style="font-style:italic;color:#66d9ef;">User</span><span>(</span><span style="color:#e6db74;">&quot;Guest&quot;</span><span>, </span><span style="color:#ae81ff;">0</span><span>);
</span><span>    }
</span><span>
</span><span>    @GetMapping(</span><span style="color:#e6db74;">&quot;/user&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="color:#a6e22e;">showUser</span><span>() {
</span><span>        </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;user&quot;</span><span>; </span><span style="color:#75715e;">// 返回视图名称
</span><span>    }
</span><span>}
</span></code></pre>
<p>• <strong>说明</strong>: <code>@ModelAttribute</code> 方法会在每个请求处理之前执行，并将返回值添加到 <code>Model</code> 中。</p>
<h3 id="7-model-yu-modelandview">7. **Model 与 ModelAndView **</h3>
<p>• <strong><code>Model</code></strong>：只是一个数据容器，用于存储需要在视图中显示的数据。
• <strong><code>ModelAndView</code></strong>：包含 <code>Model</code> 和视图名称（或视图对象），可以同时返回数据和视图。</p>
<p>示例：使用 <code>ModelAndView</code></p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Controller
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">HomeController </span><span>{
</span><span>
</span><span>    @GetMapping(</span><span style="color:#e6db74;">&quot;/home&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">ModelAndView </span><span style="color:#a6e22e;">home</span><span>() {
</span><span>        </span><span style="font-style:italic;color:#66d9ef;">ModelAndView</span><span> modelAndView </span><span style="color:#f92672;">= new </span><span style="font-style:italic;color:#66d9ef;">ModelAndView</span><span>(</span><span style="color:#e6db74;">&quot;home&quot;</span><span>); </span><span style="color:#75715e;">// 设置视图名称
</span><span>        modelAndView.addObject(</span><span style="color:#e6db74;">&quot;message&quot;</span><span>, </span><span style="color:#e6db74;">&quot;Welcome to the Home Page!&quot;</span><span>); </span><span style="color:#75715e;">// 添加数据
</span><span>        </span><span style="color:#f92672;">return</span><span> modelAndView;
</span><span>    }
</span><span>}
</span></code></pre>
<hr />
<h2 id="liu-shu-ju-bang-ding-yu-yan-zheng"><em>六、数据绑定与验证</em></h2>
<p>• <strong>数据绑定</strong>: Spring MVC自动将请求参数绑定到Java对象（如表单数据绑定到POJO）。
• <strong>验证</strong>: 支持JSR-303/JSR-380 Bean Validation，可以通过注解对模型数据进行验证。</p>
<p>在Spring MVC中，<strong>数据绑定</strong>和<strong>验证</strong>是两个非常重要的功能，它们帮助开发者处理用户输入的数据，并确保数据的有效性和一致性。以下是关于数据绑定和验证的详细说明：</p>
<hr />
<h3 id="1-shu-ju-bang-ding-data-binding"><em><strong>1 数据绑定（Data Binding）</strong></em></h3>
<p>数据绑定是指将HTTP请求中的参数（如表单数据、URL参数、JSON等）自动绑定到Java对象（如POJO、DTO等）的过程。Spring MVC提供了强大的数据绑定机制，简化了开发者处理用户输入的工作。</p>
<h4 id="1-1-shu-ju-bang-ding-de-shi-xian"><strong><strong>1.1 数据绑定的实现</strong></strong></h4>
<p>• <strong>自动绑定</strong>：Spring MVC会自动将请求参数绑定到Controller方法的参数或模型对象中。
• 例如，表单中的<code>&lt;input name=&quot;username&quot;&gt;</code>会自动绑定到Java对象的<code>username</code>属性。
• <strong>绑定注解</strong>：
• <code>@RequestParam</code>：绑定单个请求参数到方法参数。
<code>java public String getUser(@RequestParam(&quot;id&quot;) Long userId) { // ... } </code>
• <code>@PathVariable</code>：绑定URL路径中的变量到方法参数。
<code>java public String getUser(@PathVariable(&quot;id&quot;) Long userId) { // ... } </code>
• <code>@ModelAttribute</code>：绑定表单数据到模型对象。
<code>java public String saveUser(@ModelAttribute User user) { // ... } </code>
• <code>@RequestBody</code>：绑定请求体（如JSON）到Java对象。
<code>java public String saveUser(@RequestBody User user) { // ... } </code></p>
<h4 id="1-2-shu-ju-bang-ding-de-liu-cheng"><strong><strong>1.2 数据绑定的流程</strong></strong></h4>
<ol>
<li><strong>接收请求</strong>：DispatcherServlet接收HTTP请求。</li>
<li><strong>参数解析</strong>：Spring MVC根据请求参数的类型和名称，调用适当的<code>DataBinder</code>进行绑定。</li>
<li><strong>类型转换</strong>：如果请求参数的类型与目标类型不匹配，Spring会尝试进行类型转换（如将字符串转换为整数）。</li>
<li><strong>绑定到对象</strong>：将解析后的参数绑定到目标对象（如POJO、DTO等）。</li>
</ol>
<h4 id="1-3-zi-ding-yi-shu-ju-bang-ding"><strong><strong>1.3 自定义数据绑定</strong></strong></h4>
<p>• <strong>自定义类型转换器</strong>：通过实现<code>Converter</code>或<code>Formatter</code>接口，可以自定义类型转换逻辑。</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">StringToDateConverter </span><span style="color:#f92672;">implements </span><span style="text-decoration:underline;font-style:italic;color:#a6e22e;">Converter</span><span>&lt;</span><span style="font-style:italic;color:#66d9ef;">String</span><span>, </span><span style="font-style:italic;color:#66d9ef;">Date</span><span>&gt; {
</span><span>  @Override
</span><span>  </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">Date </span><span style="color:#a6e22e;">convert</span><span>(</span><span style="font-style:italic;color:#66d9ef;">String </span><span style="font-style:italic;color:#fd971f;">source</span><span>) {
</span><span>      </span><span style="color:#75715e;">// 自定义转换逻辑
</span><span>  }
</span><span>}
</span></code></pre>
<p>• <strong>注册自定义转换器</strong>：在配置类中注册自定义转换器。</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Configuration
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">WebConfig </span><span style="color:#f92672;">implements </span><span style="text-decoration:underline;font-style:italic;color:#a6e22e;">WebMvcConfigurer </span><span>{
</span><span>  @Override
</span><span>  </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">void </span><span style="color:#a6e22e;">addFormatters</span><span>(</span><span style="font-style:italic;color:#66d9ef;">FormatterRegistry </span><span style="font-style:italic;color:#fd971f;">registry</span><span>) {
</span><span>      registry.addConverter(</span><span style="color:#f92672;">new </span><span style="font-style:italic;color:#66d9ef;">StringToDateConverter</span><span>());
</span><span>  }
</span><span>}
</span></code></pre>
<hr />
<h3 id="2-yan-zheng-validation"><em><strong>2. 验证（Validation）</strong></em></h3>
<p>验证是确保用户输入的数据符合业务规则的过程。Spring MVC支持JSR-303/JSR-380 Bean Validation标准，可以通过注解对模型数据进行验证。</p>
<h4 id="2-1-yan-zheng-de-shi-xian"><strong><strong>2.1 验证的实现</strong></strong></h4>
<p>• <strong>验证注解</strong>：在模型对象的属性上添加验证注解。</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">User </span><span>{
</span><span>    @NotNull
</span><span>    </span><span style="color:#f92672;">private </span><span style="font-style:italic;color:#66d9ef;">String </span><span>username;
</span><span>
</span><span>    @Size(</span><span style="font-style:italic;color:#fd971f;">min </span><span style="color:#f92672;">= </span><span style="color:#ae81ff;">6</span><span>, </span><span style="font-style:italic;color:#fd971f;">max </span><span style="color:#f92672;">= </span><span style="color:#ae81ff;">20</span><span>)
</span><span>    </span><span style="color:#f92672;">private </span><span style="font-style:italic;color:#66d9ef;">String </span><span>password;
</span><span>
</span><span>    @Email
</span><span>    </span><span style="color:#f92672;">private </span><span style="font-style:italic;color:#66d9ef;">String </span><span>email;
</span><span>}
</span></code></pre>
<p>常用注解包括：
• <code>@NotNull</code>：字段不能为null。
• <code>@NotEmpty</code>：字段不能为空（适用于字符串、集合等）。
• <code>@Size</code>：字段的长度或大小必须在指定范围内。
• <code>@Min</code>、<code>@Max</code>：字段的数值必须在指定范围内。
• <code>@Pattern</code>：字段必须匹配指定的正则表达式。
• <code>@Email</code>：字段必须是有效的电子邮件地址。</p>
<p>• <strong>触发验证</strong>：在Controller方法中使用<code>@Valid</code>或<code>@Validated</code>注解触发验证。</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span>saveUser(@</span><span style="font-style:italic;color:#66d9ef;">Valid</span><span> @</span><span style="font-style:italic;color:#66d9ef;">ModelAttribute User</span><span> user, </span><span style="font-style:italic;color:#66d9ef;">BindingResult</span><span> result) {
</span><span>  </span><span style="color:#f92672;">if </span><span>(result.hasErrors()) {
</span><span>      </span><span style="color:#75715e;">// 处理验证错误
</span><span>  }
</span><span>  </span><span style="color:#75715e;">// 保存用户
</span><span>}
</span></code></pre>
<h4 id="2-2-yan-zheng-jie-guo-chu-li"><strong><strong>2.2 验证结果处理</strong></strong></h4>
<p>• <strong>BindingResult</strong>：验证结果会存储在<code>BindingResult</code>对象中，开发者可以通过它获取错误信息。</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#f92672;">if </span><span>(result.hasErrors()) {
</span><span>  </span><span style="font-style:italic;color:#66d9ef;">List</span><span>&lt;</span><span style="font-style:italic;color:#66d9ef;">FieldError</span><span>&gt; errors </span><span style="color:#f92672;">=</span><span> result.getFieldErrors();
</span><span>  </span><span style="color:#f92672;">for </span><span>(</span><span style="font-style:italic;color:#66d9ef;">FieldError</span><span> error </span><span style="color:#f92672;">:</span><span> errors) {
</span><span>      </span><span style="font-style:italic;color:#66d9ef;">System</span><span>.out.println(error.getField() </span><span style="color:#f92672;">+ </span><span style="color:#e6db74;">&quot;: &quot; </span><span style="color:#f92672;">+</span><span> error.getDefaultMessage());
</span><span>  }
</span><span>}
</span></code></pre>
<h4 id="2-3-zi-ding-yi-yan-zheng"><strong><strong>2.3 自定义验证</strong></strong></h4>
<p>• <strong>自定义验证注解</strong>：通过实现<code>ConstraintValidator</code>接口，可以创建自定义验证注解。</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Target({ </span><span style="font-style:italic;color:#66d9ef;">ElementType</span><span>.</span><span style="color:#ae81ff;">FIELD </span><span>})
</span><span>@Retention(</span><span style="font-style:italic;color:#66d9ef;">RetentionPolicy</span><span>.</span><span style="color:#ae81ff;">RUNTIME</span><span>)
</span><span>@Constraint(</span><span style="font-style:italic;color:#fd971f;">validatedBy </span><span style="color:#f92672;">= </span><span style="font-style:italic;color:#66d9ef;">CustomValidator</span><span>.class)
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">@interface </span><span style="text-decoration:underline;color:#a6e22e;">CustomValidation </span><span>{
</span><span>    </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="color:#a6e22e;">message</span><span>() </span><span style="color:#f92672;">default </span><span style="color:#e6db74;">&quot;Invalid value&quot;</span><span>;
</span><span>    </span><span style="font-style:italic;color:#66d9ef;">Class</span><span>&lt;</span><span style="color:#f92672;">?</span><span>&gt;</span><span style="color:#f92672;">[] </span><span style="color:#a6e22e;">groups</span><span>() </span><span style="color:#f92672;">default </span><span>{};
</span><span>    </span><span style="font-style:italic;color:#66d9ef;">Class</span><span>&lt;</span><span style="color:#f92672;">? extends </span><span style="font-style:italic;color:#66d9ef;">Payload</span><span>&gt;</span><span style="color:#f92672;">[] </span><span style="color:#a6e22e;">payload</span><span>() </span><span style="color:#f92672;">default </span><span>{};
</span><span>}
</span><span>
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">CustomValidator </span><span style="color:#f92672;">implements </span><span style="text-decoration:underline;font-style:italic;color:#a6e22e;">ConstraintValidator</span><span>&lt;</span><span style="font-style:italic;color:#66d9ef;">CustomValidation</span><span>, </span><span style="font-style:italic;color:#66d9ef;">String</span><span>&gt; {
</span><span>    @Override
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">boolean </span><span style="color:#a6e22e;">isValid</span><span>(</span><span style="font-style:italic;color:#66d9ef;">String </span><span style="font-style:italic;color:#fd971f;">value</span><span>, </span><span style="font-style:italic;color:#66d9ef;">ConstraintValidatorContext </span><span style="font-style:italic;color:#fd971f;">context</span><span>) {
</span><span>        </span><span style="color:#75715e;">// 自定义验证逻辑
</span><span>        </span><span style="color:#f92672;">return</span><span> value </span><span style="color:#f92672;">!= </span><span style="color:#ae81ff;">null </span><span style="color:#f92672;">&amp;&amp;</span><span> value.startsWith(</span><span style="color:#e6db74;">&quot;custom&quot;</span><span>);
</span><span>    }
</span><span>}
</span></code></pre>
<p>• <strong>使用自定义注解</strong>：在模型对象中使用自定义注解。</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">User </span><span>{
</span><span>  @CustomValidation
</span><span>  </span><span style="color:#f92672;">private </span><span style="font-style:italic;color:#66d9ef;">String </span><span>customField;
</span><span>}
</span></code></pre>
<h4 id="2-4-fen-zu-yan-zheng"><strong><strong>2.4 分组验证</strong></strong></h4>
<p>• <strong>分组验证</strong>：通过定义验证组，可以在不同场景下应用不同的验证规则。</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">interface </span><span style="text-decoration:underline;color:#a6e22e;">GroupA </span><span>{}
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">interface </span><span style="text-decoration:underline;color:#a6e22e;">GroupB </span><span>{}
</span><span>
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">User </span><span>{
</span><span>    @NotNull(</span><span style="font-style:italic;color:#fd971f;">groups </span><span style="color:#f92672;">= </span><span style="font-style:italic;color:#66d9ef;">GroupA</span><span>.class)
</span><span>    </span><span style="color:#f92672;">private </span><span style="font-style:italic;color:#66d9ef;">String </span><span>username;
</span><span>
</span><span>    @Size(</span><span style="font-style:italic;color:#fd971f;">min </span><span style="color:#f92672;">= </span><span style="color:#ae81ff;">6</span><span>, </span><span style="font-style:italic;color:#fd971f;">max </span><span style="color:#f92672;">= </span><span style="color:#ae81ff;">20</span><span>, </span><span style="font-style:italic;color:#fd971f;">groups </span><span style="color:#f92672;">= </span><span style="font-style:italic;color:#66d9ef;">GroupB</span><span>.class)
</span><span>    </span><span style="color:#f92672;">private </span><span style="font-style:italic;color:#66d9ef;">String </span><span>password;
</span><span>}
</span></code></pre>
<p>• <strong>触发分组验证</strong>：在Controller方法中指定验证组。</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span>saveUser(@Validated(</span><span style="font-style:italic;color:#66d9ef;">GroupA</span><span>.class) @</span><span style="font-style:italic;color:#66d9ef;">ModelAttribute User</span><span> user, </span><span style="font-style:italic;color:#66d9ef;">BindingResult</span><span> result) {
</span><span>  </span><span style="color:#75715e;">// ...
</span><span>}
</span></code></pre>
<hr />
<h3 id="3-shu-ju-bang-ding-yu-yan-zheng-de-jie-he"><em><strong>3. 数据绑定与验证的结合</strong></em></h3>
<p>在Spring MVC中，数据绑定和验证通常是结合使用的：</p>
<ol>
<li><strong>绑定数据</strong>：将请求参数绑定到模型对象。</li>
<li><strong>验证数据</strong>：对绑定后的模型对象进行验证。</li>
<li><strong>处理结果</strong>：根据验证结果决定后续操作（如返回错误信息或保存数据）。</li>
</ol>
<p>示例：</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span>saveUser(@</span><span style="font-style:italic;color:#66d9ef;">Valid</span><span> @</span><span style="font-style:italic;color:#66d9ef;">ModelAttribute User</span><span> user, </span><span style="font-style:italic;color:#66d9ef;">BindingResult</span><span> result) {
</span><span>    </span><span style="color:#f92672;">if </span><span>(result.hasErrors()) {
</span><span>        </span><span style="color:#75715e;">// 返回错误信息
</span><span>        </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;errorPage&quot;</span><span>;
</span><span>    }
</span><span>    </span><span style="color:#75715e;">// 保存用户
</span><span>    userService.save(user);
</span><span>    </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;successPage&quot;</span><span>;
</span><span>}
</span></code></pre>
<hr />
<hr />
<h3 id="4-zi-ding-yi-lei-xing-zhuan-huan-de-gua-yong-chang-jing"><strong>4. 自定义类型转换的适用场景</strong></h3>
<p>自定义类型转换器在Spring MVC中用于处理默认类型转换器无法满足需求的场景。以下是一些常见的需要使用自定义类型转换器的场景：</p>
<h4 id="4-1-fu-za-lei-xing-zhuan-huan">4.1 <strong>复杂类型转换</strong></h4>
<p>当需要将请求参数转换为复杂类型（如自定义对象、枚举、日期格式等）时，默认的类型转换器可能无法满足需求。</p>
<p><strong>示例场景：</strong></p>
<p>• 将字符串转换为自定义的<code>Date</code>格式：</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">StringToDateConverter </span><span style="color:#f92672;">implements </span><span style="text-decoration:underline;font-style:italic;color:#a6e22e;">Converter</span><span>&lt;</span><span style="font-style:italic;color:#66d9ef;">String</span><span>, </span><span style="font-style:italic;color:#66d9ef;">Date</span><span>&gt; {
</span><span>    </span><span style="color:#f92672;">private static final </span><span style="font-style:italic;color:#66d9ef;">SimpleDateFormat </span><span>DATE_FORMAT </span><span style="color:#f92672;">= new </span><span style="font-style:italic;color:#66d9ef;">SimpleDateFormat</span><span>(</span><span style="color:#e6db74;">&quot;yyyy-MM-dd&quot;</span><span>);
</span><span>
</span><span>    @Override
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">Date </span><span style="color:#a6e22e;">convert</span><span>(</span><span style="font-style:italic;color:#66d9ef;">String </span><span style="font-style:italic;color:#fd971f;">source</span><span>) {
</span><span>        </span><span style="color:#f92672;">try </span><span>{
</span><span>            </span><span style="color:#f92672;">return </span><span style="color:#ae81ff;">DATE_FORMAT</span><span>.parse(source);
</span><span>        } </span><span style="color:#f92672;">catch </span><span>(</span><span style="font-style:italic;color:#66d9ef;">ParseException </span><span style="font-style:italic;color:#fd971f;">e</span><span>) {
</span><span>            </span><span style="color:#f92672;">throw new </span><span style="font-style:italic;color:#66d9ef;">IllegalArgumentException</span><span>(</span><span style="color:#e6db74;">&quot;Invalid date format. Expected format: yyyy-MM-dd&quot;</span><span>);
</span><span>        }
</span><span>    }
</span><span>}
</span></code></pre>
<hr />
<h4 id="4-2-zi-ding-yi-ge-shi-de-qing-qiu-can-shu"><strong>4.2 自定义格式的请求参数</strong></h4>
<p>当请求参数的格式与默认格式不一致时，需要自定义转换逻辑。</p>
<p><strong>示例场景：</strong></p>
<p>• 将逗号分隔的字符串转换为列表：</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">StringToListConverter </span><span style="color:#f92672;">implements </span><span style="text-decoration:underline;font-style:italic;color:#a6e22e;">Converter</span><span>&lt;</span><span style="font-style:italic;color:#66d9ef;">String</span><span>, </span><span style="font-style:italic;color:#66d9ef;">List</span><span>&lt;</span><span style="font-style:italic;color:#66d9ef;">String</span><span>&gt;&gt; {
</span><span>  @Override
</span><span>  </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">List</span><span>&lt;</span><span style="font-style:italic;color:#66d9ef;">String</span><span>&gt; </span><span style="color:#a6e22e;">convert</span><span>(</span><span style="font-style:italic;color:#66d9ef;">String </span><span style="font-style:italic;color:#fd971f;">source</span><span>) {
</span><span>      </span><span style="color:#f92672;">return </span><span style="font-style:italic;color:#66d9ef;">Arrays</span><span>.asList(source.split(</span><span style="color:#e6db74;">&quot;,&quot;</span><span>));
</span><span>  }
</span><span>}
</span></code></pre>
<hr />
<h4 id="4-3-chu-li-te-shu-zi-fu-huo-bian-ma"><strong>4.3 处理特殊字符或编码</strong></h4>
<p>当请求参数中包含特殊字符或需要特定编码处理时，默认转换器可能无法正确处理。</p>
<p><strong>示例场景：</strong></p>
<p>• 将URL编码的字符串解码：</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">UrlDecodeConverter </span><span style="color:#f92672;">implements </span><span style="text-decoration:underline;font-style:italic;color:#a6e22e;">Converter</span><span>&lt;</span><span style="font-style:italic;color:#66d9ef;">String</span><span>, </span><span style="font-style:italic;color:#66d9ef;">String</span><span>&gt; {
</span><span>  @Override
</span><span>  </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="color:#a6e22e;">convert</span><span>(</span><span style="font-style:italic;color:#66d9ef;">String </span><span style="font-style:italic;color:#fd971f;">source</span><span>) {
</span><span>      </span><span style="color:#f92672;">try </span><span>{
</span><span>          </span><span style="color:#f92672;">return </span><span style="font-style:italic;color:#66d9ef;">URLDecoder</span><span>.decode(source, </span><span style="font-style:italic;color:#66d9ef;">StandardCharsets</span><span>.</span><span style="color:#ae81ff;">UTF_8</span><span>.toString());
</span><span>      } </span><span style="color:#f92672;">catch </span><span>(</span><span style="font-style:italic;color:#66d9ef;">UnsupportedEncodingException </span><span style="font-style:italic;color:#fd971f;">e</span><span>) {
</span><span>          </span><span style="color:#f92672;">throw new </span><span style="font-style:italic;color:#66d9ef;">IllegalArgumentException</span><span>(</span><span style="color:#e6db74;">&quot;Failed to decode URL parameter&quot;</span><span>);
</span><span>      }
</span><span>  }
</span><span>}
</span></code></pre>
<hr />
<h4 id="4-4-mei-ju-lei-xing-de-zi-ding-yi-ying-she"><strong>4.4 枚举类型的自定义映射</strong></h4>
<p>当需要将请求参数映射到枚举类型，但参数值与枚举名称不一致时，需要自定义转换逻辑。</p>
<p><strong>示例场景：</strong></p>
<p>• 将字符串映射到自定义枚举：</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">enum </span><span style="text-decoration:underline;color:#a6e22e;">UserRole </span><span>{
</span><span>    </span><span style="color:#ae81ff;">ADMIN</span><span>(</span><span style="color:#e6db74;">&quot;A&quot;</span><span>), </span><span style="color:#ae81ff;">USER</span><span>(</span><span style="color:#e6db74;">&quot;U&quot;</span><span>), </span><span style="color:#ae81ff;">GUEST</span><span>(</span><span style="color:#e6db74;">&quot;G&quot;</span><span>);
</span><span>
</span><span>    </span><span style="color:#f92672;">private final </span><span style="font-style:italic;color:#66d9ef;">String </span><span>code;
</span><span>
</span><span>    </span><span style="color:#a6e22e;">UserRole</span><span>(</span><span style="font-style:italic;color:#66d9ef;">String </span><span style="font-style:italic;color:#fd971f;">code</span><span>) {
</span><span>        this.code </span><span style="color:#f92672;">=</span><span> code;
</span><span>    }
</span><span>
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="color:#a6e22e;">getCode</span><span>() {
</span><span>        </span><span style="color:#f92672;">return</span><span> code;
</span><span>    }
</span><span>
</span><span>    </span><span style="color:#f92672;">public static </span><span style="font-style:italic;color:#66d9ef;">UserRole </span><span style="color:#a6e22e;">fromCode</span><span>(</span><span style="font-style:italic;color:#66d9ef;">String </span><span style="font-style:italic;color:#fd971f;">code</span><span>) {
</span><span>        </span><span style="color:#f92672;">for </span><span>(</span><span style="font-style:italic;color:#66d9ef;">UserRole</span><span> role </span><span style="color:#f92672;">: </span><span style="font-style:italic;color:#66d9ef;">UserRole</span><span>.values()) {
</span><span>            </span><span style="color:#f92672;">if </span><span>(role.getCode().equals(code)) {
</span><span>                </span><span style="color:#f92672;">return</span><span> role;
</span><span>            }
</span><span>        }
</span><span>        </span><span style="color:#f92672;">throw new </span><span style="font-style:italic;color:#66d9ef;">IllegalArgumentException</span><span>(</span><span style="color:#e6db74;">&quot;Invalid role code: &quot; </span><span style="color:#f92672;">+</span><span> code);
</span><span>    }
</span><span>}
</span><span>
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">StringToUserRoleConverter </span><span style="color:#f92672;">implements </span><span style="text-decoration:underline;font-style:italic;color:#a6e22e;">Converter</span><span>&lt;</span><span style="font-style:italic;color:#66d9ef;">String</span><span>, </span><span style="font-style:italic;color:#66d9ef;">UserRole</span><span>&gt; {
</span><span>    @Override
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">UserRole </span><span style="color:#a6e22e;">convert</span><span>(</span><span style="font-style:italic;color:#66d9ef;">String </span><span style="font-style:italic;color:#fd971f;">source</span><span>) {
</span><span>        </span><span style="color:#f92672;">return </span><span style="font-style:italic;color:#66d9ef;">UserRole</span><span>.fromCode(source);
</span><span>    }
</span><span>}
</span></code></pre>
<hr />
<h4 id="4-5-chu-li-duo-yu-yan-huo-ben-di-hua-shu-ju"><strong>4.5 处理多语言或本地化数据</strong></h4>
<p>当请求参数需要根据用户的语言或地区进行特殊处理时，默认转换器可能无法满足需求。</p>
<p><strong>示例场景：</strong></p>
<p>• 将本地化的日期字符串转换为<code>Date</code>对象：</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">LocalizedDateConverter </span><span style="color:#f92672;">implements </span><span style="text-decoration:underline;font-style:italic;color:#a6e22e;">Converter</span><span>&lt;</span><span style="font-style:italic;color:#66d9ef;">String</span><span>, </span><span style="font-style:italic;color:#66d9ef;">Date</span><span>&gt; {
</span><span>    </span><span style="color:#f92672;">private final </span><span style="font-style:italic;color:#66d9ef;">Locale </span><span>locale;
</span><span>
</span><span>    </span><span style="color:#f92672;">public </span><span style="color:#a6e22e;">LocalizedDateConverter</span><span>(</span><span style="font-style:italic;color:#66d9ef;">Locale </span><span style="font-style:italic;color:#fd971f;">locale</span><span>) {
</span><span>        this.locale </span><span style="color:#f92672;">=</span><span> locale;
</span><span>    }
</span><span>
</span><span>    @Override
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">Date </span><span style="color:#a6e22e;">convert</span><span>(</span><span style="font-style:italic;color:#66d9ef;">String </span><span style="font-style:italic;color:#fd971f;">source</span><span>) {
</span><span>        </span><span style="font-style:italic;color:#66d9ef;">SimpleDateFormat</span><span> dateFormat </span><span style="color:#f92672;">= new </span><span style="font-style:italic;color:#66d9ef;">SimpleDateFormat</span><span>(</span><span style="color:#e6db74;">&quot;dd/MM/yyyy&quot;</span><span>, locale);
</span><span>        </span><span style="color:#f92672;">try </span><span>{
</span><span>            </span><span style="color:#f92672;">return</span><span> dateFormat.parse(source);
</span><span>        } </span><span style="color:#f92672;">catch </span><span>(</span><span style="font-style:italic;color:#66d9ef;">ParseException </span><span style="font-style:italic;color:#fd971f;">e</span><span>) {
</span><span>            </span><span style="color:#f92672;">throw new </span><span style="font-style:italic;color:#66d9ef;">IllegalArgumentException</span><span>(</span><span style="color:#e6db74;">&quot;Invalid date format for locale: &quot; </span><span style="color:#f92672;">+</span><span> locale);
</span><span>        }
</span><span>    }
</span><span>}
</span></code></pre>
<hr />
<h4 id="4-6-chu-li-fu-za-dui-xiang"><strong>4.6 处理复杂对象</strong></h4>
<p>当请求参数需要映射到复杂的嵌套对象时，默认转换器无法处理。</p>
<p><strong>示例场景：</strong></p>
<p>• 将JSON字符串转换为嵌套对象：</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">JsonToUserConverter </span><span style="color:#f92672;">implements </span><span style="text-decoration:underline;font-style:italic;color:#a6e22e;">Converter</span><span>&lt;</span><span style="font-style:italic;color:#66d9ef;">String</span><span>, </span><span style="font-style:italic;color:#66d9ef;">User</span><span>&gt; {
</span><span>    </span><span style="color:#f92672;">private final </span><span style="font-style:italic;color:#66d9ef;">ObjectMapper </span><span>objectMapper </span><span style="color:#f92672;">= new </span><span style="font-style:italic;color:#66d9ef;">ObjectMapper</span><span>();
</span><span>
</span><span>    @Override
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">User </span><span style="color:#a6e22e;">convert</span><span>(</span><span style="font-style:italic;color:#66d9ef;">String </span><span style="font-style:italic;color:#fd971f;">source</span><span>) {
</span><span>        </span><span style="color:#f92672;">try </span><span>{
</span><span>            </span><span style="color:#f92672;">return</span><span> objectMapper.readValue(source, </span><span style="font-style:italic;color:#66d9ef;">User</span><span>.class);
</span><span>        } </span><span style="color:#f92672;">catch </span><span>(</span><span style="font-style:italic;color:#66d9ef;">IOException </span><span style="font-style:italic;color:#fd971f;">e</span><span>) {
</span><span>            </span><span style="color:#f92672;">throw new </span><span style="font-style:italic;color:#66d9ef;">IllegalArgumentException</span><span>(</span><span style="color:#e6db74;">&quot;Invalid JSON format&quot;</span><span>);
</span><span>        }
</span><span>    }
</span><span>}
</span></code></pre>
<hr />
<h4 id="4-7-chu-li-mo-ren-zhuan-huan-qi-bu-zhi-chi-de-lei-xing"><strong>4.7 处理默认转换器不支持的类型</strong></h4>
<p>当请求参数的类型是默认转换器不支持的类型时，需要自定义转换器。</p>
<p><strong>示例场景：</strong></p>
<p>• 将字符串转换为自定义的<code>Money</code>类型：</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">StringToMoneyConverter </span><span style="color:#f92672;">implements </span><span style="text-decoration:underline;font-style:italic;color:#a6e22e;">Converter</span><span>&lt;</span><span style="font-style:italic;color:#66d9ef;">String</span><span>, </span><span style="font-style:italic;color:#66d9ef;">Money</span><span>&gt; {
</span><span>  @Override
</span><span>  </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">Money </span><span style="color:#a6e22e;">convert</span><span>(</span><span style="font-style:italic;color:#66d9ef;">String </span><span style="font-style:italic;color:#fd971f;">source</span><span>) {
</span><span>      </span><span style="font-style:italic;color:#66d9ef;">String</span><span style="color:#f92672;">[]</span><span> parts </span><span style="color:#f92672;">=</span><span> source.split(</span><span style="color:#e6db74;">&quot; &quot;</span><span>);
</span><span>      </span><span style="color:#f92672;">if </span><span>(parts.length </span><span style="color:#f92672;">!= </span><span style="color:#ae81ff;">2</span><span>) {
</span><span>          </span><span style="color:#f92672;">throw new </span><span style="font-style:italic;color:#66d9ef;">IllegalArgumentException</span><span>(</span><span style="color:#e6db74;">&quot;Invalid money format. Expected format: &#39;100 USD&#39;&quot;</span><span>);
</span><span>      }
</span><span>      </span><span style="color:#f92672;">return new </span><span style="font-style:italic;color:#66d9ef;">Money</span><span>(</span><span style="font-style:italic;color:#66d9ef;">Double</span><span>.parseDouble(parts[</span><span style="color:#ae81ff;">0</span><span>]), parts[</span><span style="color:#ae81ff;">1</span><span>]);
</span><span>  }
</span><span>}
</span></code></pre>
<hr />
<h4 id="4-8-chu-li-duo-zhi-can-shu"><strong>4.8 处理多值参数</strong></h4>
<p>当请求参数包含多个值，且需要将其转换为特定类型时，默认转换器可能无法处理。</p>
<p><strong>示例场景：</strong></p>
<p>• 将多个复选框的值转换为布尔列表：</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">StringToBooleanListConverter </span><span style="color:#f92672;">implements </span><span style="text-decoration:underline;font-style:italic;color:#a6e22e;">Converter</span><span>&lt;</span><span style="font-style:italic;color:#66d9ef;">String</span><span style="color:#f92672;">[]</span><span>, </span><span style="font-style:italic;color:#66d9ef;">List</span><span>&lt;</span><span style="font-style:italic;color:#66d9ef;">Boolean</span><span>&gt;&gt; {
</span><span>  @Override
</span><span>  </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">List</span><span>&lt;</span><span style="font-style:italic;color:#66d9ef;">Boolean</span><span>&gt; </span><span style="color:#a6e22e;">convert</span><span>(</span><span style="font-style:italic;color:#66d9ef;">String</span><span style="color:#f92672;">[] </span><span style="font-style:italic;color:#fd971f;">source</span><span>) {
</span><span>      </span><span style="color:#f92672;">return </span><span style="font-style:italic;color:#66d9ef;">Arrays</span><span>.stream(source)
</span><span>                   .map(</span><span style="font-style:italic;color:#66d9ef;">Boolean</span><span>::parseBoolean)
</span><span>                   .collect(</span><span style="font-style:italic;color:#66d9ef;">Collectors</span><span>.toList());
</span><span>  }
</span><span>}
</span></code></pre>
<hr />
<p>自定义类型转换器在以下场景中非常有用：</p>
<ol>
<li>处理复杂类型或自定义格式的请求参数。</li>
<li>处理特殊字符、编码或本地化数据。</li>
<li>映射枚举类型或嵌套对象。</li>
<li>处理默认转换器不支持的类型或多值参数。</li>
</ol>
<p>通过自定义类型转换器，开发者可以灵活地处理各种复杂的请求参数，确保数据绑定过程符合业务需求。</p>
<h4 id="zong-jie"><strong>总结</strong></h4>
<p>• <strong>数据绑定</strong>：Spring MVC自动将请求参数绑定到Java对象，支持自定义类型转换和绑定规则。
• <strong>验证</strong>：通过JSR-303/JSR-380标准注解对模型数据进行验证，支持自定义验证和分组验证。
• <strong>结合使用</strong>：数据绑定和验证通常结合使用，确保用户输入的数据有效且符合业务规则。</p>
<p>通过合理使用数据绑定和验证，开发者可以简化代码、提高开发效率，并确保应用程序的健壮性和安全性。</p>
<h2 id="qi-shi-tu-ji-zhu"><strong>七、视图技术</strong></h2>
<p>• Spring MVC支持多种视图技术，包括JSP、Thymeleaf、FreeMarker、Velocity等。
• 通过配置ViewResolver，可以灵活选择和使用不同的视图技术。</p>
<p>配置视图的一般步骤：</p>
<ol>
<li>在pom.xml中添加依赖。</li>
<li>在 Spring（或SpringBoot）配置文件中配置视图解析器。</li>
<li>放置视图文件，通常放在 <code>/WEB-INF/views/</code> 目录下。</li>
<li>在控制器方法中返回视图名称，Spring MVC 会自动解析。</li>
</ol>
<h3 id="1-ge-chong-shi-tu-ji-zhu-yi-lan"><strong>1. 各种视图技术一览</strong></h3>
<table><thead><tr><th>技术类型</th><th>Spring MVC 支持</th><th>Spring Boot 支持</th></tr></thead><tbody>
<tr><td><strong>Thymeleaf</strong></td><td>✅</td><td>✅（默认支持，推荐）</td></tr>
<tr><td><strong>FreeMarker</strong></td><td>✅</td><td>✅（默认支持，适用复杂场景）</td></tr>
<tr><td><strong>JSP</strong></td><td>✅</td><td>❌（需手动配置，不推荐）</td></tr>
<tr><td><strong>Velocity</strong></td><td>✅</td><td>❌（需手动配置，不推荐）</td></tr>
<tr><td><strong>Groovy</strong></td><td>✅</td><td>✅（默认支持）</td></tr>
<tr><td><strong>Mustache</strong></td><td>✅</td><td>✅（默认支持）</td></tr>
<tr><td><strong>JSON/XML</strong></td><td>✅</td><td>✅（默认支持，适用API开发）</td></tr>
</tbody></table>
<p><strong>SpringBoot推荐视图技术：Thymeleaf</strong></p>
<pre style="background-color:#272822;color:#f8f8f2;"><code><span>1. **与 Spring 集成紧密**：Thymeleaf 是 Spring 官方推荐的视图技术，天然支持 Spring 的标签和表达式。
</span><span>2. **自然模板**：Thymeleaf 模板可以在浏览器中直接预览，无需启动应用。
</span><span>3. **现代化**：支持 HTML5，语法简洁，适合现代 Web 开发。
</span><span>4. **自动配置**：Spring Boot 默认支持 Thymeleaf，无需额外配置。
</span><span>5. **社区活跃**：Thymeleaf 社区活跃，文档完善，易于学习和使用。
</span></code></pre>
<p><strong>其他推荐技术</strong></p>
<p>• <strong>FreeMarker</strong>：
• 适合需要复杂模板逻辑的场景。
• 语法比 Thymeleaf 更灵活，但学习曲线稍高。
• <strong>JSON/XML</strong>：
• 适合 RESTful API 开发，无需前端模板引擎。</p>
<p><strong>不推荐技术</strong></p>
<p>• <strong>JSP</strong>：
• Spring Boot 对 JSP 支持较差，部署复杂，不推荐使用。
• <strong>Velocity</strong>：
• 较老的模板引擎，语法简单，功能较弱，目前逐渐被 FreeMarker 和 Thymeleaf 取代。</p>
<p><strong>其他技术</strong></p>
<p><strong>Groovy Markup Templates：</strong>
• 基于 Groovy 的模板引擎，支持动态生成 HTML、XML 等。
• 适合熟悉 Groovy 的开发者。Spring Boot 默认支持，只需添加 <code>spring-boot-starter-groovy-templates</code> 依赖。</p>
<p><strong>Mustache</strong>：
• 轻量级模板引擎，语法简单，支持多种语言。
• 适合简单的模板渲染场景。Spring Boot 默认支持，只需添加 <code>spring-boot-starter-mustache</code> 依赖。</p>
<h3 id="2-jsp-shi-tu-ji-zhu"><strong>2. JSP 视图技术</strong></h3>
<p>传统的 Java Web 视图技术，适合简单的动态页面渲染。</p>
<p>需要在 WEB-INF 目录下放置 JSP 文件。</p>
<p>Spring Boot 默认不支持 JSP，但可以通过手动配置启用。不推荐在 Spring Boot 中使用 JSP。</p>
<h4 id="xml-pei-zhi-spring-xiang-mu"><strong>XML 配置（Spring 项目）</strong></h4>
<pre data-lang="xml" style="background-color:#272822;color:#f8f8f2;" class="language-xml "><code class="language-xml" data-lang="xml"><span>&lt;</span><span style="color:#f92672;">bean </span><span style="color:#a6e22e;">class</span><span>=</span><span style="color:#e6db74;">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span><span>&gt;
</span><span>    &lt;</span><span style="color:#f92672;">property </span><span style="color:#a6e22e;">name</span><span>=</span><span style="color:#e6db74;">&quot;prefix&quot; </span><span style="color:#a6e22e;">value</span><span>=</span><span style="color:#e6db74;">&quot;/WEB-INF/views/&quot; </span><span>/&gt;
</span><span>    &lt;</span><span style="color:#f92672;">property </span><span style="color:#a6e22e;">name</span><span>=</span><span style="color:#e6db74;">&quot;suffix&quot; </span><span style="color:#a6e22e;">value</span><span>=</span><span style="color:#e6db74;">&quot;.jsp&quot; </span><span>/&gt;
</span><span>&lt;/</span><span style="color:#f92672;">bean</span><span>&gt;
</span></code></pre>
<h4 id="java-pei-zhi-spring-xiang-mu"><strong>Java 配置（Spring 项目）</strong></h4>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Configuration
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">JspConfig </span><span>{
</span><span>    @Bean
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">InternalResourceViewResolver </span><span style="color:#a6e22e;">viewResolver</span><span>() {
</span><span>        </span><span style="font-style:italic;color:#66d9ef;">InternalResourceViewResolver</span><span> resolver </span><span style="color:#f92672;">= new </span><span style="font-style:italic;color:#66d9ef;">InternalResourceViewResolver</span><span>();
</span><span>        resolver.setPrefix(</span><span style="color:#e6db74;">&quot;/WEB-INF/views/&quot;</span><span>);
</span><span>        resolver.setSuffix(</span><span style="color:#e6db74;">&quot;.jsp&quot;</span><span>);
</span><span>        </span><span style="color:#f92672;">return</span><span> resolver;
</span><span>    }
</span><span>}
</span></code></pre>
<h4 id="spring-boot-xiang-mu-pei-zhi"><strong>Spring Boot 项目配置</strong></h4>
<p>Spring Boot 默认不支持 JSP，但可以通过以下方式启用：</p>
<ol>
<li>在 <code>application.properties</code> 中配置：<pre data-lang="properties" style="background-color:#272822;color:#f8f8f2;" class="language-properties "><code class="language-properties" data-lang="properties"><span>spring.mvc.view.prefix=</span><span style="color:#e6db74;">/WEB-INF/views/
</span><span>spring.mvc.view.suffix=</span><span style="color:#e6db74;">.jsp
</span></code></pre>
</li>
<li>确保 JSP 文件放在 <code>src/main/webapp/WEB-INF/views/</code> 目录下。</li>
</ol>
<hr />
<h3 id="3-thymeleaf-shi-tu-ji-zhu"><strong>3. Thymeleaf 视图技术</strong></h3>
<p>现代模板引擎，支持 HTML5，天然支持与 Spring 集成。
• 强调自然模板（Natural Templates），可以在浏览器中直接预览。</p>
<p>配置 <code>ThymeleafViewResolver</code> 和 <code>SpringTemplateEngine</code>，将视图名称解析为 Thymeleaf 模板。</p>
<p>• Spring Boot 的默认推荐视图技术。
• 自动配置支持，只需添加 spring-boot-starter-thymeleaf 依赖。</p>
<h4 id="xml-pei-zhi-spring-xiang-mu-1"><strong>XML 配置（Spring 项目）</strong></h4>
<pre data-lang="xml" style="background-color:#272822;color:#f8f8f2;" class="language-xml "><code class="language-xml" data-lang="xml"><span>&lt;</span><span style="color:#f92672;">bean </span><span style="color:#a6e22e;">id</span><span>=</span><span style="color:#e6db74;">&quot;templateResolver&quot; </span><span style="color:#a6e22e;">class</span><span>=</span><span style="color:#e6db74;">&quot;org.thymeleaf.spring5.templateresolver.SpringResourceTemplateResolver&quot;</span><span>&gt;
</span><span>    &lt;</span><span style="color:#f92672;">property </span><span style="color:#a6e22e;">name</span><span>=</span><span style="color:#e6db74;">&quot;prefix&quot; </span><span style="color:#a6e22e;">value</span><span>=</span><span style="color:#e6db74;">&quot;/WEB-INF/views/&quot; </span><span>/&gt;
</span><span>    &lt;</span><span style="color:#f92672;">property </span><span style="color:#a6e22e;">name</span><span>=</span><span style="color:#e6db74;">&quot;suffix&quot; </span><span style="color:#a6e22e;">value</span><span>=</span><span style="color:#e6db74;">&quot;.html&quot; </span><span>/&gt;
</span><span>    &lt;</span><span style="color:#f92672;">property </span><span style="color:#a6e22e;">name</span><span>=</span><span style="color:#e6db74;">&quot;templateMode&quot; </span><span style="color:#a6e22e;">value</span><span>=</span><span style="color:#e6db74;">&quot;HTML&quot; </span><span>/&gt;
</span><span>    &lt;</span><span style="color:#f92672;">property </span><span style="color:#a6e22e;">name</span><span>=</span><span style="color:#e6db74;">&quot;characterEncoding&quot; </span><span style="color:#a6e22e;">value</span><span>=</span><span style="color:#e6db74;">&quot;UTF-8&quot; </span><span>/&gt;
</span><span>&lt;/</span><span style="color:#f92672;">bean</span><span>&gt;
</span><span>
</span><span>&lt;</span><span style="color:#f92672;">bean </span><span style="color:#a6e22e;">id</span><span>=</span><span style="color:#e6db74;">&quot;templateEngine&quot; </span><span style="color:#a6e22e;">class</span><span>=</span><span style="color:#e6db74;">&quot;org.thymeleaf.spring5.SpringTemplateEngine&quot;</span><span>&gt;
</span><span>    &lt;</span><span style="color:#f92672;">property </span><span style="color:#a6e22e;">name</span><span>=</span><span style="color:#e6db74;">&quot;templateResolver&quot; </span><span style="color:#a6e22e;">ref</span><span>=</span><span style="color:#e6db74;">&quot;templateResolver&quot; </span><span>/&gt;
</span><span>&lt;/</span><span style="color:#f92672;">bean</span><span>&gt;
</span><span>
</span><span>&lt;</span><span style="color:#f92672;">bean </span><span style="color:#a6e22e;">class</span><span>=</span><span style="color:#e6db74;">&quot;org.thymeleaf.spring5.view.ThymeleafViewResolver&quot;</span><span>&gt;
</span><span>    &lt;</span><span style="color:#f92672;">property </span><span style="color:#a6e22e;">name</span><span>=</span><span style="color:#e6db74;">&quot;templateEngine&quot; </span><span style="color:#a6e22e;">ref</span><span>=</span><span style="color:#e6db74;">&quot;templateEngine&quot; </span><span>/&gt;
</span><span>    &lt;</span><span style="color:#f92672;">property </span><span style="color:#a6e22e;">name</span><span>=</span><span style="color:#e6db74;">&quot;characterEncoding&quot; </span><span style="color:#a6e22e;">value</span><span>=</span><span style="color:#e6db74;">&quot;UTF-8&quot; </span><span>/&gt;
</span><span>&lt;/</span><span style="color:#f92672;">bean</span><span>&gt;
</span></code></pre>
<h4 id="java-pei-zhi-spring-xiang-mu-1"><strong>Java 配置（Spring 项目）</strong></h4>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Configuration
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">ThymeleafConfig </span><span>{
</span><span>    @Bean
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">SpringTemplateEngine </span><span style="color:#a6e22e;">templateEngine</span><span>() {
</span><span>        </span><span style="font-style:italic;color:#66d9ef;">SpringTemplateEngine</span><span> templateEngine </span><span style="color:#f92672;">= new </span><span style="font-style:italic;color:#66d9ef;">SpringTemplateEngine</span><span>();
</span><span>        templateEngine.setTemplateResolver(templateResolver());
</span><span>        </span><span style="color:#f92672;">return</span><span> templateEngine;
</span><span>    }
</span><span>
</span><span>    @Bean
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">ThymeleafViewResolver </span><span style="color:#a6e22e;">thymeleafViewResolver</span><span>() {
</span><span>        </span><span style="font-style:italic;color:#66d9ef;">ThymeleafViewResolver</span><span> resolver </span><span style="color:#f92672;">= new </span><span style="font-style:italic;color:#66d9ef;">ThymeleafViewResolver</span><span>();
</span><span>        resolver.setTemplateEngine(templateEngine());
</span><span>        resolver.setCharacterEncoding(</span><span style="color:#e6db74;">&quot;UTF-8&quot;</span><span>);
</span><span>        </span><span style="color:#f92672;">return</span><span> resolver;
</span><span>    }
</span><span>
</span><span>    </span><span style="color:#f92672;">private </span><span style="font-style:italic;color:#66d9ef;">ITemplateResolver </span><span style="color:#a6e22e;">templateResolver</span><span>() {
</span><span>        </span><span style="font-style:italic;color:#66d9ef;">SpringResourceTemplateResolver</span><span> resolver </span><span style="color:#f92672;">= new </span><span style="font-style:italic;color:#66d9ef;">SpringResourceTemplateResolver</span><span>();
</span><span>        resolver.setPrefix(</span><span style="color:#e6db74;">&quot;/WEB-INF/views/&quot;</span><span>);
</span><span>        resolver.setSuffix(</span><span style="color:#e6db74;">&quot;.html&quot;</span><span>);
</span><span>        resolver.setTemplateMode(</span><span style="font-style:italic;color:#66d9ef;">TemplateMode</span><span>.</span><span style="color:#ae81ff;">HTML</span><span>);
</span><span>        resolver.setCharacterEncoding(</span><span style="color:#e6db74;">&quot;UTF-8&quot;</span><span>);
</span><span>        </span><span style="color:#f92672;">return</span><span> resolver;
</span><span>    }
</span><span>}
</span></code></pre>
<h4 id="spring-boot-xiang-mu-pei-zhi-1"><strong>Spring Boot 项目配置</strong></h4>
<p>Spring Boot 默认支持 Thymeleaf，只需添加依赖：</p>
<pre data-lang="xml" style="background-color:#272822;color:#f8f8f2;" class="language-xml "><code class="language-xml" data-lang="xml"><span>&lt;</span><span style="color:#f92672;">dependency</span><span>&gt;
</span><span>    &lt;</span><span style="color:#f92672;">groupId</span><span>&gt;org.springframework.boot&lt;/</span><span style="color:#f92672;">groupId</span><span>&gt;
</span><span>    &lt;</span><span style="color:#f92672;">artifactId</span><span>&gt;spring-boot-starter-thymeleaf&lt;/</span><span style="color:#f92672;">artifactId</span><span>&gt;
</span><span>&lt;/</span><span style="color:#f92672;">dependency</span><span>&gt;
</span></code></pre>
<p>默认模板路径为 <code>src/main/resources/templates/</code>，可通过 <code>application.properties</code> 配置：</p>
<pre data-lang="properties" style="background-color:#272822;color:#f8f8f2;" class="language-properties "><code class="language-properties" data-lang="properties"><span>spring.thymeleaf.prefix=</span><span style="color:#e6db74;">classpath:/templates/
</span><span>spring.thymeleaf.suffix=</span><span style="color:#e6db74;">.html
</span></code></pre>
<hr />
<h3 id="4-freemarker-shi-tu-ji-zhu"><strong>4. FreeMarker 视图技术</strong></h3>
<p>• 功能强大的模板引擎，支持动态生成 HTML、XML、JSON 等。配置 <code>FreeMarkerViewResolver</code> 和 <code>FreeMarkerConfigurer</code>，将视图名称解析为 FreeMarker 模板。
• 语法简洁，适合复杂的模板渲染场景。• Spring Boot 默认支持，只需添加 <code>spring-boot-starter-freemarker</code> 依赖。</p>
<h4 id="xml-pei-zhi-spring-xiang-mu-2"><strong>XML 配置（Spring 项目）</strong></h4>
<pre data-lang="xml" style="background-color:#272822;color:#f8f8f2;" class="language-xml "><code class="language-xml" data-lang="xml"><span>&lt;</span><span style="color:#f92672;">bean </span><span style="color:#a6e22e;">id</span><span>=</span><span style="color:#e6db74;">&quot;freeMarkerConfigurer&quot; </span><span style="color:#a6e22e;">class</span><span>=</span><span style="color:#e6db74;">&quot;org.springframework.web.servlet.view.freemarker.FreeMarkerConfigurer&quot;</span><span>&gt;
</span><span>    &lt;</span><span style="color:#f92672;">property </span><span style="color:#a6e22e;">name</span><span>=</span><span style="color:#e6db74;">&quot;templateLoaderPath&quot; </span><span style="color:#a6e22e;">value</span><span>=</span><span style="color:#e6db74;">&quot;/WEB-INF/views/&quot; </span><span>/&gt;
</span><span>&lt;/</span><span style="color:#f92672;">bean</span><span>&gt;
</span><span>
</span><span>&lt;</span><span style="color:#f92672;">bean </span><span style="color:#a6e22e;">class</span><span>=</span><span style="color:#e6db74;">&quot;org.springframework.web.servlet.view.freemarker.FreeMarkerViewResolver&quot;</span><span>&gt;
</span><span>    &lt;</span><span style="color:#f92672;">property </span><span style="color:#a6e22e;">name</span><span>=</span><span style="color:#e6db74;">&quot;suffix&quot; </span><span style="color:#a6e22e;">value</span><span>=</span><span style="color:#e6db74;">&quot;.ftl&quot; </span><span>/&gt;
</span><span>    &lt;</span><span style="color:#f92672;">property </span><span style="color:#a6e22e;">name</span><span>=</span><span style="color:#e6db74;">&quot;contentType&quot; </span><span style="color:#a6e22e;">value</span><span>=</span><span style="color:#e6db74;">&quot;text/html;charset=UTF-8&quot; </span><span>/&gt;
</span><span>&lt;/</span><span style="color:#f92672;">bean</span><span>&gt;
</span></code></pre>
<h4 id="java-pei-zhi-spring-xiang-mu-2"><strong>Java 配置（Spring 项目）</strong></h4>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Configuration
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">FreeMarkerConfig </span><span>{
</span><span>    @Bean
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">FreeMarkerConfigurer </span><span style="color:#a6e22e;">freeMarkerConfigurer</span><span>() {
</span><span>        </span><span style="font-style:italic;color:#66d9ef;">FreeMarkerConfigurer</span><span> configurer </span><span style="color:#f92672;">= new </span><span style="font-style:italic;color:#66d9ef;">FreeMarkerConfigurer</span><span>();
</span><span>        configurer.setTemplateLoaderPath(</span><span style="color:#e6db74;">&quot;/WEB-INF/views/&quot;</span><span>);
</span><span>        </span><span style="color:#f92672;">return</span><span> configurer;
</span><span>    }
</span><span>
</span><span>    @Bean
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">FreeMarkerViewResolver </span><span style="color:#a6e22e;">freeMarkerViewResolver</span><span>() {
</span><span>        </span><span style="font-style:italic;color:#66d9ef;">FreeMarkerViewResolver</span><span> resolver </span><span style="color:#f92672;">= new </span><span style="font-style:italic;color:#66d9ef;">FreeMarkerViewResolver</span><span>();
</span><span>        resolver.setSuffix(</span><span style="color:#e6db74;">&quot;.ftl&quot;</span><span>);
</span><span>        resolver.setContentType(</span><span style="color:#e6db74;">&quot;text/html;charset=UTF-8&quot;</span><span>);
</span><span>        </span><span style="color:#f92672;">return</span><span> resolver;
</span><span>    }
</span><span>}
</span></code></pre>
<h4 id="spring-boot-xiang-mu-pei-zhi-2"><strong>Spring Boot 项目配置</strong></h4>
<p>Spring Boot 默认支持 FreeMarker，只需添加依赖：</p>
<pre data-lang="xml" style="background-color:#272822;color:#f8f8f2;" class="language-xml "><code class="language-xml" data-lang="xml"><span>&lt;</span><span style="color:#f92672;">dependency</span><span>&gt;
</span><span>    &lt;</span><span style="color:#f92672;">groupId</span><span>&gt;org.springframework.boot&lt;/</span><span style="color:#f92672;">groupId</span><span>&gt;
</span><span>    &lt;</span><span style="color:#f92672;">artifactId</span><span>&gt;spring-boot-starter-freemarker&lt;/</span><span style="color:#f92672;">artifactId</span><span>&gt;
</span><span>&lt;/</span><span style="color:#f92672;">dependency</span><span>&gt;
</span></code></pre>
<p>默认模板路径为 <code>src/main/resources/templates/</code>，可通过 <code>application.properties</code> 配置：</p>
<pre data-lang="properties" style="background-color:#272822;color:#f8f8f2;" class="language-properties "><code class="language-properties" data-lang="properties"><span>spring.freemarker.prefix=</span><span style="color:#e6db74;">classpath:/templates/
</span><span>spring.freemarker.suffix=</span><span style="color:#e6db74;">.ftl
</span></code></pre>
<h3 id="5-json-xml">**5. JSON/XML **</h3>
<p>• 通过 <code>@Controller</code> + <code>@ResponseBody</code> 或 <code>@RestController</code> 直接返回 JSON 或 XML 数据。
• 常用于 RESTful API 开发。不需要视图文件，直接通过控制器方法返回对象。</p>
<p>Spring Boot 默认支持。</p>
<h4 id="1-fan-hui-json-xml-shu-ju-de-gua-yong-chang-jing"><strong>1. 返回 JSON/XML 数据的适用场景</strong></h4>
<p>• <strong>RESTful API 项目</strong>：
• 前后端分离架构，前端通过 API 与后端交互。
• 后端通常返回 JSON/XML 格式的数据，而不是 HTML 页面。
• <strong>微服务架构</strong>：
• 服务之间通过 API 通信，通常使用 JSON/XML 作为数据格式。
• <strong>移动端或第三方集成</strong>：
• 移动端应用或第三方系统通常需要 JSON/XML 格式的错误信息。</p>
<h4 id="2-shi-xian-fang-shi">2. 实现方式</h4>
<h5 id="1-shi-yong-restcontroller-fan-hui-json-xml-shu-ju"><strong>1. 使用 <code>@RestController</code> 返回 JSON/XML 数据</strong></h5>
<p><code>@RestController</code> 是 <code>@Controller</code> 和 <code>@ResponseBody</code> 的组合注解，直接返回数据而不是视图。</p>
<p><strong>示例 1：返回 JSON 数据</strong></p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@RestController
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">UserController </span><span>{
</span><span>    @GetMapping(</span><span style="color:#e6db74;">&quot;/user&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">User </span><span style="color:#a6e22e;">getUser</span><span>() {
</span><span>        </span><span style="color:#f92672;">return new </span><span style="font-style:italic;color:#66d9ef;">User</span><span>(</span><span style="color:#ae81ff;">1</span><span>, </span><span style="color:#e6db74;">&quot;John Doe&quot;</span><span>);
</span><span>    }
</span><span>}
</span></code></pre>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@RestController
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">UserController </span><span>{
</span><span>    @RequestMapping(</span><span style="font-style:italic;color:#fd971f;">value </span><span style="color:#f92672;">= </span><span style="color:#e6db74;">&quot;/user&quot;</span><span>, </span><span style="font-style:italic;color:#fd971f;">method </span><span style="color:#f92672;">= </span><span style="font-style:italic;color:#66d9ef;">RequestMethod</span><span>.</span><span style="color:#ae81ff;">GET</span><span>, </span><span style="font-style:italic;color:#fd971f;">produces </span><span style="color:#f92672;">= </span><span style="font-style:italic;color:#66d9ef;">MediaType</span><span>.</span><span style="color:#ae81ff;">APPLICATION_JSON_VALUE</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">User </span><span style="color:#a6e22e;">getUser</span><span>() {
</span><span>        </span><span style="color:#f92672;">return new </span><span style="font-style:italic;color:#66d9ef;">User</span><span>(</span><span style="color:#ae81ff;">1</span><span>, </span><span style="color:#e6db74;">&quot;John Doe&quot;</span><span>);
</span><span>    }
</span><span>}
</span></code></pre>
<p><strong>示例 2：返回 XML 数据</strong></p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@RestController
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">UserController </span><span>{
</span><span>    @GetMapping(</span><span style="font-style:italic;color:#fd971f;">value </span><span style="color:#f92672;">= </span><span style="color:#e6db74;">&quot;/user&quot;</span><span>, </span><span style="font-style:italic;color:#fd971f;">produces </span><span style="color:#f92672;">= </span><span style="font-style:italic;color:#66d9ef;">MediaType</span><span>.</span><span style="color:#ae81ff;">APPLICATION_XML_VALUE</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">User </span><span style="color:#a6e22e;">getUser</span><span>() {
</span><span>        </span><span style="color:#f92672;">return new </span><span style="font-style:italic;color:#66d9ef;">User</span><span>(</span><span style="color:#ae81ff;">1</span><span>, </span><span style="color:#e6db74;">&quot;John Doe&quot;</span><span>);
</span><span>    }
</span><span>}
</span></code></pre>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@RestController
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">UserController </span><span>{
</span><span>    @RequestMapping(</span><span style="font-style:italic;color:#fd971f;">value </span><span style="color:#f92672;">= </span><span style="color:#e6db74;">&quot;/user&quot;</span><span>, </span><span style="font-style:italic;color:#fd971f;">method </span><span style="color:#f92672;">= </span><span style="font-style:italic;color:#66d9ef;">RequestMethod</span><span>.</span><span style="color:#ae81ff;">GET</span><span>, </span><span style="font-style:italic;color:#fd971f;">produces </span><span style="color:#f92672;">= </span><span style="font-style:italic;color:#66d9ef;">MediaType</span><span>.</span><span style="color:#ae81ff;">APPLICATION_XML_VALUE</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">User </span><span style="color:#a6e22e;">getUser</span><span>() {
</span><span>        </span><span style="color:#f92672;">return new </span><span style="font-style:italic;color:#66d9ef;">User</span><span>(</span><span style="color:#ae81ff;">1</span><span>, </span><span style="color:#e6db74;">&quot;John Doe&quot;</span><span>);
</span><span>    }
</span><span>}
</span></code></pre>
<h5 id="2-shi-yong-controller-responsebody-fan-hui-json-xml-shu-ju"><strong>2. 使用 <code>@Controller</code> + <code>@ResponseBody</code> 返回 JSON/XML 数据</strong></h5>
<p><code>@Controller</code> 用于定义控制器，<code>@ResponseBody</code> 用于将返回值直接写入 HTTP 响应体。</p>
<p><strong>示例 1：返回 JSON 数据</strong></p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Controller
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">UserController </span><span>{
</span><span>    @GetMapping(</span><span style="color:#e6db74;">&quot;/user&quot;</span><span>)
</span><span>    @ResponseBody
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">User </span><span style="color:#a6e22e;">getUser</span><span>() {
</span><span>        </span><span style="color:#f92672;">return new </span><span style="font-style:italic;color:#66d9ef;">User</span><span>(</span><span style="color:#ae81ff;">1</span><span>, </span><span style="color:#e6db74;">&quot;John Doe&quot;</span><span>);
</span><span>    }
</span><span>}
</span></code></pre>
<p><strong>示例 2：返回 XML 数据</strong></p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Controller
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">UserController </span><span>{
</span><span>    @GetMapping(</span><span style="font-style:italic;color:#fd971f;">value </span><span style="color:#f92672;">= </span><span style="color:#e6db74;">&quot;/user&quot;</span><span>, </span><span style="font-style:italic;color:#fd971f;">produces </span><span style="color:#f92672;">= </span><span style="font-style:italic;color:#66d9ef;">MediaType</span><span>.</span><span style="color:#ae81ff;">APPLICATION_XML_VALUE</span><span>)
</span><span>    @ResponseBody
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">User </span><span style="color:#a6e22e;">getUser</span><span>() {
</span><span>        </span><span style="color:#f92672;">return new </span><span style="font-style:italic;color:#66d9ef;">User</span><span>(</span><span style="color:#ae81ff;">1</span><span>, </span><span style="color:#e6db74;">&quot;John Doe&quot;</span><span>);
</span><span>    }
</span><span>}
</span></code></pre>
<h5 id="3-shi-yong-responsestatus-fan-hui-json-xml-shu-ju"><strong>3. 使用 <code>@ResponseStatus</code> 返回 JSON/XML 数据</strong></h5>
<p><code>@ResponseStatus</code> 可以指定 HTTP 响应的<strong>状态码</strong>。</p>
<p><strong>示例 1：返回 JSON 数据</strong></p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@RestController
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">UserController </span><span>{
</span><span>    @GetMapping(</span><span style="color:#e6db74;">&quot;/user&quot;</span><span>)
</span><span>    @ResponseStatus(</span><span style="font-style:italic;color:#66d9ef;">HttpStatus</span><span>.</span><span style="color:#ae81ff;">OK</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">User </span><span style="color:#a6e22e;">getUser</span><span>() {
</span><span>        </span><span style="color:#f92672;">return new </span><span style="font-style:italic;color:#66d9ef;">User</span><span>(</span><span style="color:#ae81ff;">1</span><span>, </span><span style="color:#e6db74;">&quot;John Doe&quot;</span><span>);
</span><span>    }
</span><span>}
</span></code></pre>
<p><strong>示例 2：返回 XML 数据</strong></p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@RestController
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">UserController </span><span>{
</span><span>    @GetMapping(</span><span style="font-style:italic;color:#fd971f;">value </span><span style="color:#f92672;">= </span><span style="color:#e6db74;">&quot;/user&quot;</span><span>, </span><span style="font-style:italic;color:#fd971f;">produces </span><span style="color:#f92672;">= </span><span style="font-style:italic;color:#66d9ef;">MediaType</span><span>.</span><span style="color:#ae81ff;">APPLICATION_XML_VALUE</span><span>)
</span><span>    @ResponseStatus(</span><span style="font-style:italic;color:#66d9ef;">HttpStatus</span><span>.</span><span style="color:#ae81ff;">OK</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">User </span><span style="color:#a6e22e;">getUser</span><span>() {
</span><span>        </span><span style="color:#f92672;">return new </span><span style="font-style:italic;color:#66d9ef;">User</span><span>(</span><span style="color:#ae81ff;">1</span><span>, </span><span style="color:#e6db74;">&quot;John Doe&quot;</span><span>);
</span><span>    }
</span><span>}
</span></code></pre>
<hr />
<h5 id="4-shi-yong-responseentity-fan-hui-json-xml-shu-ju"><strong>4. 使用 <code>ResponseEntity</code> 返回 JSON/XML 数据</strong></h5>
<p><code>ResponseEntity</code> 可以灵活地控制 HTTP 响应的<strong>状态码、头部和内容</strong>。</p>
<p><strong>示例 1：返回 JSON 数据</strong></p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@RestController
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">UserController </span><span>{
</span><span>    @GetMapping(</span><span style="color:#e6db74;">&quot;/user&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">ResponseEntity</span><span>&lt;</span><span style="font-style:italic;color:#66d9ef;">User</span><span>&gt; </span><span style="color:#a6e22e;">getUser</span><span>() {
</span><span>        </span><span style="font-style:italic;color:#66d9ef;">User</span><span> user </span><span style="color:#f92672;">= new </span><span style="font-style:italic;color:#66d9ef;">User</span><span>(</span><span style="color:#ae81ff;">1</span><span>, </span><span style="color:#e6db74;">&quot;John Doe&quot;</span><span>);
</span><span>        </span><span style="color:#f92672;">return </span><span style="font-style:italic;color:#66d9ef;">ResponseEntity</span><span>.ok(user); </span><span style="color:#75715e;">// 返回 200 状态码和 JSON 数据
</span><span>    }
</span><span>}
</span></code></pre>
<p><strong>示例 2：返回 XML 数据</strong></p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@RestController
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">UserController </span><span>{
</span><span>    @GetMapping(</span><span style="font-style:italic;color:#fd971f;">value </span><span style="color:#f92672;">= </span><span style="color:#e6db74;">&quot;/user&quot;</span><span>, </span><span style="font-style:italic;color:#fd971f;">produces </span><span style="color:#f92672;">= </span><span style="font-style:italic;color:#66d9ef;">MediaType</span><span>.</span><span style="color:#ae81ff;">APPLICATION_XML_VALUE</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">ResponseEntity</span><span>&lt;</span><span style="font-style:italic;color:#66d9ef;">User</span><span>&gt; </span><span style="color:#a6e22e;">getUser</span><span>() {
</span><span>        </span><span style="font-style:italic;color:#66d9ef;">User</span><span> user </span><span style="color:#f92672;">= new </span><span style="font-style:italic;color:#66d9ef;">User</span><span>(</span><span style="color:#ae81ff;">1</span><span>, </span><span style="color:#e6db74;">&quot;John Doe&quot;</span><span>);
</span><span>        </span><span style="color:#f92672;">return </span><span style="font-style:italic;color:#66d9ef;">ResponseEntity</span><span>.ok(user); </span><span style="color:#75715e;">// 返回 200 状态码和 XML 数据
</span><span>    }
</span><span>}
</span></code></pre>
<hr />
<h5 id="5-shi-yong-exceptionhandler-fan-hui-json-xml-cuo-wu-xin-xi"><strong>5. 使用 <code>@ExceptionHandler</code> 返回 JSON/XML 错误信息</strong></h5>
<p><code>@ExceptionHandler</code> 用于处理控制器中的异常，并返回 JSON/XML 格式的错误信息。</p>
<p><strong>示例 1：返回 JSON 错误信息</strong></p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@RestController
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">UserController </span><span>{
</span><span>    @GetMapping(</span><span style="color:#e6db74;">&quot;/user/{id}&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">User </span><span style="color:#a6e22e;">getUser</span><span>(@PathVariable </span><span style="font-style:italic;color:#66d9ef;">int </span><span style="font-style:italic;color:#fd971f;">id</span><span>) {
</span><span>        </span><span style="color:#f92672;">if </span><span>(id </span><span style="color:#f92672;">== </span><span style="color:#ae81ff;">0</span><span>) {
</span><span>            </span><span style="color:#f92672;">throw new </span><span style="font-style:italic;color:#66d9ef;">IllegalArgumentException</span><span>(</span><span style="color:#e6db74;">&quot;Invalid user ID&quot;</span><span>);
</span><span>        }
</span><span>        </span><span style="color:#f92672;">return new </span><span style="font-style:italic;color:#66d9ef;">User</span><span>(id, </span><span style="color:#e6db74;">&quot;John Doe&quot;</span><span>);
</span><span>    }
</span><span>
</span><span>    @ExceptionHandler(</span><span style="font-style:italic;color:#66d9ef;">IllegalArgumentException</span><span>.class)
</span><span>    @ResponseStatus(</span><span style="font-style:italic;color:#66d9ef;">HttpStatus</span><span>.</span><span style="color:#ae81ff;">BAD_REQUEST</span><span>)
</span><span>    @ResponseBody
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">Map</span><span>&lt;</span><span style="font-style:italic;color:#66d9ef;">String</span><span>, </span><span style="font-style:italic;color:#66d9ef;">String</span><span>&gt; </span><span style="color:#a6e22e;">handleIllegalArgumentException</span><span>(</span><span style="font-style:italic;color:#66d9ef;">IllegalArgumentException </span><span style="font-style:italic;color:#fd971f;">ex</span><span>) {
</span><span>        </span><span style="font-style:italic;color:#66d9ef;">Map</span><span>&lt;</span><span style="font-style:italic;color:#66d9ef;">String</span><span>, </span><span style="font-style:italic;color:#66d9ef;">String</span><span>&gt; error </span><span style="color:#f92672;">= new </span><span style="font-style:italic;color:#66d9ef;">HashMap</span><span>&lt;&gt;();
</span><span>        error.put(</span><span style="color:#e6db74;">&quot;error&quot;</span><span>, ex.getMessage());
</span><span>        </span><span style="color:#f92672;">return</span><span> error;
</span><span>    }
</span><span>}
</span></code></pre>
<p><strong>示例 2：返回 XML 错误信息</strong></p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@RestController
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">UserController </span><span>{
</span><span>    @GetMapping(</span><span style="color:#e6db74;">&quot;/user/{id}&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">User </span><span style="color:#a6e22e;">getUser</span><span>(@PathVariable </span><span style="font-style:italic;color:#66d9ef;">int </span><span style="font-style:italic;color:#fd971f;">id</span><span>) {
</span><span>        </span><span style="color:#f92672;">if </span><span>(id </span><span style="color:#f92672;">== </span><span style="color:#ae81ff;">0</span><span>) {
</span><span>            </span><span style="color:#f92672;">throw new </span><span style="font-style:italic;color:#66d9ef;">IllegalArgumentException</span><span>(</span><span style="color:#e6db74;">&quot;Invalid user ID&quot;</span><span>);
</span><span>        }
</span><span>        </span><span style="color:#f92672;">return new </span><span style="font-style:italic;color:#66d9ef;">User</span><span>(id, </span><span style="color:#e6db74;">&quot;John Doe&quot;</span><span>);
</span><span>    }
</span><span>
</span><span>    @ExceptionHandler(</span><span style="font-style:italic;color:#66d9ef;">IllegalArgumentException</span><span>.class)
</span><span>    @ResponseStatus(</span><span style="font-style:italic;color:#66d9ef;">HttpStatus</span><span>.</span><span style="color:#ae81ff;">BAD_REQUEST</span><span>)
</span><span>    @ResponseBody
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">ErrorResponse </span><span style="color:#a6e22e;">handleIllegalArgumentException</span><span>(</span><span style="font-style:italic;color:#66d9ef;">IllegalArgumentException </span><span style="font-style:italic;color:#fd971f;">ex</span><span>) {
</span><span>        </span><span style="color:#f92672;">return new </span><span style="font-style:italic;color:#66d9ef;">ErrorResponse</span><span>(</span><span style="color:#e6db74;">&quot;BAD_REQUEST&quot;</span><span>, ex.getMessage());
</span><span>    }
</span><span>}
</span></code></pre>
<hr />
<h5 id="6-shi-yong-controlleradvice-quan-ju-fan-hui-json-xml-cuo-wu-xin-xi"><strong>6. 使用 <code>@ControllerAdvice</code> 全局返回 JSON/XML 错误信息</strong></h5>
<p><code>@ControllerAdvice</code> 用于全局处理异常，并返回 JSON/XML 格式的错误信息。</p>
<p><strong>示例 1：全局返回 JSON 错误信息</strong></p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@ControllerAdvice
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">GlobalExceptionHandler </span><span>{
</span><span>    @ExceptionHandler(</span><span style="font-style:italic;color:#66d9ef;">Exception</span><span>.class)
</span><span>    @ResponseStatus(</span><span style="font-style:italic;color:#66d9ef;">HttpStatus</span><span>.</span><span style="color:#ae81ff;">INTERNAL_SERVER_ERROR</span><span>)
</span><span>    @ResponseBody
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">Map</span><span>&lt;</span><span style="font-style:italic;color:#66d9ef;">String</span><span>, </span><span style="font-style:italic;color:#66d9ef;">String</span><span>&gt; </span><span style="color:#a6e22e;">handleException</span><span>(</span><span style="font-style:italic;color:#66d9ef;">Exception </span><span style="font-style:italic;color:#fd971f;">ex</span><span>) {
</span><span>        </span><span style="font-style:italic;color:#66d9ef;">Map</span><span>&lt;</span><span style="font-style:italic;color:#66d9ef;">String</span><span>, </span><span style="font-style:italic;color:#66d9ef;">String</span><span>&gt; error </span><span style="color:#f92672;">= new </span><span style="font-style:italic;color:#66d9ef;">HashMap</span><span>&lt;&gt;();
</span><span>        error.put(</span><span style="color:#e6db74;">&quot;error&quot;</span><span>, ex.getMessage());
</span><span>        </span><span style="color:#f92672;">return</span><span> error;
</span><span>    }
</span><span>}
</span></code></pre>
<p><strong>示例 2：全局返回 XML 错误信息</strong></p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@ControllerAdvice
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">GlobalExceptionHandler </span><span>{
</span><span>    @ExceptionHandler(</span><span style="font-style:italic;color:#66d9ef;">Exception</span><span>.class)
</span><span>    @ResponseStatus(</span><span style="font-style:italic;color:#66d9ef;">HttpStatus</span><span>.</span><span style="color:#ae81ff;">INTERNAL_SERVER_ERROR</span><span>)
</span><span>    @ResponseBody
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">ErrorResponse </span><span style="color:#a6e22e;">handleException</span><span>(</span><span style="font-style:italic;color:#66d9ef;">Exception </span><span style="font-style:italic;color:#fd971f;">ex</span><span>) {
</span><span>        </span><span style="color:#f92672;">return new </span><span style="font-style:italic;color:#66d9ef;">ErrorResponse</span><span>(</span><span style="color:#e6db74;">&quot;INTERNAL_SERVER_ERROR&quot;</span><span>, ex.getMessage());
</span><span>    }
</span><span>}
</span></code></pre>
<hr />
<h5 id="zong-jie-1"><strong>总结</strong></h5>
<p>在 Spring MVC 项目中，返回 JSON/XML 数据时，常用的注解和方式包括：</p>
<ol>
<li>
<p><strong><code>@RestController</code></strong>：直接返回数据，适合 RESTful API。</p>
<p>配合**<code>@RequestMapping</code>**：指定 URL 和返回的内容类型。</p>
</li>
<li>
<p><strong><code>@Controller</code> + <code>@ResponseBody</code></strong>：将返回值写入响应体。</p>
</li>
<li>
<p><strong><code>@ResponseStatus</code></strong>：指定 HTTP 状态码。</p>
</li>
<li>
<p><strong><code>ResponseEntity</code></strong>：灵活控制 HTTP 响应的状态码、头部和内容。</p>
</li>
<li>
<p><strong><code>@ExceptionHandler</code></strong>：处理控制器中的异常，返回错误信息。</p>
</li>
<li>
<p><strong><code>@ControllerAdvice</code></strong>：全局处理异常，返回错误信息。</p>
</li>
</ol>
<p>通过这些注解，可以灵活地实现 JSON/XML 数据的返回和异常处理。</p>
<h3 id="6-spring-xiang-mu-vs-spring-boot-xiang-mu-shi-tu-pei-zhi-fang-shi-de-bu-tong"><strong>6. Spring 项目 vs Spring Boot 项目视图配置方式的不同</strong></h3>
<table><thead><tr><th>视图技术</th><th>Spring 项目配置方式</th><th>Spring Boot 项目配置方式</th></tr></thead><tbody>
<tr><td><strong>JSP</strong></td><td>需要手动配置 <code>InternalResourceViewResolver</code></td><td>默认不支持，需手动配置前缀和后缀</td></tr>
<tr><td><strong>Thymeleaf</strong></td><td>需要手动配置 <code>ThymeleafViewResolver</code></td><td>默认支持，自动配置前缀和后缀</td></tr>
<tr><td><strong>FreeMarker</strong></td><td>需要手动配置 <code>FreeMarkerViewResolver</code></td><td>默认支持，自动配置前缀和后缀</td></tr>
<tr><td><strong>Velocity</strong></td><td>需要手动配置 <code>VelocityViewResolver</code></td><td>默认不支持，需手动配置前缀和后缀</td></tr>
</tbody></table>
<hr />
<p>• <strong>Spring 项目</strong>：需要手动配置视图解析器，XML 或 Java 配置均可。
• <strong>Spring Boot 项目</strong>：对于 Thymeleaf 和 FreeMarker，默认支持并自动配置；对于 JSP 和 Velocity，需要手动配置。
• <strong>推荐</strong>：在 Spring Boot 项目中优先使用 Thymeleaf 或 FreeMarker，减少配置工作量。</p>
<h2 id="ba-yi-chang-chu-li"><strong>八、异常处理</strong></h2>
<p>Spring MVC 提供了强大的异常处理机制，允许开发者集中处理应用程序中的异常，从而避免在控制器中重复编写异常处理代码。通过统一的异常处理机制，可以提高代码的可维护性和可读性。</p>
<h3 id="1-spring-mvc-yi-chang-chu-li-ji-zhi"><strong>1. Spring MVC 异常处理机制</strong></h3>
<p>Spring MVC 的异常处理机制提供了多种方式来处理应用程序中的异常，包括局部异常处理、全局异常处理、自定义异常解析器等。通过合理使用这些机制，可以实现统一的异常处理逻辑，提高代码的可维护性和可读性。</p>
<p>Spring MVC 提供了以下几种方式来处理异常：</p>
<ol>
<li>
<p><strong><code>@ExceptionHandler</code> 注解</strong>：
• 在控制器内部定义异常处理方法，用于处理该控制器中抛出的特定异常。
• 只能处理当前控制器中的异常。</p>
</li>
<li>
<p><strong><code>@ControllerAdvice</code> 注解</strong>：
• 定义一个全局的异常处理类，用于处理整个应用程序中的异常。
• 可以结合 <code>@ExceptionHandler</code> 注解实现全局异常处理。</p>
</li>
<li>
<p><strong><code>HandlerExceptionResolver</code> 接口</strong>：
• 实现自定义的异常解析器，用于处理特定类型的异常。
• 提供了更底层的控制，适合复杂的异常处理场景。</p>
</li>
<li>
<p><strong><code>@ResponseStatus</code> 注解</strong>：
• 将特定异常映射到 HTTP 状态码，直接返回给客户端。</p>
</li>
<li>
<p><strong>默认异常处理</strong>：
• 如果没有显式处理异常，Spring MVC 会使用默认的异常处理机制，返回 500 错误。</p>
</li>
</ol>
<hr />
<h3 id="2-yi-chang-chu-li-de-fang-shi"><strong>2. 异常处理的方式</strong></h3>
<h4 id="1-shi-yong-exceptionhandler-chu-li-ju-bu-yi-chang"><strong>1. 使用 <code>@ExceptionHandler</code> 处理局部异常</strong></h4>
<p>在控制器中定义异常处理方法，处理该控制器中抛出的异常。</p>
<p><strong>示例代码：</strong></p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@RestController
</span><span>@RequestMapping(</span><span style="color:#e6db74;">&quot;/users&quot;</span><span>)
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">UserController </span><span>{
</span><span>
</span><span>    @GetMapping(</span><span style="color:#e6db74;">&quot;/{id}&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">User </span><span style="color:#a6e22e;">getUser</span><span>(@PathVariable </span><span style="font-style:italic;color:#66d9ef;">Long </span><span style="font-style:italic;color:#fd971f;">id</span><span>) {
</span><span>        </span><span style="color:#f92672;">if </span><span>(id </span><span style="color:#f92672;">== </span><span style="color:#ae81ff;">0</span><span>) {
</span><span>            </span><span style="color:#f92672;">throw new </span><span style="font-style:italic;color:#66d9ef;">IllegalArgumentException</span><span>(</span><span style="color:#e6db74;">&quot;Invalid user ID&quot;</span><span>);
</span><span>        }
</span><span>        </span><span style="color:#f92672;">return new </span><span style="font-style:italic;color:#66d9ef;">User</span><span>(id, </span><span style="color:#e6db74;">&quot;John Doe&quot;</span><span>);
</span><span>    }
</span><span>
</span><span>    @ExceptionHandler(</span><span style="font-style:italic;color:#66d9ef;">IllegalArgumentException</span><span>.class)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">ResponseEntity</span><span>&lt;</span><span style="font-style:italic;color:#66d9ef;">String</span><span>&gt; </span><span style="color:#a6e22e;">handleIllegalArgumentException</span><span>(</span><span style="font-style:italic;color:#66d9ef;">IllegalArgumentException </span><span style="font-style:italic;color:#fd971f;">ex</span><span>) {
</span><span>        </span><span style="color:#f92672;">return </span><span style="font-style:italic;color:#66d9ef;">ResponseEntity</span><span>.badRequest().body(ex.getMessage());
</span><span>    }
</span><span>}
</span></code></pre>
<h5 id="te-dian"><strong>特点：</strong></h5>
<p>• 只能处理当前控制器中的异常。
• 方法可以返回 <code>ResponseEntity</code>、<code>ModelAndView</code> 或其他类型。</p>
<hr />
<h4 id="2-shi-yong-controlleradvice-chu-li-quan-ju-yi-chang"><strong>2. 使用 <code>@ControllerAdvice</code> 处理全局异常</strong></h4>
<p>定义一个全局异常处理类，处理整个应用程序中的异常。</p>
<p><strong>示例代码：</strong></p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@ControllerAdvice
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">GlobalExceptionHandler </span><span>{
</span><span>
</span><span>    @ExceptionHandler(</span><span style="font-style:italic;color:#66d9ef;">IllegalArgumentException</span><span>.class)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">ResponseEntity</span><span>&lt;</span><span style="font-style:italic;color:#66d9ef;">String</span><span>&gt; </span><span style="color:#a6e22e;">handleIllegalArgumentException</span><span>(</span><span style="font-style:italic;color:#66d9ef;">IllegalArgumentException </span><span style="font-style:italic;color:#fd971f;">ex</span><span>) {
</span><span>        </span><span style="color:#f92672;">return </span><span style="font-style:italic;color:#66d9ef;">ResponseEntity</span><span>.badRequest().body(</span><span style="color:#e6db74;">&quot;Bad Request: &quot; </span><span style="color:#f92672;">+</span><span> ex.getMessage());
</span><span>    }
</span><span>
</span><span>    @ExceptionHandler(</span><span style="font-style:italic;color:#66d9ef;">Exception</span><span>.class)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">ResponseEntity</span><span>&lt;</span><span style="font-style:italic;color:#66d9ef;">String</span><span>&gt; </span><span style="color:#a6e22e;">handleGenericException</span><span>(</span><span style="font-style:italic;color:#66d9ef;">Exception </span><span style="font-style:italic;color:#fd971f;">ex</span><span>) {
</span><span>        </span><span style="color:#f92672;">return </span><span style="font-style:italic;color:#66d9ef;">ResponseEntity</span><span>.status(</span><span style="font-style:italic;color:#66d9ef;">HttpStatus</span><span>.</span><span style="color:#ae81ff;">INTERNAL_SERVER_ERROR</span><span>).body(</span><span style="color:#e6db74;">&quot;Internal Server Error: &quot; </span><span style="color:#f92672;">+</span><span> ex.getMessage());
</span><span>    }
</span><span>}
</span></code></pre>
<p><strong>特点：</strong></p>
<p>• 可以处理所有控制器中的异常。
• 支持多个 <code>@ExceptionHandler</code> 方法，分别处理不同类型的异常。</p>
<hr />
<h4 id="3-shi-yong-handlerexceptionresolver-shi-xian-zi-ding-yi-yi-chang-jie-xi-qi"><strong>3. 使用 <code>HandlerExceptionResolver</code> 实现自定义异常解析器</strong></h4>
<p>通过实现 <code>HandlerExceptionResolver</code> 接口，自定义异常处理逻辑。</p>
<p><strong>示例代码：</strong></p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Component
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">CustomExceptionResolver </span><span style="color:#f92672;">implements </span><span style="text-decoration:underline;font-style:italic;color:#a6e22e;">HandlerExceptionResolver </span><span>{
</span><span>
</span><span>    @Override
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">ModelAndView </span><span style="color:#a6e22e;">resolveException</span><span>(</span><span style="font-style:italic;color:#66d9ef;">HttpServletRequest </span><span style="font-style:italic;color:#fd971f;">request</span><span>, </span><span style="font-style:italic;color:#66d9ef;">HttpServletResponse </span><span style="font-style:italic;color:#fd971f;">response</span><span>, </span><span style="font-style:italic;color:#66d9ef;">Object </span><span style="font-style:italic;color:#fd971f;">handler</span><span>, </span><span style="font-style:italic;color:#66d9ef;">Exception </span><span style="font-style:italic;color:#fd971f;">ex</span><span>) {
</span><span>        </span><span style="color:#f92672;">if </span><span>(ex </span><span style="color:#f92672;">instanceof </span><span style="font-style:italic;color:#66d9ef;">IllegalArgumentException</span><span>) {
</span><span>            </span><span style="font-style:italic;color:#66d9ef;">ModelAndView</span><span> modelAndView </span><span style="color:#f92672;">= new </span><span style="font-style:italic;color:#66d9ef;">ModelAndView</span><span>();
</span><span>            modelAndView.setStatus(</span><span style="font-style:italic;color:#66d9ef;">HttpStatus</span><span>.</span><span style="color:#ae81ff;">BAD_REQUEST</span><span>);
</span><span>            modelAndView.addObject(</span><span style="color:#e6db74;">&quot;error&quot;</span><span>, ex.getMessage());
</span><span>            modelAndView.setViewName(</span><span style="color:#e6db74;">&quot;error/badRequest&quot;</span><span>);
</span><span>            </span><span style="color:#f92672;">return</span><span> modelAndView;
</span><span>        }
</span><span>        </span><span style="color:#f92672;">return </span><span style="color:#ae81ff;">null</span><span>; </span><span style="color:#75715e;">// 返回 null 表示由其他解析器处理
</span><span>    }
</span><span>}
</span></code></pre>
<p><strong>特点：</strong></p>
<p>• 提供了更底层的控制，适合复杂的异常处理场景。
• 可以返回 <code>ModelAndView</code> 或直接修改 <code>HttpServletResponse</code>。</p>
<hr />
<h4 id="4-shi-yong-responsestatus-zhu-jie-ying-she-yi-chang-dao-http-zhuang-tai-ma"><strong>4. 使用 <code>@ResponseStatus</code> 注解映射异常到 HTTP 状态码</strong></h4>
<p>将特定异常映射到 HTTP 状态码，直接返回给客户端。</p>
<p><strong>示例代码：</strong></p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@ResponseStatus(</span><span style="font-style:italic;color:#fd971f;">value </span><span style="color:#f92672;">= </span><span style="font-style:italic;color:#66d9ef;">HttpStatus</span><span>.</span><span style="color:#ae81ff;">NOT_FOUND</span><span>, </span><span style="font-style:italic;color:#fd971f;">reason </span><span style="color:#f92672;">= </span><span style="color:#e6db74;">&quot;User not found&quot;</span><span>)
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">UserNotFoundException </span><span style="color:#f92672;">extends </span><span style="text-decoration:underline;font-style:italic;color:#a6e22e;">RuntimeException </span><span>{
</span><span>    </span><span style="color:#f92672;">public </span><span style="color:#a6e22e;">UserNotFoundException</span><span>(</span><span style="font-style:italic;color:#66d9ef;">String </span><span style="font-style:italic;color:#fd971f;">message</span><span>) {
</span><span>        super(message);
</span><span>    }
</span><span>}
</span></code></pre>
<p><strong>特点：</strong></p>
<p>• 异常抛出时，Spring MVC 会自动返回指定的 HTTP 状态码和原因。
• 适合简单的异常处理场景。</p>
<hr />
<h4 id="5-mo-ren-yi-chang-chu-li"><strong>5. 默认异常处理</strong></h4>
<p>如果没有显式处理异常，Spring MVC 会使用默认的异常处理机制，返回 500 错误。</p>
<h3 id="3-fan-hui-yi-chang-shu-ju-or-yi-chang-ye-mian">3. 返回异常数据 or 异常页面？</h3>
<h4 id="fan-hui-json-xml-yi-chang-shu-ju"><strong>返回 JSON/XML 异常数据</strong></h4>
<h5 id="gua-yong-chang-jing"><strong>适用场景</strong></h5>
<p>• <strong>RESTful API 项目</strong>：
• 前后端分离架构，前端通过 API 与后端交互。
• 后端通常返回 JSON/XML 格式的数据，而不是 HTML 页面。
• <strong>微服务架构</strong>：
• 服务之间通过 API 通信，通常使用 JSON/XML 作为数据格式。
• <strong>移动端或第三方集成</strong>：
• 移动端应用或第三方系统通常需要 JSON/XML 格式的错误信息。</p>
<h5 id="shi-xian-fang-shi"><strong>实现方式</strong></h5>
<p>• 使用 <code>@RestController</code> 或 <code>@Controller</code> + <code>@ResponseBody</code> 返回 JSON/XML 数据。
• 使用 <code>@ExceptionHandler</code> 或 <code>@ControllerAdvice</code> 捕获异常并返回 JSON/XML 格式的错误信息。</p>
<p><strong>示例：返回 JSON 错误信息</strong></p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@RestControllerAdvice
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">GlobalExceptionHandler </span><span>{
</span><span>    @ExceptionHandler(</span><span style="font-style:italic;color:#66d9ef;">Exception</span><span>.class)
</span><span>    @ResponseStatus(</span><span style="font-style:italic;color:#66d9ef;">HttpStatus</span><span>.</span><span style="color:#ae81ff;">INTERNAL_SERVER_ERROR</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">Map</span><span>&lt;</span><span style="font-style:italic;color:#66d9ef;">String</span><span>, </span><span style="font-style:italic;color:#66d9ef;">String</span><span>&gt; </span><span style="color:#a6e22e;">handleException</span><span>(</span><span style="font-style:italic;color:#66d9ef;">Exception </span><span style="font-style:italic;color:#fd971f;">ex</span><span>) {
</span><span>        </span><span style="font-style:italic;color:#66d9ef;">Map</span><span>&lt;</span><span style="font-style:italic;color:#66d9ef;">String</span><span>, </span><span style="font-style:italic;color:#66d9ef;">String</span><span>&gt; error </span><span style="color:#f92672;">= new </span><span style="font-style:italic;color:#66d9ef;">HashMap</span><span>&lt;&gt;();
</span><span>        error.put(</span><span style="color:#e6db74;">&quot;error&quot;</span><span>, ex.getMessage());
</span><span>        </span><span style="color:#f92672;">return</span><span> error;
</span><span>    }
</span><span>}
</span></code></pre>
<p><strong>示例：返回 XML 错误信息</strong></p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@RestControllerAdvice
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">GlobalExceptionHandler </span><span>{
</span><span>    @ExceptionHandler(</span><span style="font-style:italic;color:#66d9ef;">Exception</span><span>.class)
</span><span>    @ResponseStatus(</span><span style="font-style:italic;color:#66d9ef;">HttpStatus</span><span>.</span><span style="color:#ae81ff;">INTERNAL_SERVER_ERROR</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">ErrorResponse </span><span style="color:#a6e22e;">handleException</span><span>(</span><span style="font-style:italic;color:#66d9ef;">Exception </span><span style="font-style:italic;color:#fd971f;">ex</span><span>) {
</span><span>        </span><span style="color:#f92672;">return new </span><span style="font-style:italic;color:#66d9ef;">ErrorResponse</span><span>(</span><span style="color:#e6db74;">&quot;INTERNAL_SERVER_ERROR&quot;</span><span>, ex.getMessage());
</span><span>    }
</span><span>}
</span></code></pre>
<hr />
<h4 id="fan-hui-ju-ti-cuo-wu-ye-mian-shi-tu"><strong>返回具体错误页面视图</strong></h4>
<h5 id="gua-yong-chang-jing-1"><strong>适用场景</strong></h5>
<p>• <strong>传统 Web 应用</strong>：
• 前后端未分离，后端直接渲染 HTML 页面。
• 用户通过浏览器访问，需要友好的错误页面。
• <strong>需要定制化错误页面</strong>：
• 例如 404、500 等错误页面，提供更好的用户体验。
• <strong>SEO 优化</strong>：
• 对于搜索引擎优化（SEO），返回 HTML 页面更友好。</p>
<h5 id="shi-xian-fang-shi-1"><strong>实现方式</strong></h5>
<p>• 使用 <code>@Controller</code> 返回视图名称，渲染具体的错误页面。
• 使用 <code>@ExceptionHandler</code> 捕获异常并返回视图名称。
• 配置 <code>ErrorController</code> 或自定义错误页面。</p>
<p><strong>示例：返回错误页面视图</strong></p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Controller
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">ErrorController </span><span>{
</span><span>    @ExceptionHandler(</span><span style="font-style:italic;color:#66d9ef;">Exception</span><span>.class)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="color:#a6e22e;">handleException</span><span>(</span><span style="font-style:italic;color:#66d9ef;">Exception </span><span style="font-style:italic;color:#fd971f;">ex</span><span>, </span><span style="font-style:italic;color:#66d9ef;">Model </span><span style="font-style:italic;color:#fd971f;">model</span><span>) {
</span><span>        model.addAttribute(</span><span style="color:#e6db74;">&quot;error&quot;</span><span>, ex.getMessage());
</span><span>        </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;errorPage&quot;</span><span>; </span><span style="color:#75715e;">// 返回视图名称
</span><span>    }
</span><span>}
</span></code></pre>
<p><strong>示例：配置自定义错误页面</strong></p>
<p>在 <code>src/main/resources/templates/</code> 目录下创建错误页面：
• <code>404.html</code>：404 错误页面。
• <code>500.html</code>：500 错误页面。</p>
<p>在 <code>application.properties</code> 中配置：</p>
<pre data-lang="properties" style="background-color:#272822;color:#f8f8f2;" class="language-properties "><code class="language-properties" data-lang="properties"><span>spring.mvc.throw-exception-if-no-handler-found=</span><span style="color:#e6db74;">true
</span><span>spring.resources.add-mappings=</span><span style="color:#e6db74;">false
</span></code></pre>
<hr />
<h4 id="jie-lun"><strong>结论</strong></h4>
<p><strong>Spring Boot 项目：更倾向于返回 JSON/XML 数据</strong>：
• Spring Boot 通常用于构建 RESTful API 或微服务，前后端分离是主流架构。
• 异常处理时，返回 JSON/XML 格式的错误信息更符合 API 的设计规范。
• Spring Boot 默认支持 JSON 序列化（通过 Jackson），配置简单。</p>
<p><strong>Spring 项目：视项目需求而定</strong>：
• 如果是传统 Web 应用，可能更倾向于返回错误页面视图。
• 如果是 RESTful API 或微服务，则返回 JSON/XML 数据。</p>
<table><thead><tr><th>场景</th><th>返回 JSON/XML 数据</th><th>返回具体错误页面视图</th></tr></thead><tbody>
<tr><td><strong>适用场景</strong></td><td>RESTful API、微服务、移动端、第三方集成</td><td>传统 Web 应用、SEO 优化、定制化错误页面</td></tr>
<tr><td><strong>实现方式</strong></td><td><code>@RestController</code>、<code>@ExceptionHandler</code></td><td><code>@Controller</code>、<code>ErrorController</code></td></tr>
<tr><td><strong>Spring Boot 项目</strong></td><td>更常见，默认支持 JSON</td><td>较少见，需手动配置</td></tr>
<tr><td><strong>Spring 项目</strong></td><td>视项目需求而定</td><td>视项目需求而定</td></tr>
</tbody></table>
<p><strong>推荐</strong></p>
<p>• <strong>RESTful API 或微服务</strong>：优先返回 JSON/XML 数据。
• <strong>传统 Web 应用</strong>：优先返回具体的错误页面视图。</p>
<p>根据项目架构和需求，选择合适的异常处理方式，既能提高开发效率，也能提升用户体验。</p>
<h3 id="3-shi-xian-yi-chang-chu-li-de-yao-qiu"><strong>3. 实现异常处理的要求</strong></h3>
<ol>
<li><strong>异常处理方法的签名</strong>：
• 方法可以包含 <code>Exception</code> 参数，用于捕获异常。
• 方法可以返回 <code>ResponseEntity</code>、<code>ModelAndView</code>、<code>String</code>（视图名称）或其他类型。</li>
<li><strong>异常处理的优先级</strong>：
• <code>@ExceptionHandler</code>（控制器内部） &gt; <code>@ControllerAdvice</code>（全局） &gt; <code>HandlerExceptionResolver</code> &gt; 默认异常处理。</li>
<li><strong>异常处理的范围</strong>：
• 使用 <code>@ControllerAdvice</code> 可以集中处理整个应用程序的异常，避免代码重复。</li>
<li><strong>异常处理的粒度</strong>：
• 可以根据业务需求定义不同的异常处理方法，处理特定类型的异常。</li>
<li><strong>异常信息的传递</strong>：
• 可以通过 <code>ResponseEntity</code> 或 <code>ModelAndView</code> 将异常信息返回给客户端。</li>
<li><strong>日志记录</strong>：
• 在异常处理方法中记录日志，便于排查问题。</li>
</ol>
<h2 id="jiu-ce-shi-zhi-chi"><strong>九、测试支持</strong></h2>
<p>• <strong>Spring MVC Test</strong>: 提供了对Spring MVC应用程序的测试支持，可以模拟HTTP请求并验证响应。
• <strong>MockMvc</strong>: 用于在单元测试中模拟Spring MVC的行为。</p>
<hr />
<p><code>Spring MVC Test</code> 是 Spring 提供的一个强大的测试框架，专门用于测试 Spring MVC 控制器（Controller）。它允许开发者在不启动完整 Spring 上下文的情况下，模拟 HTTP 请求并验证控制器的行为。通过 <code>MockMvc</code>，开发者可以轻松编写单元测试和集成测试，确保控制器的逻辑正确无误。无论是简单的 GET 请求，还是复杂的文件上传和异常处理，<code>Spring MVC Test</code> 都提供了丰富的功能支持。</p>
<hr />
<h3 id="1-spring-mvc-test-de-he-xin-zu-jian"><strong>1. Spring MVC Test 的核心组件</strong></h3>
<h4 id="1-1-mockmvc"><strong>1.1 <code>MockMvc</code></strong></h4>
<p>• <strong>作用</strong>: 模拟 HTTP 请求并验证响应。
• <strong>特点</strong>:
• 支持 GET、POST、PUT、DELETE 等 HTTP 方法。
• 支持验证响应状态码、响应内容、响应头等。
• 支持模拟文件上传、表单提交等复杂请求。</p>
<p>MockMvc 可单独使用，以执行请求并使用 Hamcrest 或通过 MockMvcTester 验证响应，后者使用 AssertJ 提供了流畅的 API。它还可以通过 WebTestClient 使用，在 WebTestClient 中，MockMvc 被插入为服务器来处理请求。使用 WebTestClient 的优势在于，它为您提供了处理更高级对象（而非原始数据）的选项，还能针对实时服务器切换到完整的端到端 HTTP 测试，并使用相同的测试 API。</p>
<h4 id="1-2-mockmvcbuilders"><strong>1.2 <code>MockMvcBuilders</code></strong></h4>
<p>• <strong>作用</strong>: 用于创建 <code>MockMvc</code> 实例。
• <strong>两种模式</strong>:
• <strong>独立模式（Standalone）</strong>: 仅加载指定的控制器，不加载完整的 Spring 上下文。
• <strong>Web 应用模式（WebApp）</strong>: 加载完整的 Spring 上下文，包括控制器、服务、DAO 等。</p>
<h4 id="1-3-requestbuilder-he-resultmatcher"><strong>1.3 <code>RequestBuilder</code> 和 <code>ResultMatcher</code></strong></h4>
<p>• <strong><code>RequestBuilder</code></strong>: 用于构建 HTTP 请求（如 <code>MockMvcRequestBuilders.get()</code>）。
• <strong><code>ResultMatcher</code></strong>: 用于验证 HTTP 响应（如 <code>MockMvcResultMatchers.status().isOk()</code>）。</p>
<hr />
<h3 id="2-spring-mvc-test-de-chang-jian-yong-fa"><strong>2. Spring MVC Test 的常见用法</strong></h3>
<h4 id="2-1-ce-shi-get-qing-qiu"><strong>2.1 测试 GET 请求</strong></h4>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Test
</span><span style="color:#f92672;">public</span><span> void testGetUser() throws </span><span style="font-style:italic;color:#66d9ef;">Exception </span><span>{
</span><span>    mockMvc.perform(get(</span><span style="color:#e6db74;">&quot;/user&quot;</span><span>).param(</span><span style="color:#e6db74;">&quot;id&quot;</span><span>, </span><span style="color:#e6db74;">&quot;1&quot;</span><span>))
</span><span>           .andExpect(status().isOk())
</span><span>           .andExpect(content().string(</span><span style="color:#e6db74;">&quot;User ID: 1&quot;</span><span>));
</span><span>}
</span></code></pre>
<h4 id="2-2-ce-shi-post-qing-qiu"><strong>2.2 测试 POST 请求</strong></h4>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Test
</span><span style="color:#f92672;">public</span><span> void testCreateUser() throws </span><span style="font-style:italic;color:#66d9ef;">Exception </span><span>{
</span><span>    mockMvc.perform(post(</span><span style="color:#e6db74;">&quot;/user&quot;</span><span>)
</span><span>            .contentType(</span><span style="font-style:italic;color:#66d9ef;">MediaType</span><span>.</span><span style="color:#ae81ff;">APPLICATION_JSON</span><span>)
</span><span>            .content(</span><span style="color:#e6db74;">&quot;{</span><span style="color:#ae81ff;">\&quot;</span><span style="color:#e6db74;">name</span><span style="color:#ae81ff;">\&quot;</span><span style="color:#e6db74;">: </span><span style="color:#ae81ff;">\&quot;</span><span style="color:#e6db74;">John</span><span style="color:#ae81ff;">\&quot;</span><span style="color:#e6db74;">, </span><span style="color:#ae81ff;">\&quot;</span><span style="color:#e6db74;">age</span><span style="color:#ae81ff;">\&quot;</span><span style="color:#e6db74;">: 30}&quot;</span><span>))
</span><span>           .andExpect(status().isCreated());
</span><span>}
</span></code></pre>
<h4 id="2-3-ce-shi-json-xiang-ying"><strong>2.3 测试 JSON 响应</strong></h4>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Test
</span><span style="color:#f92672;">public</span><span> void testGetUserJson() throws </span><span style="font-style:italic;color:#66d9ef;">Exception </span><span>{
</span><span>    mockMvc.perform(get(</span><span style="color:#e6db74;">&quot;/user/json&quot;</span><span>).param(</span><span style="color:#e6db74;">&quot;id&quot;</span><span>, </span><span style="color:#e6db74;">&quot;1&quot;</span><span>))
</span><span>           .andExpect(status().isOk())
</span><span>           .andExpect(jsonPath(</span><span style="color:#e6db74;">&quot;$.id&quot;</span><span>).value(</span><span style="color:#ae81ff;">1</span><span>))
</span><span>           .andExpect(jsonPath(</span><span style="color:#e6db74;">&quot;$.name&quot;</span><span>).value(</span><span style="color:#e6db74;">&quot;John&quot;</span><span>));
</span><span>}
</span></code></pre>
<h4 id="2-4-ce-shi-shi-tu-he-mo-xing"><strong>2.4 测试视图和模型</strong></h4>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Test
</span><span style="color:#f92672;">public</span><span> void testGetUserView() throws </span><span style="font-style:italic;color:#66d9ef;">Exception </span><span>{
</span><span>    mockMvc.perform(get(</span><span style="color:#e6db74;">&quot;/user/view&quot;</span><span>).param(</span><span style="color:#e6db74;">&quot;id&quot;</span><span>, </span><span style="color:#e6db74;">&quot;1&quot;</span><span>))
</span><span>           .andExpect(status().isOk())
</span><span>           .andExpect(view().name(</span><span style="color:#e6db74;">&quot;user&quot;</span><span>))
</span><span>           .andExpect(model().attribute(</span><span style="color:#e6db74;">&quot;id&quot;</span><span>, </span><span style="color:#ae81ff;">1</span><span>));
</span><span>}
</span></code></pre>
<h4 id="2-5-ce-shi-wen-jian-shang-chuan"><strong>2.5 测试文件上传</strong></h4>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Test
</span><span style="color:#f92672;">public</span><span> void testUploadFile() throws </span><span style="font-style:italic;color:#66d9ef;">Exception </span><span>{
</span><span>    </span><span style="font-style:italic;color:#66d9ef;">MockMultipartFile</span><span> file </span><span style="color:#f92672;">= new </span><span style="font-style:italic;color:#66d9ef;">MockMultipartFile</span><span>(</span><span style="color:#e6db74;">&quot;file&quot;</span><span>, </span><span style="color:#e6db74;">&quot;test.txt&quot;</span><span>, </span><span style="color:#e6db74;">&quot;text/plain&quot;</span><span>, </span><span style="color:#e6db74;">&quot;Hello World&quot;</span><span>.getBytes());
</span><span>    mockMvc.perform(multipart(</span><span style="color:#e6db74;">&quot;/upload&quot;</span><span>).file(file))
</span><span>           .andExpect(status().isOk())
</span><span>           .andExpect(content().string(</span><span style="color:#e6db74;">&quot;File uploaded successfully&quot;</span><span>));
</span><span>}
</span></code></pre>
<h4 id="2-6-ce-shi-yi-chang-chu-li"><strong>2.6 测试异常处理</strong></h4>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Test
</span><span style="color:#f92672;">public</span><span> void testGetUserNotFound() throws </span><span style="font-style:italic;color:#66d9ef;">Exception </span><span>{
</span><span>    mockMvc.perform(get(</span><span style="color:#e6db74;">&quot;/user&quot;</span><span>).param(</span><span style="color:#e6db74;">&quot;id&quot;</span><span>, </span><span style="color:#e6db74;">&quot;999&quot;</span><span>))
</span><span>           .andExpect(status().isNotFound())
</span><span>           .andExpect(content().string(</span><span style="color:#e6db74;">&quot;User not found&quot;</span><span>));
</span><span>}
</span></code></pre>
<hr />
<h3 id="3-spring-mvc-test-de-gao-ji-yong-fa"><strong>3. Spring MVC Test 的高级用法</strong></h3>
<h4 id="3-1-zi-ding-yi-qing-qiu-tou"><strong>3.1 自定义请求头</strong></h4>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Test
</span><span style="color:#f92672;">public</span><span> void testGetUserWithHeader() throws </span><span style="font-style:italic;color:#66d9ef;">Exception </span><span>{
</span><span>    mockMvc.perform(get(</span><span style="color:#e6db74;">&quot;/user&quot;</span><span>).header(</span><span style="color:#e6db74;">&quot;Authorization&quot;</span><span>, </span><span style="color:#e6db74;">&quot;Bearer token&quot;</span><span>))
</span><span>           .andExpect(status().isOk());
</span><span>}
</span></code></pre>
<h4 id="3-2-mo-ni-hui-hua-session"><strong>3.2 模拟会话（Session）</strong></h4>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Test
</span><span style="color:#f92672;">public</span><span> void testGetUserWithSession() throws </span><span style="font-style:italic;color:#66d9ef;">Exception </span><span>{
</span><span>    mockMvc.perform(get(</span><span style="color:#e6db74;">&quot;/user&quot;</span><span>).sessionAttr(</span><span style="color:#e6db74;">&quot;userId&quot;</span><span>, </span><span style="color:#ae81ff;">1</span><span>))
</span><span>           .andExpect(status().isOk());
</span><span>}
</span></code></pre>
<h4 id="3-3-yan-zheng-xiang-ying-tou"><strong>3.3 验证响应头</strong></h4>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Test
</span><span style="color:#f92672;">public</span><span> void testGetUserWithResponseHeader() throws </span><span style="font-style:italic;color:#66d9ef;">Exception </span><span>{
</span><span>    mockMvc.perform(get(</span><span style="color:#e6db74;">&quot;/user&quot;</span><span>))
</span><span>           .andExpect(status().isOk())
</span><span>           .andExpect(header().string(</span><span style="color:#e6db74;">&quot;Content-Type&quot;</span><span>, </span><span style="color:#e6db74;">&quot;application/json&quot;</span><span>));
</span><span>}
</span></code></pre>
<h4 id="3-4-shi-yong-mockbean-mo-ni-yi-lai"><strong>3.4 使用 <code>@MockBean</code> 模拟依赖</strong></h4>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@MockBean
</span><span style="color:#f92672;">private </span><span style="font-style:italic;color:#66d9ef;">UserService</span><span> userService;
</span><span>
</span><span>@Test
</span><span style="color:#f92672;">public</span><span> void testGetUserWithMockService() throws </span><span style="font-style:italic;color:#66d9ef;">Exception </span><span>{
</span><span>    when(userService.getUserById(</span><span style="color:#ae81ff;">1</span><span>)).thenReturn(</span><span style="color:#f92672;">new </span><span style="font-style:italic;color:#66d9ef;">User</span><span>(</span><span style="color:#ae81ff;">1</span><span>, </span><span style="color:#e6db74;">&quot;John&quot;</span><span>));
</span><span>
</span><span>    mockMvc.perform(get(</span><span style="color:#e6db74;">&quot;/user&quot;</span><span>).param(</span><span style="color:#e6db74;">&quot;id&quot;</span><span>, </span><span style="color:#e6db74;">&quot;1&quot;</span><span>))
</span><span>           .andExpect(status().isOk())
</span><span>           .andExpect(content().string(</span><span style="color:#e6db74;">&quot;User ID: 1&quot;</span><span>));
</span><span>}
</span></code></pre>
<hr />
<h3 id="4-spring-mvc-test-de-liang-chong-mo-shi"><strong>4. Spring MVC Test 的两种模式</strong></h3>
<h4 id="4-1-du-li-mo-shi-standalone"><strong>4.1 独立模式（Standalone）</strong></h4>
<p>仅加载指定的控制器，适合单元测试。</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">UserControllerTest </span><span>{
</span><span>
</span><span>    </span><span style="color:#f92672;">private </span><span style="font-style:italic;color:#66d9ef;">MockMvc </span><span>mockMvc;
</span><span>
</span><span>    @Before
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">void </span><span style="color:#a6e22e;">setup</span><span>() {
</span><span>        mockMvc </span><span style="color:#f92672;">= </span><span style="font-style:italic;color:#66d9ef;">MockMvcBuilders</span><span>.standaloneSetup(</span><span style="color:#f92672;">new </span><span style="font-style:italic;color:#66d9ef;">UserController</span><span>()).build();
</span><span>    }
</span><span>
</span><span>    @Test
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">void </span><span style="color:#a6e22e;">testGetUser</span><span>() </span><span style="color:#f92672;">throws </span><span style="font-style:italic;color:#66d9ef;">Exception </span><span>{
</span><span>        mockMvc.perform(get(</span><span style="color:#e6db74;">&quot;/user&quot;</span><span>).param(</span><span style="color:#e6db74;">&quot;id&quot;</span><span>, </span><span style="color:#e6db74;">&quot;1&quot;</span><span>))
</span><span>               .andExpect(status().isOk())
</span><span>               .andExpect(content().string(</span><span style="color:#e6db74;">&quot;User ID: 1&quot;</span><span>));
</span><span>    }
</span><span>}
</span></code></pre>
<h4 id="4-2-web-ying-yong-mo-shi-webapp"><strong>4.2 Web 应用模式（WebApp）</strong></h4>
<p>加载完整的 Spring 上下文，适合集成测试。</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@RunWith(</span><span style="font-style:italic;color:#66d9ef;">SpringJUnit4ClassRunner</span><span>.class)
</span><span>@ContextConfiguration(</span><span style="font-style:italic;color:#fd971f;">classes </span><span style="color:#f92672;">= </span><span>{</span><span style="font-style:italic;color:#66d9ef;">AppConfig</span><span>.class})
</span><span>@WebAppConfiguration
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">UserControllerTest </span><span>{
</span><span>
</span><span>    @Autowired
</span><span>    </span><span style="color:#f92672;">private </span><span style="font-style:italic;color:#66d9ef;">WebApplicationContext </span><span>context;
</span><span>
</span><span>    </span><span style="color:#f92672;">private </span><span style="font-style:italic;color:#66d9ef;">MockMvc </span><span>mockMvc;
</span><span>
</span><span>    @Before
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">void </span><span style="color:#a6e22e;">setup</span><span>() {
</span><span>        mockMvc </span><span style="color:#f92672;">= </span><span style="font-style:italic;color:#66d9ef;">MockMvcBuilders</span><span>.webAppContextSetup(context).build();
</span><span>    }
</span><span>
</span><span>    @Test
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">void </span><span style="color:#a6e22e;">testGetUser</span><span>() </span><span style="color:#f92672;">throws </span><span style="font-style:italic;color:#66d9ef;">Exception </span><span>{
</span><span>        mockMvc.perform(get(</span><span style="color:#e6db74;">&quot;/user&quot;</span><span>).param(</span><span style="color:#e6db74;">&quot;id&quot;</span><span>, </span><span style="color:#e6db74;">&quot;1&quot;</span><span>))
</span><span>               .andExpect(status().isOk())
</span><span>               .andExpect(content().string(</span><span style="color:#e6db74;">&quot;User ID: 1&quot;</span><span>));
</span><span>    }
</span><span>}
</span></code></pre>
<hr />
<h3 id="5-spring-mvc-test-de-zui-jia-shi-jian"><strong>5. Spring MVC Test 的最佳实践</strong></h3>
<ol>
<li><strong>优先使用独立模式</strong>:
• 独立模式运行更快，适合单元测试。</li>
<li><strong>合理使用 Web 应用模式</strong>:
• Web 应用模式适合测试控制器的完整行为，包括依赖注入、拦截器等。</li>
<li><strong>模拟依赖</strong>:
• 使用 <code>@MockBean</code> 模拟服务层或 DAO 层的依赖。</li>
<li><strong>验证全面的响应</strong>:
• 不仅验证状态码，还要验证响应内容、响应头等。</li>
<li><strong>保持测试简洁</strong>:
• 每个测试方法只测试一个功能点，避免过于复杂的验证逻辑。</li>
</ol>
<hr />
<h3 id="6-spring-test-mvcying-yong-wan-zheng-shi-li">6. Spring Test MVC应用完整示例</h3>
<h4 id="1-tian-jia-yi-lai"><strong>1. 添加依赖</strong></h4>
<p>在 <code>pom.xml</code> 中添加 <code>spring-test</code> 和 <code>junit</code> 依赖：</p>
<pre data-lang="xml" style="background-color:#272822;color:#f8f8f2;" class="language-xml "><code class="language-xml" data-lang="xml"><span>&lt;</span><span style="color:#f92672;">dependencies</span><span>&gt;
</span><span>    </span><span style="color:#75715e;">&lt;!-- Spring MVC Test --&gt;
</span><span>    &lt;</span><span style="color:#f92672;">dependency</span><span>&gt;
</span><span>        &lt;</span><span style="color:#f92672;">groupId</span><span>&gt;org.springframework&lt;/</span><span style="color:#f92672;">groupId</span><span>&gt;
</span><span>        &lt;</span><span style="color:#f92672;">artifactId</span><span>&gt;spring-test&lt;/</span><span style="color:#f92672;">artifactId</span><span>&gt;
</span><span>        &lt;</span><span style="color:#f92672;">version</span><span>&gt;5.3.22&lt;/</span><span style="color:#f92672;">version</span><span>&gt;
</span><span>        &lt;</span><span style="color:#f92672;">scope</span><span>&gt;test&lt;/</span><span style="color:#f92672;">scope</span><span>&gt;
</span><span>    &lt;/</span><span style="color:#f92672;">dependency</span><span>&gt;
</span><span>
</span><span>    </span><span style="color:#75715e;">&lt;!-- JUnit --&gt;
</span><span>    &lt;</span><span style="color:#f92672;">dependency</span><span>&gt;
</span><span>        &lt;</span><span style="color:#f92672;">groupId</span><span>&gt;junit&lt;/</span><span style="color:#f92672;">groupId</span><span>&gt;
</span><span>        &lt;</span><span style="color:#f92672;">artifactId</span><span>&gt;junit&lt;/</span><span style="color:#f92672;">artifactId</span><span>&gt;
</span><span>        &lt;</span><span style="color:#f92672;">version</span><span>&gt;4.13.2&lt;/</span><span style="color:#f92672;">version</span><span>&gt;
</span><span>        &lt;</span><span style="color:#f92672;">scope</span><span>&gt;test&lt;/</span><span style="color:#f92672;">scope</span><span>&gt;
</span><span>    &lt;/</span><span style="color:#f92672;">dependency</span><span>&gt;
</span><span>&lt;/</span><span style="color:#f92672;">dependencies</span><span>&gt;
</span></code></pre>
<hr />
<h4 id="2-bian-xie-kong-zhi-qi"><strong>2. 编写控制器</strong></h4>
<p>假设有一个简单的控制器 <code>UserController</code>：</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">stereotype</span><span>.</span><span style="font-style:italic;color:#66d9ef;">Controller</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">web</span><span>.</span><span style="font-style:italic;color:#66d9ef;">bind</span><span>.</span><span style="font-style:italic;color:#66d9ef;">annotation</span><span>.</span><span style="font-style:italic;color:#66d9ef;">GetMapping</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">web</span><span>.</span><span style="font-style:italic;color:#66d9ef;">bind</span><span>.</span><span style="font-style:italic;color:#66d9ef;">annotation</span><span>.</span><span style="font-style:italic;color:#66d9ef;">RequestParam</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">web</span><span>.</span><span style="font-style:italic;color:#66d9ef;">bind</span><span>.</span><span style="font-style:italic;color:#66d9ef;">annotation</span><span>.</span><span style="font-style:italic;color:#66d9ef;">ResponseBody</span><span>;
</span><span>
</span><span>@Controller
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">UserController </span><span>{
</span><span>
</span><span>    @GetMapping(</span><span style="color:#e6db74;">&quot;/user&quot;</span><span>)
</span><span>    @ResponseBody
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="color:#a6e22e;">getUser</span><span>(@RequestParam(</span><span style="color:#e6db74;">&quot;id&quot;</span><span>) </span><span style="font-style:italic;color:#66d9ef;">int </span><span style="font-style:italic;color:#fd971f;">id</span><span>) {
</span><span>        </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;User ID: &quot; </span><span style="color:#f92672;">+</span><span> id;
</span><span>    }
</span><span>}
</span></code></pre>
<hr />
<h4 id="3-bian-xie-ce-shi-lei"><strong>3. 编写测试类</strong></h4>
<p>使用 <code>Spring MVC Test</code> 测试 <code>UserController</code>。</p>
<h5 id="3-1-shi-yong-mockmvc"><strong>3.1 使用 <code>MockMvc</code></strong></h5>
<p><code>MockMvc</code> 是 Spring MVC Test 的核心类，用于模拟 HTTP 请求。</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">junit</span><span>.</span><span style="font-style:italic;color:#66d9ef;">Before</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">junit</span><span>.</span><span style="font-style:italic;color:#66d9ef;">Test</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">junit</span><span>.</span><span style="font-style:italic;color:#66d9ef;">runner</span><span>.</span><span style="font-style:italic;color:#66d9ef;">RunWith</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">beans</span><span>.</span><span style="font-style:italic;color:#66d9ef;">factory</span><span>.</span><span style="font-style:italic;color:#66d9ef;">annotation</span><span>.</span><span style="font-style:italic;color:#66d9ef;">Autowired</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">test</span><span>.</span><span style="font-style:italic;color:#66d9ef;">context</span><span>.</span><span style="font-style:italic;color:#66d9ef;">ContextConfiguration</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">test</span><span>.</span><span style="font-style:italic;color:#66d9ef;">context</span><span>.</span><span style="font-style:italic;color:#66d9ef;">junit4</span><span>.</span><span style="font-style:italic;color:#66d9ef;">SpringJUnit4ClassRunner</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">test</span><span>.</span><span style="font-style:italic;color:#66d9ef;">context</span><span>.</span><span style="font-style:italic;color:#66d9ef;">web</span><span>.</span><span style="font-style:italic;color:#66d9ef;">WebAppConfiguration</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">test</span><span>.</span><span style="font-style:italic;color:#66d9ef;">web</span><span>.</span><span style="font-style:italic;color:#66d9ef;">servlet</span><span>.</span><span style="font-style:italic;color:#66d9ef;">MockMvc</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">test</span><span>.</span><span style="font-style:italic;color:#66d9ef;">web</span><span>.</span><span style="font-style:italic;color:#66d9ef;">servlet</span><span>.</span><span style="font-style:italic;color:#66d9ef;">setup</span><span>.</span><span style="font-style:italic;color:#66d9ef;">MockMvcBuilders</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">web</span><span>.</span><span style="font-style:italic;color:#66d9ef;">context</span><span>.</span><span style="font-style:italic;color:#66d9ef;">WebApplicationContext</span><span>;
</span><span>
</span><span style="color:#f92672;">import static </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">test</span><span>.</span><span style="font-style:italic;color:#66d9ef;">web</span><span>.</span><span style="font-style:italic;color:#66d9ef;">servlet</span><span>.</span><span style="font-style:italic;color:#66d9ef;">request</span><span>.</span><span style="font-style:italic;color:#66d9ef;">MockMvcRequestBuilders</span><span>.</span><span style="color:#66d9ef;">get</span><span>;
</span><span style="color:#f92672;">import static </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">test</span><span>.</span><span style="font-style:italic;color:#66d9ef;">web</span><span>.</span><span style="font-style:italic;color:#66d9ef;">servlet</span><span>.</span><span style="font-style:italic;color:#66d9ef;">result</span><span>.</span><span style="font-style:italic;color:#66d9ef;">MockMvcResultMatchers</span><span>.</span><span style="color:#66d9ef;">content</span><span>;
</span><span style="color:#f92672;">import static </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">test</span><span>.</span><span style="font-style:italic;color:#66d9ef;">web</span><span>.</span><span style="font-style:italic;color:#66d9ef;">servlet</span><span>.</span><span style="font-style:italic;color:#66d9ef;">result</span><span>.</span><span style="font-style:italic;color:#66d9ef;">MockMvcResultMatchers</span><span>.</span><span style="color:#66d9ef;">status</span><span>;
</span><span>
</span><span>@RunWith(</span><span style="font-style:italic;color:#66d9ef;">SpringJUnit4ClassRunner</span><span>.class)
</span><span>@ContextConfiguration(</span><span style="font-style:italic;color:#fd971f;">classes </span><span style="color:#f92672;">= </span><span>{</span><span style="font-style:italic;color:#66d9ef;">AppConfig</span><span>.class})
</span><span>@WebAppConfiguration
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">UserControllerTest </span><span>{
</span><span>
</span><span>    @Autowired
</span><span>    </span><span style="color:#f92672;">private </span><span style="font-style:italic;color:#66d9ef;">WebApplicationContext </span><span>context;
</span><span>
</span><span>    </span><span style="color:#f92672;">private </span><span style="font-style:italic;color:#66d9ef;">MockMvc </span><span>mockMvc;
</span><span>
</span><span>    @Before
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">void </span><span style="color:#a6e22e;">setup</span><span>() {
</span><span>        mockMvc </span><span style="color:#f92672;">= </span><span style="font-style:italic;color:#66d9ef;">MockMvcBuilders</span><span>.webAppContextSetup(context).build();
</span><span>    }
</span><span>
</span><span>    @Test
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">void </span><span style="color:#a6e22e;">testGetUser</span><span>() </span><span style="color:#f92672;">throws </span><span style="font-style:italic;color:#66d9ef;">Exception </span><span>{
</span><span>        mockMvc.perform(get(</span><span style="color:#e6db74;">&quot;/user&quot;</span><span>).param(</span><span style="color:#e6db74;">&quot;id&quot;</span><span>, </span><span style="color:#e6db74;">&quot;1&quot;</span><span>))
</span><span>               .andExpect(status().isOk())
</span><span>               .andExpect(content().string(</span><span style="color:#e6db74;">&quot;User ID: 1&quot;</span><span>));
</span><span>    }
</span><span>}
</span></code></pre>
<h5 id="3-2-shi-yong-standalonemockmvcbuilder"><strong>3.2 使用 <code>StandaloneMockMvcBuilder</code></strong></h5>
<p>如果不需要加载完整的 Spring 上下文，可以使用 <code>StandaloneMockMvcBuilder</code> 进行测试。</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">junit</span><span>.</span><span style="font-style:italic;color:#66d9ef;">Before</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">junit</span><span>.</span><span style="font-style:italic;color:#66d9ef;">Test</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">test</span><span>.</span><span style="font-style:italic;color:#66d9ef;">web</span><span>.</span><span style="font-style:italic;color:#66d9ef;">servlet</span><span>.</span><span style="font-style:italic;color:#66d9ef;">MockMvc</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">test</span><span>.</span><span style="font-style:italic;color:#66d9ef;">web</span><span>.</span><span style="font-style:italic;color:#66d9ef;">servlet</span><span>.</span><span style="font-style:italic;color:#66d9ef;">setup</span><span>.</span><span style="font-style:italic;color:#66d9ef;">MockMvcBuilders</span><span>;
</span><span>
</span><span style="color:#f92672;">import static </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">test</span><span>.</span><span style="font-style:italic;color:#66d9ef;">web</span><span>.</span><span style="font-style:italic;color:#66d9ef;">servlet</span><span>.</span><span style="font-style:italic;color:#66d9ef;">request</span><span>.</span><span style="font-style:italic;color:#66d9ef;">MockMvcRequestBuilders</span><span>.</span><span style="color:#66d9ef;">get</span><span>;
</span><span style="color:#f92672;">import static </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">test</span><span>.</span><span style="font-style:italic;color:#66d9ef;">web</span><span>.</span><span style="font-style:italic;color:#66d9ef;">servlet</span><span>.</span><span style="font-style:italic;color:#66d9ef;">result</span><span>.</span><span style="font-style:italic;color:#66d9ef;">MockMvcResultMatchers</span><span>.</span><span style="color:#66d9ef;">content</span><span>;
</span><span style="color:#f92672;">import static </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">test</span><span>.</span><span style="font-style:italic;color:#66d9ef;">web</span><span>.</span><span style="font-style:italic;color:#66d9ef;">servlet</span><span>.</span><span style="font-style:italic;color:#66d9ef;">result</span><span>.</span><span style="font-style:italic;color:#66d9ef;">MockMvcResultMatchers</span><span>.</span><span style="color:#66d9ef;">status</span><span>;
</span><span>
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">UserControllerTest </span><span>{
</span><span>
</span><span>    </span><span style="color:#f92672;">private </span><span style="font-style:italic;color:#66d9ef;">MockMvc </span><span>mockMvc;
</span><span>
</span><span>    @Before
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">void </span><span style="color:#a6e22e;">setup</span><span>() {
</span><span>        mockMvc </span><span style="color:#f92672;">= </span><span style="font-style:italic;color:#66d9ef;">MockMvcBuilders</span><span>.standaloneSetup(</span><span style="color:#f92672;">new </span><span style="font-style:italic;color:#66d9ef;">UserController</span><span>()).build();
</span><span>    }
</span><span>
</span><span>    @Test
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">void </span><span style="color:#a6e22e;">testGetUser</span><span>() </span><span style="color:#f92672;">throws </span><span style="font-style:italic;color:#66d9ef;">Exception </span><span>{
</span><span>        mockMvc.perform(get(</span><span style="color:#e6db74;">&quot;/user&quot;</span><span>).param(</span><span style="color:#e6db74;">&quot;id&quot;</span><span>, </span><span style="color:#e6db74;">&quot;1&quot;</span><span>))
</span><span>               .andExpect(status().isOk())
</span><span>               .andExpect(content().string(</span><span style="color:#e6db74;">&quot;User ID: 1&quot;</span><span>));
</span><span>    }
</span><span>}
</span></code></pre>
<hr />
<h4 id="4-ce-shi-jie-guo"><strong>4. 测试结果</strong></h4>
<p>运行测试后，<code>MockMvc</code> 会模拟 HTTP 请求并验证控制器的行为：
• <code>status().isOk()</code>：验证 HTTP 状态码是否为 200。
• <code>content().string(&quot;User ID: 1&quot;)</code>：验证响应内容是否为 <code>&quot;User ID: 1&quot;</code>。</p>
<hr />
<h4 id="5-kuo-zhan-gong-neng"><strong>5. 扩展功能</strong></h4>
<p><code>Spring MVC Test</code> 还支持以下功能：</p>
<h5 id="5-1-yan-zheng-json-xiang-ying"><strong>5.1 验证 JSON 响应</strong></h5>
<p>如果控制器返回 JSON 数据，可以使用 <code>jsonPath</code> 验证响应内容。</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Test
</span><span style="color:#f92672;">public</span><span> void testGetUserJson() throws </span><span style="font-style:italic;color:#66d9ef;">Exception </span><span>{
</span><span>    mockMvc.perform(get(</span><span style="color:#e6db74;">&quot;/user/json&quot;</span><span>).param(</span><span style="color:#e6db74;">&quot;id&quot;</span><span>, </span><span style="color:#e6db74;">&quot;1&quot;</span><span>))
</span><span>           .andExpect(status().isOk())
</span><span>           .andExpect(jsonPath(</span><span style="color:#e6db74;">&quot;$.id&quot;</span><span>).value(</span><span style="color:#ae81ff;">1</span><span>))
</span><span>           .andExpect(jsonPath(</span><span style="color:#e6db74;">&quot;$.name&quot;</span><span>).value(</span><span style="color:#e6db74;">&quot;John&quot;</span><span>));
</span><span>}
</span></code></pre>
<h5 id="5-2-yan-zheng-shi-tu-he-mo-xing"><strong>5.2 验证视图和模型</strong></h5>
<p>如果控制器返回视图和模型数据，可以使用 <code>view().name()</code> 和 <code>model().attribute()</code> 进行验证。</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Test
</span><span style="color:#f92672;">public</span><span> void testGetUserView() throws </span><span style="font-style:italic;color:#66d9ef;">Exception </span><span>{
</span><span>    mockMvc.perform(get(</span><span style="color:#e6db74;">&quot;/user/view&quot;</span><span>).param(</span><span style="color:#e6db74;">&quot;id&quot;</span><span>, </span><span style="color:#e6db74;">&quot;1&quot;</span><span>))
</span><span>           .andExpect(status().isOk())
</span><span>           .andExpect(view().name(</span><span style="color:#e6db74;">&quot;user&quot;</span><span>))
</span><span>           .andExpect(model().attribute(</span><span style="color:#e6db74;">&quot;id&quot;</span><span>, </span><span style="color:#ae81ff;">1</span><span>));
</span><span>}
</span></code></pre>
<h5 id="5-3-mo-ni-wen-jian-shang-chuan"><strong>5.3 模拟文件上传</strong></h5>
<p>使用 <code>MockMultipartFile</code> 模拟文件上传。</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span>@Test
</span><span style="color:#f92672;">public</span><span> void testUploadFile() throws </span><span style="font-style:italic;color:#66d9ef;">Exception </span><span>{
</span><span>    </span><span style="font-style:italic;color:#66d9ef;">MockMultipartFile</span><span> file </span><span style="color:#f92672;">= new </span><span style="font-style:italic;color:#66d9ef;">MockMultipartFile</span><span>(</span><span style="color:#e6db74;">&quot;file&quot;</span><span>, </span><span style="color:#e6db74;">&quot;test.txt&quot;</span><span>, </span><span style="color:#e6db74;">&quot;text/plain&quot;</span><span>, </span><span style="color:#e6db74;">&quot;Hello World&quot;</span><span>.getBytes());
</span><span>    mockMvc.perform(multipart(</span><span style="color:#e6db74;">&quot;/upload&quot;</span><span>).file(file))
</span><span>           .andExpect(status().isOk())
</span><span>           .andExpect(content().string(</span><span style="color:#e6db74;">&quot;File uploaded successfully&quot;</span><span>));
</span><span>}
</span></code></pre>
<hr />
<h2 id="guo-ji-hua-i18n"><strong>国际化（i18n）</strong></h2>
<p>在 Spring MVC 中，国际化（Internationalization，简称 i18n）是通过 <code>MessageSource</code> 和 <code>LocaleResolver</code> 实现的。以下是 Spring MVC 支持国际化的具体应用示例。</p>
<hr />
<h3 id="1-tian-jia-yi-lai-1"><strong>1. 添加依赖</strong></h3>
<p>在 <code>pom.xml</code> 中添加 <code>spring-webmvc</code> 依赖：</p>
<pre data-lang="xml" style="background-color:#272822;color:#f8f8f2;" class="language-xml "><code class="language-xml" data-lang="xml"><span>&lt;</span><span style="color:#f92672;">dependency</span><span>&gt;
</span><span>    &lt;</span><span style="color:#f92672;">groupId</span><span>&gt;org.springframework&lt;/</span><span style="color:#f92672;">groupId</span><span>&gt;
</span><span>    &lt;</span><span style="color:#f92672;">artifactId</span><span>&gt;spring-webmvc&lt;/</span><span style="color:#f92672;">artifactId</span><span>&gt;
</span><span>    &lt;</span><span style="color:#f92672;">version</span><span>&gt;5.3.22&lt;/</span><span style="color:#f92672;">version</span><span>&gt;
</span><span>&lt;/</span><span style="color:#f92672;">dependency</span><span>&gt;
</span></code></pre>
<hr />
<h3 id="2-pei-zhi-guo-ji-hua-zi-yuan-wen-jian"><strong>2. 配置国际化资源文件</strong></h3>
<p>在 <code>src/main/resources</code> 目录下创建国际化资源文件：
• <code>messages.properties</code>（默认语言）
• <code>messages_en.properties</code>（英语）
• <code>messages_zh_CN.properties</code>（简体中文）</p>
<p><strong>messages.properties</strong></p>
<pre data-lang="properties" style="background-color:#272822;color:#f8f8f2;" class="language-properties "><code class="language-properties" data-lang="properties"><span>welcome.message=</span><span style="color:#e6db74;">Welcome!
</span></code></pre>
<p><strong>messages_en.properties</strong></p>
<pre data-lang="properties" style="background-color:#272822;color:#f8f8f2;" class="language-properties "><code class="language-properties" data-lang="properties"><span>welcome.message=</span><span style="color:#e6db74;">Welcome!
</span></code></pre>
<p><strong>messages_zh_CN.properties</strong></p>
<pre data-lang="properties" style="background-color:#272822;color:#f8f8f2;" class="language-properties "><code class="language-properties" data-lang="properties"><span>welcome.message=</span><span style="color:#e6db74;">欢迎！
</span></code></pre>
<hr />
<h3 id="3-pei-zhi-spring-mvc-zhi-chi-guo-ji-hua"><strong>3. 配置 Spring MVC 支持国际化</strong></h3>
<p>在 Spring 配置文件中配置 <code>MessageSource</code> 和 <code>LocaleResolver</code>。</p>
<h4 id="3-1-ji-yu-xml-de-pei-zhi"><strong>3.1 基于 XML 的配置</strong></h4>
<pre data-lang="xml" style="background-color:#272822;color:#f8f8f2;" class="language-xml "><code class="language-xml" data-lang="xml"><span>&lt;</span><span style="color:#f92672;">beans </span><span style="color:#a6e22e;">xmlns</span><span>=</span><span style="color:#e6db74;">&quot;http://www.springframework.org/schema/beans&quot;
</span><span>       </span><span style="color:#a6e22e;">xmlns:xsi</span><span>=</span><span style="color:#e6db74;">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
</span><span>       </span><span style="color:#a6e22e;">xmlns:context</span><span>=</span><span style="color:#e6db74;">&quot;http://www.springframework.org/schema/context&quot;
</span><span>       </span><span style="color:#a6e22e;">xsi:schemaLocation</span><span>=</span><span style="color:#e6db74;">&quot;http://www.springframework.org/schema/beans
</span><span style="color:#e6db74;">                           http://www.springframework.org/schema/beans/spring-beans.xsd
</span><span style="color:#e6db74;">                           http://www.springframework.org/schema/context
</span><span style="color:#e6db74;">                           http://www.springframework.org/schema/context/spring-context.xsd&quot;</span><span>&gt;
</span><span>
</span><span>    </span><span style="color:#75715e;">&lt;!-- 配置 MessageSource --&gt;
</span><span>    &lt;</span><span style="color:#f92672;">bean </span><span style="color:#a6e22e;">id</span><span>=</span><span style="color:#e6db74;">&quot;messageSource&quot; </span><span style="color:#a6e22e;">class</span><span>=</span><span style="color:#e6db74;">&quot;org.springframework.context.support.ResourceBundleMessageSource&quot;</span><span>&gt;
</span><span>        &lt;</span><span style="color:#f92672;">property </span><span style="color:#a6e22e;">name</span><span>=</span><span style="color:#e6db74;">&quot;basename&quot; </span><span style="color:#a6e22e;">value</span><span>=</span><span style="color:#e6db74;">&quot;messages&quot; </span><span>/&gt;
</span><span>        &lt;</span><span style="color:#f92672;">property </span><span style="color:#a6e22e;">name</span><span>=</span><span style="color:#e6db74;">&quot;defaultEncoding&quot; </span><span style="color:#a6e22e;">value</span><span>=</span><span style="color:#e6db74;">&quot;UTF-8&quot; </span><span>/&gt;
</span><span>    &lt;/</span><span style="color:#f92672;">bean</span><span>&gt;
</span><span>
</span><span>    </span><span style="color:#75715e;">&lt;!-- 配置 LocaleResolver --&gt;
</span><span>    &lt;</span><span style="color:#f92672;">bean </span><span style="color:#a6e22e;">id</span><span>=</span><span style="color:#e6db74;">&quot;localeResolver&quot; </span><span style="color:#a6e22e;">class</span><span>=</span><span style="color:#e6db74;">&quot;org.springframework.web.servlet.i18n.SessionLocaleResolver&quot;</span><span>&gt;
</span><span>        &lt;</span><span style="color:#f92672;">property </span><span style="color:#a6e22e;">name</span><span>=</span><span style="color:#e6db74;">&quot;defaultLocale&quot; </span><span style="color:#a6e22e;">value</span><span>=</span><span style="color:#e6db74;">&quot;en&quot; </span><span>/&gt;
</span><span>    &lt;/</span><span style="color:#f92672;">bean</span><span>&gt;
</span><span>
</span><span>    </span><span style="color:#75715e;">&lt;!-- 配置 LocaleChangeInterceptor --&gt;
</span><span>    &lt;</span><span style="color:#f92672;">bean </span><span style="color:#a6e22e;">class</span><span>=</span><span style="color:#e6db74;">&quot;org.springframework.web.servlet.i18n.LocaleChangeInterceptor&quot;</span><span>&gt;
</span><span>        &lt;</span><span style="color:#f92672;">property </span><span style="color:#a6e22e;">name</span><span>=</span><span style="color:#e6db74;">&quot;paramName&quot; </span><span style="color:#a6e22e;">value</span><span>=</span><span style="color:#e6db74;">&quot;lang&quot; </span><span>/&gt;
</span><span>    &lt;/</span><span style="color:#f92672;">bean</span><span>&gt;
</span><span>&lt;/</span><span style="color:#f92672;">beans</span><span>&gt;
</span></code></pre>
<h4 id="3-2-ji-yu-java-de-pei-zhi"><strong>3.2 基于 Java 的配置</strong></h4>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">context</span><span>.</span><span style="font-style:italic;color:#66d9ef;">MessageSource</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">context</span><span>.</span><span style="font-style:italic;color:#66d9ef;">annotation</span><span>.</span><span style="font-style:italic;color:#66d9ef;">Bean</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">context</span><span>.</span><span style="font-style:italic;color:#66d9ef;">annotation</span><span>.</span><span style="font-style:italic;color:#66d9ef;">Configuration</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">context</span><span>.</span><span style="font-style:italic;color:#66d9ef;">support</span><span>.</span><span style="font-style:italic;color:#66d9ef;">ResourceBundleMessageSource</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">web</span><span>.</span><span style="font-style:italic;color:#66d9ef;">servlet</span><span>.</span><span style="font-style:italic;color:#66d9ef;">LocaleResolver</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">web</span><span>.</span><span style="font-style:italic;color:#66d9ef;">servlet</span><span>.</span><span style="font-style:italic;color:#66d9ef;">config</span><span>.</span><span style="font-style:italic;color:#66d9ef;">annotation</span><span>.</span><span style="font-style:italic;color:#66d9ef;">InterceptorRegistry</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">web</span><span>.</span><span style="font-style:italic;color:#66d9ef;">servlet</span><span>.</span><span style="font-style:italic;color:#66d9ef;">config</span><span>.</span><span style="font-style:italic;color:#66d9ef;">annotation</span><span>.</span><span style="font-style:italic;color:#66d9ef;">WebMvcConfigurer</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">web</span><span>.</span><span style="font-style:italic;color:#66d9ef;">servlet</span><span>.</span><span style="font-style:italic;color:#66d9ef;">i18n</span><span>.</span><span style="font-style:italic;color:#66d9ef;">LocaleChangeInterceptor</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">web</span><span>.</span><span style="font-style:italic;color:#66d9ef;">servlet</span><span>.</span><span style="font-style:italic;color:#66d9ef;">i18n</span><span>.</span><span style="font-style:italic;color:#66d9ef;">SessionLocaleResolver</span><span>;
</span><span>
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">java</span><span>.</span><span style="font-style:italic;color:#66d9ef;">util</span><span>.</span><span style="font-style:italic;color:#66d9ef;">Locale</span><span>;
</span><span>
</span><span>@Configuration
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">WebConfig </span><span style="color:#f92672;">implements </span><span style="text-decoration:underline;font-style:italic;color:#a6e22e;">WebMvcConfigurer </span><span>{
</span><span>
</span><span>    @Bean
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">MessageSource </span><span style="color:#a6e22e;">messageSource</span><span>() {
</span><span>        </span><span style="font-style:italic;color:#66d9ef;">ResourceBundleMessageSource</span><span> messageSource </span><span style="color:#f92672;">= new </span><span style="font-style:italic;color:#66d9ef;">ResourceBundleMessageSource</span><span>();
</span><span>        messageSource.setBasename(</span><span style="color:#e6db74;">&quot;messages&quot;</span><span>);
</span><span>        messageSource.setDefaultEncoding(</span><span style="color:#e6db74;">&quot;UTF-8&quot;</span><span>);
</span><span>        </span><span style="color:#f92672;">return</span><span> messageSource;
</span><span>    }
</span><span>
</span><span>    @Bean
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">LocaleResolver </span><span style="color:#a6e22e;">localeResolver</span><span>() {
</span><span>        </span><span style="font-style:italic;color:#66d9ef;">SessionLocaleResolver</span><span> resolver </span><span style="color:#f92672;">= new </span><span style="font-style:italic;color:#66d9ef;">SessionLocaleResolver</span><span>();
</span><span>        resolver.setDefaultLocale(</span><span style="font-style:italic;color:#66d9ef;">Locale</span><span>.</span><span style="color:#ae81ff;">ENGLISH</span><span>);
</span><span>        </span><span style="color:#f92672;">return</span><span> resolver;
</span><span>    }
</span><span>
</span><span>    @Bean
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">LocaleChangeInterceptor </span><span style="color:#a6e22e;">localeChangeInterceptor</span><span>() {
</span><span>        </span><span style="font-style:italic;color:#66d9ef;">LocaleChangeInterceptor</span><span> interceptor </span><span style="color:#f92672;">= new </span><span style="font-style:italic;color:#66d9ef;">LocaleChangeInterceptor</span><span>();
</span><span>        interceptor.setParamName(</span><span style="color:#e6db74;">&quot;lang&quot;</span><span>);
</span><span>        </span><span style="color:#f92672;">return</span><span> interceptor;
</span><span>    }
</span><span>
</span><span>    @Override
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">void </span><span style="color:#a6e22e;">addInterceptors</span><span>(</span><span style="font-style:italic;color:#66d9ef;">InterceptorRegistry </span><span style="font-style:italic;color:#fd971f;">registry</span><span>) {
</span><span>        registry.addInterceptor(localeChangeInterceptor());
</span><span>    }
</span><span>}
</span></code></pre>
<hr />
<h3 id="4-bian-xie-kong-zhi-qi"><strong>4. 编写控制器</strong></h3>
<p>在控制器中使用 <code>MessageSource</code> 获取国际化消息。</p>
<pre data-lang="java" style="background-color:#272822;color:#f8f8f2;" class="language-java "><code class="language-java" data-lang="java"><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">beans</span><span>.</span><span style="font-style:italic;color:#66d9ef;">factory</span><span>.</span><span style="font-style:italic;color:#66d9ef;">annotation</span><span>.</span><span style="font-style:italic;color:#66d9ef;">Autowired</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">context</span><span>.</span><span style="font-style:italic;color:#66d9ef;">MessageSource</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">stereotype</span><span>.</span><span style="font-style:italic;color:#66d9ef;">Controller</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">web</span><span>.</span><span style="font-style:italic;color:#66d9ef;">bind</span><span>.</span><span style="font-style:italic;color:#66d9ef;">annotation</span><span>.</span><span style="font-style:italic;color:#66d9ef;">GetMapping</span><span>;
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">org</span><span>.</span><span style="font-style:italic;color:#66d9ef;">springframework</span><span>.</span><span style="font-style:italic;color:#66d9ef;">web</span><span>.</span><span style="font-style:italic;color:#66d9ef;">bind</span><span>.</span><span style="font-style:italic;color:#66d9ef;">annotation</span><span>.</span><span style="font-style:italic;color:#66d9ef;">RequestParam</span><span>;
</span><span>
</span><span style="color:#f92672;">import </span><span style="font-style:italic;color:#66d9ef;">java</span><span>.</span><span style="font-style:italic;color:#66d9ef;">util</span><span>.</span><span style="font-style:italic;color:#66d9ef;">Locale</span><span>;
</span><span>
</span><span>@Controller
</span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">class </span><span style="text-decoration:underline;color:#a6e22e;">HomeController </span><span>{
</span><span>
</span><span>    @Autowired
</span><span>    </span><span style="color:#f92672;">private </span><span style="font-style:italic;color:#66d9ef;">MessageSource </span><span>messageSource;
</span><span>
</span><span>    @GetMapping(</span><span style="color:#e6db74;">&quot;/&quot;</span><span>)
</span><span>    </span><span style="color:#f92672;">public </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="color:#a6e22e;">home</span><span>(@RequestParam(</span><span style="font-style:italic;color:#fd971f;">value </span><span style="color:#f92672;">= </span><span style="color:#e6db74;">&quot;lang&quot;</span><span>, </span><span style="font-style:italic;color:#fd971f;">required </span><span style="color:#f92672;">= </span><span style="color:#ae81ff;">false</span><span>) </span><span style="font-style:italic;color:#66d9ef;">String </span><span style="font-style:italic;color:#fd971f;">lang</span><span>, </span><span style="font-style:italic;color:#66d9ef;">Locale </span><span style="font-style:italic;color:#fd971f;">locale</span><span>) {
</span><span>        </span><span style="font-style:italic;color:#66d9ef;">String</span><span> welcomeMessage </span><span style="color:#f92672;">=</span><span> messageSource.getMessage(</span><span style="color:#e6db74;">&quot;welcome.message&quot;</span><span>, </span><span style="color:#ae81ff;">null</span><span>, locale);
</span><span>        </span><span style="font-style:italic;color:#66d9ef;">System</span><span>.out.println(</span><span style="color:#e6db74;">&quot;Welcome Message: &quot; </span><span style="color:#f92672;">+</span><span> welcomeMessage);
</span><span>        </span><span style="color:#f92672;">return </span><span style="color:#e6db74;">&quot;home&quot;</span><span>;
</span><span>    }
</span><span>}
</span></code></pre>
<hr />
<h3 id="5-bian-xie-shi-tu"><strong>5. 编写视图</strong></h3>
<p>在视图（如 JSP 或 Thymeleaf）中使用国际化消息。</p>
<h4 id="5-1-jsp-shi-tu"><strong>5.1 JSP 视图</strong></h4>
<pre data-lang="jsp" style="background-color:#272822;color:#f8f8f2;" class="language-jsp "><code class="language-jsp" data-lang="jsp"><span>&lt;%@ </span><span style="color:#f92672;">page </span><span style="color:#ae81ff;">contentType</span><span style="color:#f92672;">=</span><span style="color:#e6db74;">&quot;text/html;charset=UTF-8&quot; </span><span style="color:#ae81ff;">language</span><span style="color:#f92672;">=</span><span style="color:#e6db74;">&quot;java&quot; </span><span>%&gt;
</span><span>&lt;%@ </span><span style="color:#f92672;">taglib </span><span style="color:#ae81ff;">prefix</span><span style="color:#f92672;">=</span><span style="color:#e6db74;">&quot;spring&quot; </span><span style="color:#ae81ff;">uri</span><span style="color:#f92672;">=</span><span style="color:#e6db74;">&quot;http://www.springframework.org/tags&quot; </span><span>%&gt;
</span><span>&lt;</span><span style="color:#f92672;">html</span><span>&gt;
</span><span>&lt;</span><span style="color:#f92672;">head</span><span>&gt;
</span><span>    &lt;</span><span style="color:#f92672;">title</span><span>&gt;Home&lt;/</span><span style="color:#f92672;">title</span><span>&gt;
</span><span>&lt;/</span><span style="color:#f92672;">head</span><span>&gt;
</span><span>&lt;</span><span style="color:#f92672;">body</span><span>&gt;
</span><span>    &lt;</span><span style="color:#f92672;">h1</span><span>&gt;&lt;</span><span style="color:#f92672;">spring:message </span><span style="color:#a6e22e;">code</span><span>=</span><span style="color:#e6db74;">&quot;welcome.message&quot; </span><span>/&gt;&lt;/</span><span style="color:#f92672;">h1</span><span>&gt;
</span><span>&lt;/</span><span style="color:#f92672;">body</span><span>&gt;
</span><span>&lt;/</span><span style="color:#f92672;">html</span><span>&gt;
</span></code></pre>
<h4 id="5-2-thymeleaf-shi-tu"><strong>5.2 Thymeleaf 视图</strong></h4>
<pre data-lang="html" style="background-color:#272822;color:#f8f8f2;" class="language-html "><code class="language-html" data-lang="html"><span>&lt;!</span><span style="color:#f92672;">DOCTYPE </span><span style="color:#ae81ff;">html</span><span>&gt;
</span><span>&lt;</span><span style="color:#f92672;">html </span><span style="color:#a6e22e;">xmlns:th</span><span>=</span><span style="color:#e6db74;">&quot;http://www.thymeleaf.org&quot;</span><span>&gt;
</span><span>&lt;</span><span style="color:#f92672;">head</span><span>&gt;
</span><span>    &lt;</span><span style="color:#f92672;">meta </span><span style="color:#a6e22e;">charset</span><span>=</span><span style="color:#e6db74;">&quot;UTF-8&quot;</span><span>&gt;
</span><span>    &lt;</span><span style="color:#f92672;">title</span><span>&gt;Home&lt;/</span><span style="color:#f92672;">title</span><span>&gt;
</span><span>&lt;/</span><span style="color:#f92672;">head</span><span>&gt;
</span><span>&lt;</span><span style="color:#f92672;">body</span><span>&gt;
</span><span>    &lt;</span><span style="color:#f92672;">h1 </span><span style="color:#a6e22e;">th:text</span><span>=</span><span style="color:#e6db74;">&quot;#{welcome.message}&quot;</span><span>&gt;Welcome!&lt;/</span><span style="color:#f92672;">h1</span><span>&gt;
</span><span>&lt;/</span><span style="color:#f92672;">body</span><span>&gt;
</span><span>&lt;/</span><span style="color:#f92672;">html</span><span>&gt;
</span></code></pre>
<hr />
<h3 id="6-ce-shi-guo-ji-hua"><strong>6. 测试国际化</strong></h3>
<p>通过 URL 参数 <code>lang</code> 切换语言。</p>
<h4 id="6-1-mo-ren-yu-yan-ying-yu"><strong>6.1 默认语言（英语）</strong></h4>
<p>访问 <code>http://localhost:8080/</code>，输出：</p>
<pre style="background-color:#272822;color:#f8f8f2;"><code><span>Welcome Message: Welcome!
</span></code></pre>
<h4 id="6-2-qie-huan-dao-jian-ti-zhong-wen"><strong>6.2 切换到简体中文</strong></h4>
<p>访问 <code>http://localhost:8080/?lang=zh_CN</code>，输出：</p>
<pre style="background-color:#272822;color:#f8f8f2;"><code><span>Welcome Message: 欢迎！
</span></code></pre>
<hr />
<h3 id="7-qi-ta-localeresolver-shi-xian"><strong>7. 其他 LocaleResolver 实现</strong></h3>
<p>Spring MVC 提供了多种 <code>LocaleResolver</code> 实现，开发者可以根据需求选择。</p>
<h4 id="7-1-sessionlocaleresolver"><strong>7.1 <code>SessionLocaleResolver</code></strong></h4>
<p>• <strong>特点</strong>: 将语言信息存储在会话中。
• <strong>适用场景</strong>: 用户登录后保持语言偏好。</p>
<h4 id="7-2-cookielocaleresolver"><strong>7.2 <code>CookieLocaleResolver</code></strong></h4>
<p>• <strong>特点</strong>: 将语言信息存储在 Cookie 中。
• <strong>适用场景</strong>: 用户未登录时保持语言偏好。</p>
<h4 id="7-3-acceptheaderlocaleresolver"><strong>7.3 <code>AcceptHeaderLocaleResolver</code></strong></h4>
<p>• <strong>特点</strong>: 根据请求头 <code>Accept-Language</code> 自动选择语言。
• <strong>适用场景</strong>: 根据浏览器语言设置自动切换语言。</p>
<hr />
<h3 id="zong-jie-2"><strong>总结</strong></h3>
<p>Spring MVC 的国际化支持非常灵活，通过 <code>MessageSource</code> 和 <code>LocaleResolver</code> 可以轻松实现多语言支持。开发者可以通过配置文件、URL 参数、会话或 Cookie 等方式切换语言，同时还可以在视图层（如 JSP 或 Thymeleaf）中直接使用国际化消息。</p>
<h2 id="xing-neng-you-hua"><strong>性能优化</strong></h2>
<p>• <strong>缓存</strong>: 支持HTTP缓存，可以通过配置Cache-Control头来优化性能。
• <strong>异步处理</strong>: 支持异步请求处理，提高应用程序的并发处理能力。</p>
<h2 id="an-quan-xing"><strong>安全性</strong></h2>
<p>• 虽然Spring MVC本身不提供安全功能，但可以与Spring Security集成，提供身份验证、授权等安全功能。</p>
<h2 id="yu-qi-ta-ji-zhu-de-ji-cheng"><strong>与其他技术的集成</strong></h2>
<p>• <strong>WebSocket</strong>: 支持WebSocket协议，用于实现实时通信。
• <strong>SockJS</strong>: 提供WebSocket的降级方案，兼容不支持WebSocket的浏览器。
• <strong>STOMP Messaging</strong>: 支持STOMP协议，用于在WebSocket之上实现消息传递。</p>
<h2 id="kuo-zhan-xing"><strong>扩展性</strong></h2>
<p>• Spring MVC具有高度的扩展性，可以通过自定义HandlerInterceptor、ViewResolver等组件来扩展框架的功能。</p>

        </div>
    </article>

    <div class="toc">
        <h3>目录</h3>
        <div id="toc-container"></div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // 生成目录
    const article = document.querySelector('article');
    const headings = article.querySelectorAll('h1, h2, h3, h4, h5, h6');
    const tocContainer = document.getElementById('toc-container');
    const tocList = document.createElement('ul');
    tocList.className = 'toc-list';

    // 如果没有标题，隐藏目录
    if (headings.length === 0) {
        document.querySelector('.toc').style.display = 'none';
        return;
    }

    headings.forEach((heading, index) => {
        // 为每个标题添加ID
        if (!heading.id) {
            heading.id = `heading-${index}`;
        }

        const li = document.createElement('li');
        const a = document.createElement('a');
        a.href = `#${heading.id}`;
        a.textContent = heading.textContent;
        a.style.paddingLeft = `${(parseInt(heading.tagName[1]) - 1) * 1}rem`;
        
        li.appendChild(a);
        tocList.appendChild(li);
    });

    tocContainer.appendChild(tocList);

    // 监听滚动，高亮当前部分
    const tocLinks = document.querySelectorAll('.toc-list a');
    
    function highlightToc() {
        // 获取视窗高度的 1/3 位置作为触发点
        const triggerPoint = window.innerHeight / 3;
        
        // 找到当前可见的标题
        let currentHeading = null;
        for (let i = 0; i < headings.length; i++) {
            const heading = headings[i];
            const rect = heading.getBoundingClientRect();
            
            // 如果标题在触发点上方但还在视窗内，或者是第一个在触发点下方的标题
            if ((rect.top <= triggerPoint && rect.bottom >= 0) || 
                (rect.top > triggerPoint && !currentHeading)) {
                currentHeading = heading;
                break;
            }
        }

        // 如果找到了当前标题，高亮对应的目录项
        if (currentHeading) {
            tocLinks.forEach(link => {
                if (link.getAttribute('href') === `#${currentHeading.id}`) {
                    link.classList.add('active');
                    // 确保高亮的目录项在视图中可见
                    link.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                } else {
                    link.classList.remove('active');
                }
            });
        }
    }

    // 使用 requestAnimationFrame 优化滚动性能
    let ticking = false;
    window.addEventListener('scroll', function() {
        if (!ticking) {
            window.requestAnimationFrame(function() {
                highlightToc();
                ticking = false;
            });
            ticking = true;
        }
    });

    // 添加平滑滚动效果
    tocLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            const targetId = this.getAttribute('href').slice(1);
            const targetElement = document.getElementById(targetId);
            if (targetElement) {
                targetElement.scrollIntoView({ behavior: 'smooth' });
            }
        });
    });

    // 初始化高亮
    highlightToc();
});
</script>

  </div>

  <style>
    pre[class*="language-"] {
      border-radius: 5px;
      margin: 1.5em 0;
      padding: 1em;
      overflow: auto;
    }
    
    code[class*="language-"] {
      font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
      font-size: 0.9em;
    }
  </style>

  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-c.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-cpp.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-java.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-python.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-javascript.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      Prism.highlightAll();
    });
  </script>
</body>

</html>
